{"remainingRequest":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\src\\page\\userInfo\\my-order\\order-evaluation.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\src\\page\\userInfo\\my-order\\order-evaluation.vue","mtime":1760944158225},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\babel.config.js","mtime":1760944158066},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1761044715083},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\babel-loader\\lib\\index.js","mtime":1761044716268},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1761044715083},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\vue-loader\\lib\\index.js","mtime":1761044716737}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5tYXAuanMiOwppbXBvcnQgeyBtYXBHZXR0ZXJzLCBtYXBBY3Rpb25zIH0gZnJvbSAidnVleCI7CmltcG9ydCB7IG51bWJlckZvcm1hdCB9IGZyb20gIkAvdXRpbCI7CmltcG9ydCB7IFVwbG9hZEFwaSwgQWRkT3JkZXJFdmFsdWF0ZUxpc3QgfSBmcm9tICJAL2FwaSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAib3JkZXItZXZhbHVhdGlvbi1kaWFsb2ciLAogIHByb3BzOiB7CiAgICB2YWx1ZTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIC8vIGN1cnJlbnRPcmRlckluZm86IHsKICAgIC8vICAgICB0eXBlOiBPYmplY3QsCiAgICAvLyAgICAgZGVmYXVsdDogKCkgPT4geyB9LAogICAgLy8gfSwKICAgIHJlZnJlc2g6IHsKICAgICAgdHlwZTogRnVuY3Rpb24KICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvLyBjdXJyZW50T3JkZXJJbmZvOiB0aGlzLiRyb3V0ZS5wYXJhbXM/LmN1cnJlbnRPcmRlckluZm8gfHwge30sCiAgICAgIC8vIGRpYWxvZ1Zpc2libGU6IHRoaXMudmFsdWUgfHwgZmFsc2UsCiAgICAgIG9yZGVySWQ6IHRoaXMuJHJvdXRlLnF1ZXJ5Lm9yZGVySWQsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICByYXRlTWFwOiB7fSwKICAgICAgY29udGVudE1hcDoge30sCiAgICAgIGltYWdlc01hcDoge30sCiAgICAgIHJlc3VsdE1hcDoge30sCiAgICAgIGRpYWxvZ0ltYWdlVXJsOiAiIiwKICAgICAgaXNVcGxvYWQ6IGZhbHNlLAogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICBVcGxvYWRBcGksCiAgICAgIHVwbG9hZFBhcmFtczogewogICAgICAgIG1vZHVsZU5hbWU6ICJldmFsdWF0ZSIsCiAgICAgICAgdG9rZW46IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJFU19UT0tFTiIpCiAgICAgIH0KICAgIH07CiAgfSwKICBtb3VudGVkKCkgewogICAgaWYgKHRoaXMub3JkZXJJZCkgewogICAgICB0aGlzLnJlcXVlc3REYXRhKCk7CiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyh7CiAgICAgIG9yZGVyR29vZHM6ICJvcmRlci9vcmRlckdvb2RzIgogICAgfSkKICB9LAogIHdhdGNoOiB7CiAgICBvcmRlckdvb2RzKG5ld1ZhbHVlKSB7CiAgICAgIGxldCByYXRlTWFwID0ge307CiAgICAgIGxldCBjb250ZW50TWFwID0ge307CiAgICAgIGxldCByZXN1bHRNYXAgPSB7fTsKICAgICAgbmV3VmFsdWUuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICByYXRlTWFwW2l0ZW0uZ29vZHNJZF0gPSA1OwogICAgICAgIGNvbnRlbnRNYXBbaXRlbS5nb29kc0lkXSA9ICIiOwogICAgICAgIHJlc3VsdE1hcFtpdGVtLmdvb2RzSWRdID0gZmFsc2U7CiAgICAgIH0pOwogICAgICB0aGlzLnJhdGVNYXAgPSB7CiAgICAgICAgLi4ucmF0ZU1hcAogICAgICB9OwogICAgICB0aGlzLmNvbnRlbnRNYXAgPSB7CiAgICAgICAgLi4uY29udGVudE1hcAogICAgICB9OwogICAgICB0aGlzLnJlc3VsdE1hcCA9IHsKICAgICAgICAuLi5yZXN1bHRNYXAKICAgICAgfTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC4uLm1hcEFjdGlvbnMoewogICAgICByZXF1ZXN0T3JkZXJHb29kc0xpc3Q6ICJvcmRlci9yZXF1ZXN0T3JkZXJHb29kc0xpc3QiLAogICAgICByZXF1ZXN0T3JkZXJFdmFsdWF0aW9uTGlzdDogIm9yZGVyL3JlcXVlc3RPcmRlckV2YWx1YXRpb25MaXN0IgogICAgfSksCiAgICB1cGxvYWRGaWxlKHBhcmFtcywgZ29vZHNJZCkgewogICAgICBjb25zb2xlLmxvZyhnb29kc0lkLCBwYXJhbXMpOwogICAgfSwKICAgIGhhbmRsZVJlbW92ZShmaWxlLCBnb29kc0lkKSB7CiAgICAgIHZhciBfdGhpcyRpbWFnZXNNYXAkZ29vZHMsIF90aGlzJGltYWdlc01hcCRnb29kczI7CiAgICAgIGNvbnN0IGluZGV4ID0gKF90aGlzJGltYWdlc01hcCRnb29kcyA9IHRoaXMuaW1hZ2VzTWFwW2dvb2RzSWRdKSA9PT0gbnVsbCB8fCBfdGhpcyRpbWFnZXNNYXAkZ29vZHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGltYWdlc01hcCRnb29kcy5maW5kSW5kZXgoeCA9PiB4LnVpZCA9PSBmaWxlLnVpZCk7CiAgICAgIGluZGV4ID49IDAgJiYgKChfdGhpcyRpbWFnZXNNYXAkZ29vZHMyID0gdGhpcy5pbWFnZXNNYXBbZ29vZHNJZF0pID09PSBudWxsIHx8IF90aGlzJGltYWdlc01hcCRnb29kczIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGltYWdlc01hcCRnb29kczIuc3BsaWNlKGluZGV4LCAxKSk7CiAgICB9LAogICAgaGFuZGxlUGljdHVyZUNhcmRQcmV2aWV3KGZpbGUpIHsKICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybCA9IGZpbGUudXJsOwogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlOwogICAgfSwKICAgIGhhbmRsZUZpbGVzQ2hhbmdlKGZpbGVzLCBnb29kc0lkKSB7CiAgICAgIGlmIChmaWxlcy5sZW5ndGggPiA4KSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKHRoaXMuJHQoIm1lc3NhZ2UuaG9tZS7mnIDlpJrkuIrkvKA55byg5Zu+54mHIikpOwogICAgICAgIHRoaXMuaXNVcGxvYWQgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaW1hZ2VzTWFwW2dvb2RzSWRdID0gZmlsZXM7CiAgICAgIH0KICAgIH0sCiAgICBnb0JhY2soKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvdXNlckluZm8vbXktb3JkZXIiKTsKICAgIH0sCiAgICBnZXRSYXRlKGlkKSB7CiAgICAgIGlmICh0aGlzLnJhdGVNYXBbaWRdIDwgMikgewogICAgICAgIHJldHVybiAzOwogICAgICB9IGVsc2UgaWYgKHRoaXMucmF0ZU1hcFtpZF0gPCA0KSB7CiAgICAgICAgcmV0dXJuIDI7CiAgICAgIH0KICAgICAgcmV0dXJuIDE7CiAgICB9LAogICAgYXN5bmMgcmVxdWVzdERhdGEoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICBhd2FpdCB0aGlzLnJlcXVlc3RPcmRlckdvb2RzTGlzdCh7CiAgICAgICAgICBvcmRlcklkOiB0aGlzLm9yZGVySWQKICAgICAgICB9KTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIHN1Ym1pdCgpIHsKICAgICAgLy8gY29uc3QgY29udGVudCA9IHRoaXMuY29udGVudE1hcFtpdGVtLmdvb2RzSWRdPy50cmltKCkgPz8gJycKICAgICAgLy8gaWYgKCFjb250ZW50KSB7CiAgICAgIC8vICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKHRoaXMuJHQoJ21lc3NhZ2UuaG9tZS5ldmFsdWF0ZU9yZGVyUGxhY2Vob2xkZXInKSkKICAgICAgLy8gICByZXR1cm4KICAgICAgLy8gfQoKICAgICAgdHJ5IHsKICAgICAgICB0aGlzLmJ0bkxvYWRpbmcgPSB0cnVlOwogICAgICAgIHRoaXMuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgIC8vIGF3YWl0IHRoaXMucmVxdWVzdE9yZGVyRXZhbHVhdGlvbkxpc3QoewogICAgICAgIC8vICAgICBzZWxsZXJHb29kc0lkOiBpdGVtLmdvb2RzSWQsCiAgICAgICAgLy8gICAgIGV2YWx1YXRpb25UeXBlOiB0aGlzLmdldFJhdGUoKSwKICAgICAgICAvLyAgICAgcmF0aW5nOiB0aGlzLnJhdGVNYXBbaXRlbS5nb29kc0lkXSwKICAgICAgICAvLyAgICAgb3JkZXJJZDogdGhpcy5vcmRlcklkLAogICAgICAgIC8vICAgICBjb250ZW50OiBjb250ZW50IHx8IHRoaXMuJHQoJ21lc3NhZ2UuaG9tZS5kZWZhdWx0UmF0ZScpLAogICAgICAgIC8vIH0pCiAgICAgICAgLy8gdGhpcy5yZXN1bHRNYXBbaXRlbS5nb29kc0lkXSA9IHRydWUKICAgICAgICBjb25zdCBldmFsdWF0aW9uQWRkcyA9IFtdOwogICAgICAgIC8vIGNvbnN0IGNhbkNvbnRpbnVlID0gdHJ1ZTsKICAgICAgICBmb3IgKGxldCB7CiAgICAgICAgICBnb29kc0lkCiAgICAgICAgfSBvZiB0aGlzLm9yZGVyR29vZHMpIHsKICAgICAgICAgIHZhciBfdGhpcyRpbWFnZXNNYXAkZ29vZHMzLCBfdGhpcyRpbWFnZXNNYXAkZ29vZHM0OwogICAgICAgICAgY29uc3QgZXZhbHVhdGlvbiA9IHsKICAgICAgICAgICAgc2VsbGVyR29vZHNJZDogZ29vZHNJZCwKICAgICAgICAgICAgZXZhbHVhdGlvblR5cGU6IHRoaXMuZ2V0UmF0ZShnb29kc0lkKSwKICAgICAgICAgICAgcmF0aW5nOiB0aGlzLnJhdGVNYXBbZ29vZHNJZF0sCiAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMuY29udGVudE1hcFtnb29kc0lkXQogICAgICAgICAgfTsKICAgICAgICAgIGNvbnN0IG5vdFVwbG9hZCA9IChfdGhpcyRpbWFnZXNNYXAkZ29vZHMzID0gdGhpcy5pbWFnZXNNYXBbZ29vZHNJZF0pID09PSBudWxsIHx8IF90aGlzJGltYWdlc01hcCRnb29kczMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGltYWdlc01hcCRnb29kczMuZmlsdGVyKHggPT4gIXgucmVzcG9uc2UpOwogICAgICAgICAgaWYgKG5vdFVwbG9hZCAmJiBub3RVcGxvYWQubGVuZ3RoID4gMCkgewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAvLyB0aXRsZTogdGhpcy4kdCgnbWVzc2FnZS5ob21lLnN1Y2Nlc3NUaXBzJyksCiAgICAgICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgibWVzc2FnZS5ob21lLmV2YWx1YXRpb25VcGxvYWRpbmciKSwKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCBpbWFnZVVybHMgPSAoKF90aGlzJGltYWdlc01hcCRnb29kczQgPSB0aGlzLmltYWdlc01hcFtnb29kc0lkXSkgPT09IG51bGwgfHwgX3RoaXMkaW1hZ2VzTWFwJGdvb2RzNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkaW1hZ2VzTWFwJGdvb2RzNC5maWx0ZXIoeCA9PiB4LnJlc3BvbnNlICYmIHgucmVzcG9uc2UuY29kZSA9PSAiMCIpLm1hcCh4ID0+IHgucmVzcG9uc2UuZGF0YSkpIHx8IFtdOwogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbWFnZVVybHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgZXZhbHVhdGlvbltgaW1nVXJsJHtpICsgMX1gXSA9IGltYWdlVXJsc1tpXTsKICAgICAgICAgIH0KICAgICAgICAgIGV2YWx1YXRpb25BZGRzLnB1c2goZXZhbHVhdGlvbik7CiAgICAgICAgfQogICAgICAgIGxldCByZXMgPSBhd2FpdCBBZGRPcmRlckV2YWx1YXRlTGlzdCh7CiAgICAgICAgICBvcmRlcklkOiB0aGlzLm9yZGVySWQsCiAgICAgICAgICBldmFsdWF0aW9uQWRkcwogICAgICAgIH0pOwogICAgICAgIGlmIChyZXMuY29kZSA9PSAwKSB7CiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgIHBhdGg6ICIvdXNlckluZm8vbXktb3JkZXIiLAogICAgICAgICAgICByZXBsYWNlOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgIHRpdGxlOiB0aGlzLiR0KCJtZXNzYWdlLmhvbWUuc3VjY2Vzc1RpcHMiKSwKICAgICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgibWVzc2FnZS5ob21lLmV2YWx1YXRlT3JkZXJTdWNjZXNzIiksCiAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIgogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgLy8gICB0aXRsZTogdGhpcy4kdCgnbWVzc2FnZS5ob21lLmZ1aWxUaXBzJyksCiAgICAgICAgICAvLyAgIG1lc3NhZ2U6IHRoaXMuJHQoIm1lc3NhZ2UuaG9tZS5ldmFsdWF0ZU9yZGVyRnVpbCIpLAogICAgICAgICAgLy8gICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgLy8gfSk7CiAgICAgICAgfQoKICAgICAgICAvLyB0aGlzLiRlbWl0KCJjbG9zZURldGFpbHMiKTsKICAgICAgICAvLyB0aGlzLnJlZnJlc2ggJiYgdGhpcy5yZWZyZXNoKCkKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0aGlzLmJ0bkxvYWRpbmcgPSBmYWxzZTsKICAgICAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBudW1iZXJGb3JtYXRGbihudW0pIHsKICAgICAgcmV0dXJuIG51bWJlckZvcm1hdChudW0pOwogICAgfQogIH0KfTs="},{"version":3,"names":["mapGetters","mapActions","numberFormat","UploadApi","AddOrderEvaluateList","name","props","value","type","Boolean","default","refresh","Function","data","orderId","$route","query","loading","rateMap","contentMap","imagesMap","resultMap","dialogImageUrl","isUpload","dialogVisible","disabled","uploadParams","moduleName","token","localStorage","getItem","mounted","requestData","computed","orderGoods","watch","newValue","forEach","item","goodsId","methods","requestOrderGoodsList","requestOrderEvaluationList","uploadFile","params","console","log","handleRemove","file","_this$imagesMap$goods","_this$imagesMap$goods2","index","findIndex","x","uid","splice","handlePictureCardPreview","url","handleFilesChange","files","length","$message","warning","$t","goBack","$router","push","getRate","id","submit","btnLoading","evaluationAdds","_this$imagesMap$goods3","_this$imagesMap$goods4","evaluation","sellerGoodsId","evaluationType","rating","content","notUpload","filter","response","message","imageUrls","code","map","i","res","path","replace","$notify","title","numberFormatFn","num"],"sources":["src/page/userInfo/my-order/order-evaluation.vue"],"sourcesContent":["<template>\r\n  <div\r\n    class=\"evaluation-list\"\r\n    style=\"width: 866px; margin-top: 24px\"\r\n    v-loading=\"loading\"\r\n  >\r\n    <div\r\n      class=\"page-title\"\r\n      style=\"cursor: pointer; margin-bottom: 20px; margin-left: 34px\"\r\n      @click=\"goBack\"\r\n    >\r\n      <i class=\"el-icon-arrow-left\"></i> {{ $t(\"message.home.myOrder\") }}/{{\r\n        $t(\"message.home.Submitareview\")\r\n      }}\r\n    </div>\r\n    <div\r\n      class=\"evaluation-item\"\r\n      v-for=\"(item, index) in orderGoods\"\r\n      :key=\"item.id\"\r\n    >\r\n      <div style=\"margin-left: 40px; margin-top: 30px\">\r\n        <div class=\"product-item\">\r\n          <el-image\r\n            style=\"width: 62px; height: 62px\"\r\n            fit=\"scale-down\"\r\n            :src=\"item.goodsIcon\"\r\n            alt=\"order-detail-product\"\r\n          />\r\n          <div class=\"info\">\r\n            <div class=\"tit\">{{ item.goodsName }}</div>\r\n            <div\r\n              style=\"margin-top: 9px; font-size: 12px\"\r\n              v-if=\"item.attributes && item.attributes.length > 0\"\r\n            >\r\n              {{\r\n                item.attributes\r\n                  .map((it) => `${it.attrName}:${it.attrValue}`)\r\n                  .join(\" \")\r\n              }}\r\n            </div>\r\n            <div class=\"price\">${{ numberFormatFn(item.goodsReal) }}</div>\r\n            <el-rate\r\n              v-model=\"rateMap[item.goodsId]\"\r\n              :disabled=\"resultMap[item.goodsId]\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <el-input\r\n          v-model=\"contentMap[item.goodsId]\"\r\n          class=\"content\"\r\n          type=\"textarea\"\r\n          :placeholder=\"$t('message.home.evaluateOrderPlaceholder')\"\r\n          resize=\"none\"\r\n          :disabled=\"resultMap[item.goodsId]\"\r\n          :maxlength=\"1000\"\r\n          show-word-limit\r\n        />\r\n\r\n        <div style=\"height: 15px\" />\r\n\r\n        <span>{{ $t(\"message.home.evaluateInput\") }}</span>\r\n\r\n        <el-upload\r\n          :data=\"uploadParams\"\r\n          style=\"margin-top: 10px\"\r\n          :action=\"UploadApi\"\r\n          :on-change=\"(_, files) => handleFilesChange(files, item.goodsId)\"\r\n          list-type=\"picture-card\"\r\n          :disabled =\"isUpload\"\r\n        >\r\n          <img\r\n            src=\"@/assets/image/bxs_camera-plus.png\"\r\n            style=\"width: 25.54px; height: 22.81px\"\r\n          />\r\n          <div slot=\"file\" slot-scope=\"{ file }\">\r\n            <img\r\n              class=\"el-upload-list__item-thumbnail\"\r\n              :src=\"file.url\"\r\n              alt=\"\"\r\n            />\r\n            <span class=\"el-upload-list__item-actions\">\r\n              <span\r\n                class=\"el-upload-list__item-preview\"\r\n                @click=\"handlePictureCardPreview(file)\"\r\n              >\r\n                <i class=\"el-icon-zoom-in\"></i>\r\n              </span>\r\n              <span\r\n                v-if=\"!disabled\"\r\n                class=\"el-upload-list__item-delete\"\r\n                @click=\"handleRemove(file, item.goodsId)\"\r\n              >\r\n                <i class=\"el-icon-delete\"></i>\r\n              </span>\r\n            </span>\r\n          </div>\r\n        </el-upload>\r\n      </div>\r\n      <el-divider v-if=\"index < orderGoods.length - 1\"></el-divider>\r\n    </div>\r\n    <div class=\"action\">\r\n      <el-button @click=\"submit\" :disabled=\"disabled\">\r\n        {{ $t(\"message.home.Submitareview\") }}\r\n      </el-button>\r\n    </div>\r\n    <el-dialog :visible.sync=\"dialogVisible\">\r\n      <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\" />\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters, mapActions } from \"vuex\";\r\nimport { numberFormat } from \"@/util\";\r\nimport { UploadApi, AddOrderEvaluateList } from \"@/api\";\r\nexport default {\r\n  name: \"order-evaluation-dialog\",\r\n  props: {\r\n    value: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    // currentOrderInfo: {\r\n    //     type: Object,\r\n    //     default: () => { },\r\n    // },\r\n    refresh: {\r\n      type: Function,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      // currentOrderInfo: this.$route.params?.currentOrderInfo || {},\r\n      // dialogVisible: this.value || false,\r\n      orderId: this.$route.query.orderId,\r\n      loading: false,\r\n      rateMap: {},\r\n      contentMap: {},\r\n      imagesMap: {},\r\n      resultMap: {},\r\n      dialogImageUrl: \"\",\r\n      isUpload:false,\r\n      dialogVisible: false,\r\n      disabled: false,\r\n      UploadApi,\r\n      uploadParams: {\r\n        moduleName: \"evaluate\",\r\n        token: localStorage.getItem(\"ES_TOKEN\"),\r\n      },\r\n    };\r\n  },\r\n  mounted() {\r\n    if (this.orderId) {\r\n      this.requestData();\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      orderGoods: \"order/orderGoods\",\r\n    }),\r\n  },\r\n  watch: {\r\n    orderGoods(newValue) {\r\n      let rateMap = {};\r\n      let contentMap = {};\r\n      let resultMap = {};\r\n\r\n      newValue.forEach((item) => {\r\n        rateMap[item.goodsId] = 5;\r\n        contentMap[item.goodsId] = \"\";\r\n        resultMap[item.goodsId] = false;\r\n      });\r\n\r\n      this.rateMap = { ...rateMap };\r\n      this.contentMap = { ...contentMap };\r\n      this.resultMap = { ...resultMap };\r\n    },\r\n\r\n  },\r\n  methods: {\r\n    ...mapActions({\r\n      requestOrderGoodsList: \"order/requestOrderGoodsList\",\r\n      requestOrderEvaluationList: \"order/requestOrderEvaluationList\",\r\n    }),\r\n    uploadFile(params, goodsId) {\r\n      console.log(goodsId, params);\r\n    },\r\n\r\n    handleRemove(file, goodsId) {\r\n      const index = this.imagesMap[goodsId]?.findIndex(\r\n        (x) => x.uid == file.uid\r\n      );\r\n      index >= 0 && this.imagesMap[goodsId]?.splice(index, 1);\r\n    },\r\n    handlePictureCardPreview(file) {\r\n      this.dialogImageUrl = file.url;\r\n      this.dialogVisible = true;\r\n    },\r\n\r\n    handleFilesChange(files, goodsId) {\r\n      if (files.length >8) {\r\n        this.$message.warning(this.$t(\"message.home.最多上传9张图片\"));\r\n        this.isUpload = true\r\n      }else{\r\n        this.imagesMap[goodsId] = files;\r\n      }\r\n      \r\n    },\r\n\r\n    goBack() {\r\n      this.$router.push(\"/userInfo/my-order\");\r\n    },\r\n    getRate(id) {\r\n      if (this.rateMap[id] < 2) {\r\n        return 3;\r\n      } else if (this.rateMap[id] < 4) {\r\n        return 2;\r\n      }\r\n      return 1;\r\n    },\r\n    async requestData() {\r\n      try {\r\n        this.loading = true;\r\n        await this.requestOrderGoodsList({ orderId: this.orderId });\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    async submit() {\r\n      // const content = this.contentMap[item.goodsId]?.trim() ?? ''\r\n      // if (!content) {\r\n      //   this.$message.warning(this.$t('message.home.evaluateOrderPlaceholder'))\r\n      //   return\r\n      // }\r\n\r\n      try {\r\n        this.btnLoading = true;\r\n        this.disabled = true;\r\n        // await this.requestOrderEvaluationList({\r\n        //     sellerGoodsId: item.goodsId,\r\n        //     evaluationType: this.getRate(),\r\n        //     rating: this.rateMap[item.goodsId],\r\n        //     orderId: this.orderId,\r\n        //     content: content || this.$t('message.home.defaultRate'),\r\n        // })\r\n        // this.resultMap[item.goodsId] = true\r\n        const evaluationAdds = [];\r\n        // const canContinue = true;\r\n        for (let { goodsId } of this.orderGoods) {\r\n          const evaluation = {\r\n            sellerGoodsId: goodsId,\r\n            evaluationType: this.getRate(goodsId),\r\n            rating: this.rateMap[goodsId],\r\n            content: this.contentMap[goodsId],\r\n          };\r\n\r\n          const notUpload = this.imagesMap[goodsId]?.filter((x) => !x.response);\r\n\r\n          if (notUpload && notUpload.length > 0) {\r\n            this.$message({\r\n              // title: this.$t('message.home.successTips'),\r\n              message: this.$t(\"message.home.evaluationUploading\"),\r\n              type: \"error\",\r\n            });\r\n            return;\r\n          }\r\n\r\n          const imageUrls =\r\n            this.imagesMap[goodsId]\r\n              ?.filter((x) => x.response && x.response.code == \"0\")\r\n              .map((x) => x.response.data) || [];\r\n\r\n          for (let i = 0; i < imageUrls.length; i++) {\r\n            evaluation[`imgUrl${i + 1}`] = imageUrls[i];\r\n          }\r\n          evaluationAdds.push(evaluation);\r\n        }\r\n\r\n        let res = await AddOrderEvaluateList({\r\n          orderId: this.orderId,\r\n          evaluationAdds,\r\n        });\r\n\r\n        if (res.code == 0) {\r\n          this.$router.push({path:\"/userInfo/my-order\",replace:true});\r\n          this.$notify({\r\n            title: this.$t(\"message.home.successTips\"),\r\n            message: this.$t(\"message.home.evaluateOrderSuccess\"),\r\n            type: \"success\",\r\n          });\r\n        }else{\r\n          // this.$message({\r\n          //   title: this.$t('message.home.fuilTips'),\r\n          //   message: this.$t(\"message.home.evaluateOrderFuil\"),\r\n          //   type: \"error\",\r\n          // });\r\n        }\r\n\r\n        // this.$emit(\"closeDetails\");\r\n        // this.refresh && this.refresh()\r\n      } finally {\r\n        this.btnLoading = false;\r\n        this.disabled = false;\r\n      }\r\n    },\r\n\r\n    numberFormatFn(num) {\r\n      return numberFormat(num);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.evaluation-list {\r\n  /deep/ .el-upload--picture-card {\r\n    width: 70px;\r\n    height: 70px;\r\n  }\r\n\r\n  /deep/ .el-upload {\r\n    width: 70px;\r\n    height: 70px;\r\n    line-height: 70px;\r\n  }\r\n\r\n  /deep/ .el-upload-list--picture-card .el-upload-list__item {\r\n    width: 70px;\r\n    height: 70px;\r\n    line-height: 70px;\r\n  }\r\n\r\n  /deep/ .el-upload-list--picture-card .el-upload-list__item-thumbnail {\r\n    width: 70px;\r\n    height: 70px;\r\n    line-height: 70px;\r\n  }\r\n\r\n  .evaluation-item {\r\n    + .evaluation-item {\r\n      margin-top: 18px;\r\n    }\r\n\r\n    .product-item {\r\n      display: flex;\r\n      flex-direction: row;\r\n\r\n      img {\r\n        width: 62px;\r\n        height: 62px;\r\n      }\r\n\r\n      .info {\r\n        margin-left: 18px;\r\n        flex: 1;\r\n\r\n        .price {\r\n          font-weight: 500;\r\n          font-size: 16px;\r\n          color: var(--color-main);\r\n          margin-top: 8px;\r\n        }\r\n\r\n        .el-rate {\r\n          margin-top: 5px;\r\n        }\r\n      }\r\n    }\r\n\r\n    .content {\r\n      margin-top: 25px;\r\n\r\n      .el-textarea__inner {\r\n        border: 1px solid #efefef;\r\n        height: 70px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.action {\r\n  // padding: 20px 0;\r\n  display: flex;\r\n  align-items: center;\r\n  // justify-content: center;\r\n  margin-top: 52px;\r\n  margin-left: 34px;\r\n\r\n  .el-button {\r\n    width: 480px;\r\n    height: 44px;\r\n    color: #fff;\r\n    background: var(--color-main);\r\n    border-color: var(--color-main);\r\n    border-radius: 4px;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]}]}