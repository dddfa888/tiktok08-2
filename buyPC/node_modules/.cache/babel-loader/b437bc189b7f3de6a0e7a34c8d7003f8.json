{"remainingRequest":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\src\\components\\customService\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\src\\components\\customService\\index.vue","mtime":1764639528367},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\babel.config.js","mtime":1760944158066},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1761044715083},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\babel-loader\\lib\\index.js","mtime":1761044716268},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1761044715083},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\vue-loader\\lib\\index.js","mtime":1761044716737}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS1hbGwuanMiOwppbXBvcnQgeyBVcGxvYWRBcGkgfSBmcm9tICJAL2FwaSI7CmltcG9ydCBWaXJ0dWFsTGlzdCBmcm9tICJ2dWUtdmlydHVhbC1zY3JvbGwtbGlzdCI7Ci8vIGltcG9ydCBWaXJ0dWFsTGlzdCBmcm9tICJAL2NvbXBvbmVudHMvdnVlLXZpcnR1YWwtc2Nyb2xsLWxpc3QiOwppbXBvcnQgeyBtYXBBY3Rpb25zLCBtYXBHZXR0ZXJzIH0gZnJvbSAidnVleCI7CmltcG9ydCBFc0NoYXRJdGVtVmlldyBmcm9tICIuL2l0ZW0udnVlIjsKaW1wb3J0IHsgRVNfVE9LRU4sIEVTX01FU1NBR0VfTEFTVF9JRCB9IGZyb20gIkAvY29tbW9uIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IFVSTCBmcm9tICJAL2NvbmZpZy9pbmRleCI7CmltcG9ydCBWdWVEcmFnZ2FibGVSZXNpemFibGUgZnJvbSAidnVlLWRyYWdnYWJsZS1yZXNpemFibGUiOwovLyBpbXBvcnQgeyBnZXRCYXNlNjQgfSBmcm9tICJAL3V0aWwiOwpjb25zdCB1c2VySWNvbiA9IHJlcXVpcmUoIkAvYXNzZXRzL2ltYWdlL3VzZXJJY29uLnBuZyIpOwovLyBpbXBvcnQgbG9nb1N2ZyBmcm9tICJAL2Fzc2V0cy9pbWFnZS9tYXRlc2hvcC1iLnN2ZyI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRXNDdXN0b21lclNlcnZpY2UiLAogIGNvbXBvbmVudHM6IHsKICAgIFZpcnR1YWxMaXN0LAogICAgVnVlRHJhZ2dhYmxlUmVzaXphYmxlCiAgfSwKICBwcm9wczogewogICAgc2hvdzogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfQogICAgLy8geE51bTogewogICAgLy8gICB0eXBlOiBOdW1iZXIsCiAgICAvLyAgIGRlZmF1bHQ6IDAsCiAgICAvLyB9LAogICAgLy8geU51bTogewogICAgLy8gICB0eXBlOiBOdW1iZXIsCiAgICAvLyAgIGRlZmF1bHQ6IDAsCiAgICAvLyB9LAogIH0sCiAgbW9kZWw6IHsKICAgIHByb3A6ICJzaG93IiwKICAgIGV2ZW50OiAidXBkYXRlIgogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGl0ZW1uYW1lOiBwcm9jZXNzLmVudi5WVUVfQVBQX0lURU1fTkFNRSwKICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIGNoYXRJdGVtVmlldzogRXNDaGF0SXRlbVZpZXcsCiAgICAgIG1lc3NhZ2U6ICIiLAogICAgICBpbWFnZVVybDogIiIsCiAgICAgIHNlbmRMb2FkaW5nOiBmYWxzZSwKICAgICAgVXBsb2FkQXBpLAogICAgICB1cGxvYWRQYXJhbXM6IHsKICAgICAgICBtb2R1bGVOYW1lOiAib25saW5lIiwKICAgICAgICB0b2tlbjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oRVNfVE9LRU4pCiAgICAgIH0sCiAgICAgIHRpbWVyOiBudWxsLAogICAgICB4OiAwLAogICAgICB5OiAwLAogICAgICB3dDogMCwKICAgICAgaGk6IDAKICAgICAgLy8gc2hvcEltZzogbG9nb1N2ZywKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyh7CiAgICAgIHVucmVhZE1lc3NhZ2VMaXN0OiAidXNlci91bnJlYWRNZXNzYWdlTGlzdCIsCiAgICAgIG1lc3NhZ2VMaXN0OiAidXNlci9tZXNzYWdlTGlzdCIsCiAgICAgIHVzZXJJbmZvOiAidXNlckluZm8iLAogICAgICBpc2xvZ2luOiAiaXNMb2dpbiIKICAgIH0pLAogICAgY2hhdExpc3QoKSB7CiAgICAgIHJldHVybiB0aGlzLm1lc3NhZ2VMaXN0Lm1hcChpdGVtID0+ICh7CiAgICAgICAgaWQ6IGl0ZW0uaWQsCiAgICAgICAgdXNlckljb24sCiAgICAgICAgaXNTZWxmOiBpdGVtLnNlbmRfcmVjZWl2ZSA9PT0gInNlbmQiLAogICAgICAgIGNvbnRlbnQ6IGl0ZW0uY29udGVudC5yZXBsYWNlQWxsKCJcbiIsICI8YnIvPiIpLAogICAgICAgIGNvbnRlbnRUeXBlOiBpdGVtLnR5cGUsCiAgICAgICAgZGF0ZTogaXRlbS5jcmVhdGV0aW1lLAogICAgICAgIGRlbGV0ZV9zdGF0dXM6IGl0ZW0uZGVsZXRlX3N0YXR1cwogICAgICB9KSkucmV2ZXJzZSgpOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIGFzeW5jIGRpYWxvZ1Zpc2libGUobmV3VmFsdWUsIG9sZFZhbHVlKSB7CiAgICAgIGlmIChuZXdWYWx1ZSAhPT0gb2xkVmFsdWUpIHRoaXMuJGVtaXQoInVwZGF0ZSIsIG5ld1ZhbHVlKTsKICAgICAgaWYgKG5ld1ZhbHVlKSB7CiAgICAgICAgLy8gZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICAgIGNvbnN0IGxhc3RJZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKEVTX01FU1NBR0VfTEFTVF9JRCk7CiAgICAgICAgYXdhaXQgdGhpcy5yZXF1ZXN0VW5yZWFkTWVzc2FnZUxpc3QoKTsKICAgICAgICBhd2FpdCB0aGlzLnJlcXVlc3RNZXNzYWdlTGlzdChsYXN0SWQgPyB7CiAgICAgICAgICBtZXNzYWdlX2lkOiBsYXN0SWQKICAgICAgICB9IDoge30pOwogICAgICAgIHRoaXMuc2Nyb2xsQm90dG9tKCk7CiAgICAgICAgdGhpcy5zdGFydFRpbWVyKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJ2aXNpYmxlIjsKICAgICAgICB0aGlzLmVuZFRpbWVyKCk7CiAgICAgIH0KICAgIH0sCiAgICBzaG93KG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgICBpZiAobmV3VmFsdWUgIT09IG9sZFZhbHVlKSB0aGlzLmRpYWxvZ1Zpc2libGUgPSBuZXdWYWx1ZTsKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0aGlzLnNob3c7CiAgICB0aGlzLnd0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIC0gNDgwOwogICAgdGhpcy5oaSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLSA2ODA7CiAgICAvLyBjb25zb2xlLmxvZygidGhpcy4kc3RvcmUgLT4iLCB0aGlzLnVzZXJJbmZvKTsKICB9LAogIGRlc3Ryb3llZCgpIHsKICAgIHRoaXMuZW5kVGltZXIoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC4uLm1hcEFjdGlvbnMoewogICAgICByZXF1ZXN0TWVzc2FnZUxpc3Q6ICJ1c2VyL3JlcXVlc3RNZXNzYWdlTGlzdCIsCiAgICAgIHJlcXVlc3RVbnJlYWRNZXNzYWdlTGlzdDogInVzZXIvcmVxdWVzdFVucmVhZE1lc3NhZ2VMaXN0IiwKICAgICAgcmVxdWVzdFNlbmRNZXNzYWdlOiAidXNlci9yZXF1ZXN0U2VuZE1lc3NhZ2UiCiAgICB9KSwKICAgIG9uRHJhZzogZnVuY3Rpb24gKHgsIHkpIHsKICAgICAgaWYgKHggPCAyKSB7CiAgICAgICAgdGhpcy54ID0gMjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnggPSB4OwogICAgICAgIHRoaXMueSA9IHk7CiAgICAgIH0KICAgIH0sCiAgICBjbG9zZVNldmljZSgpIHsKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2U7CiAgICB9LAogICAgYXN5bmMgc3RhcnRUaW1lcigpIHsKICAgICAgdGhpcy5lbmRUaW1lcigpOwogICAgICBhd2FpdCB0aGlzLnJlcXVlc3RNZXNzYWdlTGlzdCgpOwogICAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4gewogICAgICAgIHRoaXMucmVxdWVzdFVucmVhZE1lc3NhZ2VMaXN0KCk7CiAgICAgICAgYXdhaXQgdGhpcy5yZXF1ZXN0TWVzc2FnZUxpc3QoKTsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShFU19NRVNTQUdFX0xBU1RfSUQsIHRoaXMubWVzc2FnZUxpc3RbMF0uaWQpOwogICAgICB9LCA1MDAwKTsKICAgIH0sCiAgICBlbmRUaW1lcigpIHsKICAgICAgdGhpcy50aW1lciAmJiBjbGVhckludGVydmFsKHRoaXMudGltZXIpOwogICAgfSwKICAgIHNjcm9sbEJvdHRvbSgpIHsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgY29uc3QgJCR3cmFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmN1c3RvbWVyLXNlcnZpY2UtbGlzdCIpOwogICAgICAgICQkd3JhcC5zY3JvbGxUbygwLCAkJHdyYXAuc2Nyb2xsSGVpZ2h0KTsKICAgICAgfSwgMzAwKTsKICAgIH0sCiAgICBhc3luYyBzZW5kKCkgewogICAgICB0cnkgewogICAgICAgIHRoaXMuc2VuZExvYWRpbmcgPSB0cnVlOwogICAgICAgIGNvbnNvbGUubG9nKCJ0aGlzLm1lc3NhZ2UgLT4iLCB0aGlzLm1lc3NhZ2UpOwogICAgICAgIHRoaXMubWVzc2FnZSA9IGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLm1lc3NhZ2UpOwogICAgICAgIHRoaXMucmVxdWVzdFNlbmRNZXNzYWdlKHsKICAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgICAgIGNvbnRlbnQ6IHRoaXMubWVzc2FnZQogICAgICAgIH0pOwogICAgICAgIHRoaXMubWVzc2FnZSA9ICIiOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgdGhpcy5yZXF1ZXN0TWVzc2FnZUxpc3QoKTsKICAgICAgICAgIHRoaXMuc2Nyb2xsQm90dG9tKCk7CiAgICAgICAgfSwgMTAwMCk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdGhpcy5zZW5kTG9hZGluZyA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgYmVmb3JlVXBsb2FkKGZpbGUpIHsKICAgICAgaWYgKCFbImltYWdlL2pwZWciLCAiaW1hZ2UvanBnIiwgImltYWdlL3BuZyJdLmluY2x1ZGVzKGZpbGUudHlwZSkpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuIHRydWU7CiAgICB9LAogICAgLy8gdXBsb2FkU3VjY2VzcyhyZXMsIGZpbGUpIHsKICAgIC8vICAgdGhpcy5pbWFnZVVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZS5yYXcpCiAgICAvLyAgIHRoaXMuYWRkRGF0YSh0aGlzLmltYWdlVXJsLCAnaW1hZ2UnKQogICAgLy8gfSwKICAgIC8vIG9uU3VjY2VzcyhyZXNwb25zZSwgZmlsZSkgewogICAgLy8gICBjb25zb2xlLmxvZyhyZXNwb25zZSwgZmlsZSkKICAgIC8vICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKQogICAgLy8gICBmb3JtRGF0YS5hcHBlbmQoZmlsZSwgZmlsZSkKCiAgICAvLyAgIHRyeSB7CiAgICAvLyAgICAgdGhpcy5zZW5kTG9hZGluZyA9IHRydWUKICAgIC8vICAgICB0aGlzLnJlcXVlc3RTZW5kTWVzc2FnZSh7CiAgICAvLyAgICAgICB0eXBlOiAnaW1nJywKICAgIC8vICAgICAgIGNvbnRlbnQ6IHJlc3BvbnNlLmRhdGEsCiAgICAvLyAgICAgICBmaWxlOiBmb3JtRGF0YSwKICAgIC8vICAgICB9KQogICAgLy8gICAgIC8vIHRoaXMubWVzc2FnZSA9ICcnCiAgICAvLyAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAvLyAgICAgICB0aGlzLnJlcXVlc3RNZXNzYWdlTGlzdCgpCiAgICAvLyAgICAgICB0aGlzLnNjcm9sbEJvdHRvbSgpCiAgICAvLyAgICAgfSwgMTAwMCkKICAgIC8vICAgfSBmaW5hbGx5IHsKICAgIC8vICAgICB0aGlzLnNlbmRMb2FkaW5nID0gZmFsc2UKICAgIC8vICAgfQogICAgLy8gfSwKICAgIGFzeW5jIHNlbmRJbWFnZUNvbnRlbnQoZGF0YSkgewogICAgICB2YXIgdCA9IHRoaXM7CiAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgiZmlsZSIsIGRhdGEuZmlsZSk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgibW9kdWxlTmFtZSIsICIxMjMiKTsKICAgICAgLy8gZm9ybURhdGEuYXBwZW5kKCd0eXBlJywgJ2ltZycpCiAgICAgIC8vIGZvcm1EYXRhLmFwcGVuZCgnY29udGVudCcsIGF3YWl0IGdldEJhc2U2NChkYXRhLmZpbGUpKQogICAgICAvLyBmb3JtRGF0YS5hcHBlbmQoJ3Rva2VuJywgbG9jYWxTdG9yYWdlLmdldEl0ZW0oRVNfVE9LRU4pKQoKICAgICAgLy8gIGNvbnN0IGZpbGVTdWZmaXggPSBkYXRhLmZpbGUubmFtZS5zdWJzdHJpbmcoZmlsZS5uYW1lLmxhc3RJbmRleE9mKCcuJykgKyAxKQogICAgICAvLyBjb25zdCB3aGl0ZUxpc3QgPSBbJ3BkZicsICdkb2MnLCAnZG9jeCddCiAgICAgIC8vIGNvbnN0IGlzU3VmZml4ID0gd2hpdGVMaXN0LmluZGV4T2YoZmlsZVN1ZmZpeC50b0xvd2VyQ2FzZSgpKSA9PT0gLTEKICAgICAgLy8gY29uc29sZS5sb2coJ2ZpbGVTdWZmaXggLT4nLCBmaWxlU3VmZml4KTsKICAgICAgYXhpb3MucG9zdChgJHtVUkwuQkFTRV9VUkx9YXBpL3VwbG9hZGltZyFleGVjdXRlLmFjdGlvbmAsIGZvcm1EYXRhLCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJtdWx0aXBhcnQvZm9ybS1kYXRhIgogICAgICAgIH0KICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHQuc2VuZExvYWRpbmcgPSB0cnVlOwogICAgICAgICAgdC5yZXF1ZXN0U2VuZE1lc3NhZ2UoewogICAgICAgICAgICB0eXBlOiAiaW1nIiwKICAgICAgICAgICAgY29udGVudDogcmVzLmRhdGEuZGF0YQogICAgICAgICAgfSk7CiAgICAgICAgICAvLyB0Lm1lc3NhZ2UgPSAnJwogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHQucmVxdWVzdE1lc3NhZ2VMaXN0KCk7CiAgICAgICAgICAgIHQuc2Nyb2xsQm90dG9tKCk7CiAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgdC5zZW5kTG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["UploadApi","VirtualList","mapActions","mapGetters","EsChatItemView","ES_TOKEN","ES_MESSAGE_LAST_ID","axios","URL","VueDraggableResizable","userIcon","require","name","components","props","show","type","Boolean","default","model","prop","event","data","itemname","process","env","VUE_APP_ITEM_NAME","dialogVisible","chatItemView","message","imageUrl","sendLoading","uploadParams","moduleName","token","localStorage","getItem","timer","x","y","wt","hi","computed","unreadMessageList","messageList","userInfo","islogin","chatList","map","item","id","isSelf","send_receive","content","replaceAll","contentType","date","createtime","delete_status","reverse","watch","newValue","oldValue","$emit","lastId","requestUnreadMessageList","requestMessageList","message_id","scrollBottom","startTimer","document","body","style","overflow","endTimer","mounted","documentElement","clientWidth","clientHeight","destroyed","methods","requestSendMessage","onDrag","closeSevice","setInterval","setItem","clearInterval","setTimeout","$$wrap","querySelector","scrollTo","scrollHeight","send","console","log","encodeURIComponent","beforeUpload","file","includes","sendImageContent","t","formData","FormData","append","post","BASE_URL","headers","then","res"],"sources":["src/components/customService/index.vue"],"sourcesContent":["<template>\r\n  <div v-if=\"dialogVisible\" class=\"tuodong\">\r\n    <VueDraggableResizable\r\n      style=\"position: fixed;\"\r\n      v-on:dragging=\"onDrag\"\r\n      :w=\"480\"\r\n      :h=\"680\"\r\n      :x=\"wt\"\r\n      :y=\"hi\"\r\n      :active=\"dialogVisible\"\r\n    >\r\n      <el-dialog\r\n        class=\"es-dialog customer-service-dialog\"\r\n        :visible.sync=\"dialogVisible\"\r\n        :center=\"true\"\r\n        :append-to-body=\"false\"\r\n        :destroy-on-close=\"true\"\r\n        :modal-append-to-body=\"false\"\r\n        :modal=\"false\"\r\n        :show-close=\"false\"\r\n        :lock-scroll=\"true\"\r\n      >\r\n        <div slot=\"title\" class=\"dialog-title\">\r\n          <div class=\"left\">\r\n            <img :src=\"require(`@/assets/image/${itemname}/TikToklogo.png`)\" />\r\n            <span style=\"text-wrap: nowrap\">{{ $t(\"message.home.helpLine\") }}</span>\r\n          </div>\r\n          <div class=\"right\" @click=\"closeSevice\">\r\n            <img src=\"@/assets/image/icon00.png\" />\r\n          </div>\r\n        </div>\r\n        <div class=\"customer-service\">\r\n          <div class=\"customer-service-list\">\r\n            <VirtualList\r\n              ref=\"messageListRef\"\r\n              class=\"list\"\r\n              data-key=\"id\"\r\n              :data-sources=\"chatList\"\r\n              :data-component=\"chatItemView\"\r\n              :estimate-size=\"200\"\r\n              page-mode\r\n            />\r\n          </div>\r\n\r\n          <div class=\"customer-service-footer\">\r\n            <el-upload\r\n              class=\"avatar-uploader\"\r\n              :action=\"UploadApi\"\r\n              :show-file-list=\"false\"\r\n              :http-request=\"sendImageContent\"\r\n              accept=\".jpg, .jpeg, .png, .bmp, .pdf, .JPG, .JPEG, .PBG, .BMP, .PDF\"\r\n              :before-upload=\"beforeUpload\"\r\n            >\r\n              <i class=\"el-icon-picture-outline\"></i>\r\n            </el-upload>\r\n            <el-input\r\n              v-model=\"message\"\r\n              type=\"textarea\"\r\n              :rows=\"1\"\r\n              :placeholder=\"$t('message.home.enterTips')\"\r\n              @keyup.enter.native=\"send\"\r\n            />\r\n            <el-button\r\n              type=\"priamry\"\r\n              @click=\"send\"\r\n              :loading=\"sendLoading\"\r\n            >{{ $t(\"message.home.send\") }}</el-button>\r\n          </div>\r\n        </div>\r\n      </el-dialog>\r\n    </VueDraggableResizable>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { UploadApi } from \"@/api\";\r\nimport VirtualList from \"vue-virtual-scroll-list\";\r\n// import VirtualList from \"@/components/vue-virtual-scroll-list\";\r\nimport { mapActions, mapGetters } from \"vuex\";\r\nimport EsChatItemView from \"./item.vue\";\r\nimport { ES_TOKEN, ES_MESSAGE_LAST_ID } from \"@/common\";\r\nimport axios from \"axios\";\r\nimport URL from \"@/config/index\";\r\nimport VueDraggableResizable from \"vue-draggable-resizable\";\r\n// import { getBase64 } from \"@/util\";\r\nconst userIcon = require(\"@/assets/image/userIcon.png\");\r\n// import logoSvg from \"@/assets/image/mateshop-b.svg\";\r\nexport default {\r\n  name: \"EsCustomerService\",\r\n  components: { VirtualList, VueDraggableResizable },\r\n  props: {\r\n    show: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n    // xNum: {\r\n    //   type: Number,\r\n    //   default: 0,\r\n    // },\r\n    // yNum: {\r\n    //   type: Number,\r\n    //   default: 0,\r\n    // },\r\n  },\r\n  model: {\r\n    prop: \"show\",\r\n    event: \"update\"\r\n  },\r\n  data() {\r\n    return {\r\n      itemname: process.env.VUE_APP_ITEM_NAME,\r\n      dialogVisible: false,\r\n      chatItemView: EsChatItemView,\r\n      message: \"\",\r\n      imageUrl: \"\",\r\n      sendLoading: false,\r\n      UploadApi,\r\n      uploadParams: {\r\n        moduleName: \"online\",\r\n        token: localStorage.getItem(ES_TOKEN)\r\n      },\r\n      timer: null,\r\n      x: 0,\r\n      y: 0,\r\n      wt: 0,\r\n      hi: 0\r\n      // shopImg: logoSvg,\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      unreadMessageList: \"user/unreadMessageList\",\r\n      messageList: \"user/messageList\",\r\n      userInfo: \"userInfo\",\r\n      islogin: \"isLogin\"\r\n    }),\r\n    chatList() {\r\n      return this.messageList\r\n        .map(item => ({\r\n          id: item.id,\r\n          userIcon,\r\n          isSelf: item.send_receive === \"send\",\r\n          content: item.content.replaceAll(\"\\n\", \"<br/>\"),\r\n          contentType: item.type,\r\n          date: item.createtime,\r\n          delete_status: item.delete_status\r\n        }))\r\n        .reverse();\r\n    }\r\n  },\r\n  watch: {\r\n    async dialogVisible(newValue, oldValue) {\r\n      if (newValue !== oldValue) this.$emit(\"update\", newValue);\r\n      if (newValue) {\r\n        // document.body.style.overflow = \"hidden\";\r\n        const lastId = localStorage.getItem(ES_MESSAGE_LAST_ID);\r\n        await this.requestUnreadMessageList();\r\n        await this.requestMessageList(lastId ? { message_id: lastId } : {});\r\n        this.scrollBottom();\r\n        this.startTimer();\r\n      } else {\r\n        document.body.style.overflow = \"visible\";\r\n        this.endTimer();\r\n      }\r\n    },\r\n    show(newValue, oldValue) {\r\n      if (newValue !== oldValue) this.dialogVisible = newValue;\r\n    }\r\n  },\r\n  mounted() {\r\n    this.dialogVisible = this.show;\r\n    this.wt = document.documentElement.clientWidth - 480;\r\n    this.hi = document.documentElement.clientHeight - 680;\r\n    // console.log(\"this.$store ->\", this.userInfo);\r\n  },\r\n  destroyed() {\r\n    this.endTimer();\r\n  },\r\n  methods: {\r\n    ...mapActions({\r\n      requestMessageList: \"user/requestMessageList\",\r\n      requestUnreadMessageList: \"user/requestUnreadMessageList\",\r\n      requestSendMessage: \"user/requestSendMessage\"\r\n    }),\r\n    onDrag: function(x, y) {\r\n      if (x < 2) {\r\n        this.x = 2;\r\n      } else {\r\n        this.x = x;\r\n        this.y = y;\r\n      }\r\n    },\r\n\r\n    closeSevice() {\r\n      this.dialogVisible = false;\r\n    },\r\n    async startTimer() {\r\n      this.endTimer();\r\n      await this.requestMessageList();\r\n      this.timer = setInterval(async () => {\r\n        this.requestUnreadMessageList();\r\n        await this.requestMessageList();\r\n        localStorage.setItem(ES_MESSAGE_LAST_ID, this.messageList[0].id);\r\n      }, 5000);\r\n    },\r\n    endTimer() {\r\n      this.timer && clearInterval(this.timer);\r\n    },\r\n    scrollBottom() {\r\n      setTimeout(() => {\r\n        const $$wrap = document.querySelector(\".customer-service-list\");\r\n        $$wrap.scrollTo(0, $$wrap.scrollHeight);\r\n      }, 300);\r\n    },\r\n\r\n    async send() {\r\n      try {\r\n        this.sendLoading = true;\r\n        console.log(\"this.message ->\", this.message);\r\n        this.message = encodeURIComponent(this.message);\r\n        this.requestSendMessage({\r\n          type: \"text\",\r\n          content: this.message\r\n        });\r\n        this.message = \"\";\r\n        setTimeout(() => {\r\n          this.requestMessageList();\r\n          this.scrollBottom();\r\n        }, 1000);\r\n      } finally {\r\n        this.sendLoading = false;\r\n      }\r\n    },\r\n\r\n    beforeUpload(file) {\r\n      if (![\"image/jpeg\", \"image/jpg\", \"image/png\"].includes(file.type)) {\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n\r\n    // uploadSuccess(res, file) {\r\n    //   this.imageUrl = URL.createObjectURL(file.raw)\r\n    //   this.addData(this.imageUrl, 'image')\r\n    // },\r\n    // onSuccess(response, file) {\r\n    //   console.log(response, file)\r\n    //   const formData = new FormData()\r\n    //   formData.append(file, file)\r\n\r\n    //   try {\r\n    //     this.sendLoading = true\r\n    //     this.requestSendMessage({\r\n    //       type: 'img',\r\n    //       content: response.data,\r\n    //       file: formData,\r\n    //     })\r\n    //     // this.message = ''\r\n    //     setTimeout(() => {\r\n    //       this.requestMessageList()\r\n    //       this.scrollBottom()\r\n    //     }, 1000)\r\n    //   } finally {\r\n    //     this.sendLoading = false\r\n    //   }\r\n    // },\r\n    async sendImageContent(data) {\r\n      var t = this;\r\n      const formData = new FormData();\r\n      formData.append(\"file\", data.file);\r\n      formData.append(\"moduleName\", \"123\");\r\n      // formData.append('type', 'img')\r\n      // formData.append('content', await getBase64(data.file))\r\n      // formData.append('token', localStorage.getItem(ES_TOKEN))\r\n\r\n      //  const fileSuffix = data.file.name.substring(file.name.lastIndexOf('.') + 1)\r\n      // const whiteList = ['pdf', 'doc', 'docx']\r\n      // const isSuffix = whiteList.indexOf(fileSuffix.toLowerCase()) === -1\r\n      // console.log('fileSuffix ->', fileSuffix);\r\n      axios\r\n        .post(`${URL.BASE_URL}api/uploadimg!execute.action`, formData, {\r\n          headers: { \"Content-Type\": \"multipart/form-data\" }\r\n        })\r\n        .then(res => {\r\n          console.log(res);\r\n          try {\r\n            t.sendLoading = true;\r\n            t.requestSendMessage({\r\n              type: \"img\",\r\n              content: res.data.data\r\n            });\r\n            // t.message = ''\r\n            setTimeout(() => {\r\n              t.requestMessageList();\r\n              t.scrollBottom();\r\n            }, 1000);\r\n          } finally {\r\n            t.sendLoading = false;\r\n          }\r\n        });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\nhtml[dir=\"rtl\"] {\r\n  .el-dialog {\r\n    direction: rtl;\r\n  }\r\n  .customer-service-dialog\r\n    .el-dialog\r\n    .el-dialog__header\r\n    .dialog-title\r\n    .left\r\n    img {\r\n    margin-left: 10px;\r\n    margin-right: 0;\r\n  }\r\n  .customer-service .avatar-uploader {\r\n    margin-left: 10px;\r\n    margin-right: 0;\r\n  }\r\n  .customer-service-footer .el-button {\r\n    margin-right: 10px;\r\n    margin-left: 0;\r\n  }\r\n}\r\n.customer-service-dialog {\r\n  .el-dialog {\r\n    position: absolute;\r\n    bottom: 20px;\r\n    right: 20px;\r\n    width: 460px !important;\r\n    height: 646px;\r\n    border-radius: 4px;\r\n    overflow: hidden;\r\n    .el-dialog__header {\r\n      background-color: var(--color-main) !important;\r\n      height: 44px !important;\r\n      padding: 0 10px !important;\r\n      border-bottom-left-radius: 0 !important;\r\n      border-bottom-right-radius: 0 !important;\r\n      .dialog-title {\r\n        background-color: var(--color-main) !important;\r\n        height: 100%;\r\n        width: 100%;\r\n        line-height: 44px;\r\n        font-size: 14px;\r\n        color: #fff;\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        .left {\r\n          display: flex;\r\n          align-items: center;\r\n          img {\r\n            height: 34px;\r\n            margin-right: 10px;\r\n          }\r\n        }\r\n        .right {\r\n          width: 8px;\r\n          cursor: pointer;\r\n          img {\r\n            width: 100%;\r\n            height: 100%;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .el-dialog__body {\r\n      padding: 0 !important;\r\n      height: calc(646px - 44px);\r\n      background-color: #f0f4f9 !important;\r\n    }\r\n  }\r\n}\r\n.customer-service {\r\n  position: relative;\r\n  height: 100%;\r\n  &-list {\r\n    position: relative;\r\n    height: calc(646px - 44px);\r\n    overflow: auto;\r\n    padding: 15px;\r\n    padding-bottom: 44px;\r\n  }\r\n  &-footer {\r\n    position: absolute;\r\n    bottom: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: constant(safe-area-inset-bottom);\r\n    bottom: env(safe-area-inset-bottom);\r\n    display: flex;\r\n    justify-content: flex-start;\r\n    align-items: center;\r\n    background-color: #fff;\r\n    height: 44px;\r\n    padding: 10px 8px;\r\n    box-sizing: border-box;\r\n    font-size: 14px;\r\n    border-radius: 0 0 10px 10px;\r\n    .image-icon {\r\n      font-size: 50px;\r\n      color: #fff;\r\n      margin-left: 20px;\r\n    }\r\n    .el-input {\r\n      .el-input__inner {\r\n        border: 0;\r\n        height: 32px;\r\n        background-color: #f5f5f5;\r\n        // margin: 0 15px 0 10px;\r\n      }\r\n    }\r\n    .el-button {\r\n      background: var(--color-main);\r\n      color: var(--color-white);\r\n      border-color: var(--color-main);\r\n      border-radius: 4px;\r\n      width: 65px;\r\n      height: 30px;\r\n      font-size: 14px;\r\n      padding: 0;\r\n      margin-left: 10px;\r\n      &:hover,\r\n      &:focus {\r\n        color: var(--color-white);\r\n        border-color: var(--color-main);\r\n        background-color: var(--color-main);\r\n      }\r\n    }\r\n  }\r\n  .avatar-uploader {\r\n    margin-right: 10px;\r\n  }\r\n  .el-icon-picture-outline {\r\n    font-size: 20px !important;\r\n    // margin-bottom: 8px;\r\n  }\r\n}\r\n.vdr {\r\n  position: absolute;\r\n  z-index: 999 !important;\r\n  pointer-events: auto !important;\r\n}\r\n.tuodong {\r\n  position: fixed;\r\n  top: 0;\r\n  bottom: 100px;\r\n  left: 0;\r\n  right: 0;\r\n  z-index: 2001 !important;\r\n  width: 100%;\r\n  height: 100%;\r\n  pointer-events: none;\r\n  // background: #000;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]}]}