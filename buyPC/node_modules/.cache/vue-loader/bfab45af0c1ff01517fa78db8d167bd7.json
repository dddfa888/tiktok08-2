{"remainingRequest":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\src\\components\\shopCart\\index.vue?vue&type=style&index=0&id=38ca5a49&lang=scss","dependencies":[{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\src\\components\\shopCart\\index.vue","mtime":1760944158182},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\css-loader\\dist\\cjs.js","mtime":1761044715569},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1761044717168},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\postcss-loader\\src\\index.js","mtime":1761044716266},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1761044715084},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1761044715083},{"path":"C:\\Users\\HP\\Desktop\\tiktok08-2\\buyPC\\node_modules\\vue-loader\\lib\\index.js","mtime":1761044716737}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpodG1sW2Rpcj0icnRsIl17DQogIC5lbC1pY29uLXNob3BwaW5nLWNhcnQtZnVsbHsNCiAgICBtYXJnaW4tcmlnaHQ6IDA7DQogICAgbWFyZ2luLWxlZnQ6IDE2cHg7DQogIH0NCiAgLnNob3AtY2FydC1kcmF3ZXItY29udGVudCAucHJpY2V7DQogICAgcGFkZGluZy1sZWZ0OiAwOw0KICAgIHBhZGRpbmctcmlnaHQ6IDE1cHg7DQogIH0NCiAgLnNob3AtY2FydCB7DQogICYtZmxvYXQgew0KICAgIHJpZ2h0OiBhdXRvOw0KICAgIGxlZnQ6IDA7DQogICAgYm9yZGVyLXJhZGl1czogMHB4IDQwcHggNDBweCAwcHg7DQogICAgcGFkZGluZy1sZWZ0OiAwOw0KICAgIHBhZGRpbmctcmlnaHQ6IDE1cHg7DQogIH0NCiAgLmVsLWRyYXdlci5ydGx7DQogICAgcmlnaHQ6IGF1dG87DQogICAgbGVmdDogMDsNCiAgfQ0KICB9DQp9DQouc2hvcC1jYXJ0IHsNCiAgJi1mbG9hdCB7DQogICAgd2lkdGg6IDEwOHB4Ow0KICAgIGhlaWdodDogNzZweDsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jb2xvci1tYWluKTsNCiAgICBib3JkZXItcmFkaXVzOiA0MHB4IDBweCAwcHggNDBweDsNCiAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgcmlnaHQ6IDA7DQogICAgdG9wOiA1MCU7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOw0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgcGFkZGluZy1sZWZ0OiAxNXB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB6LWluZGV4OiA5OTk7DQoNCiAgICAmLWNvdW50IHsNCiAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICAgIGNvbG9yOiB2YXIoLS1jb2xvci13aGl0ZSk7DQogICAgICBtYXJnaW4tYm90dG9tOiAxMHB4Ow0KDQogICAgICAuZWwtaWNvbi1zaG9wcGluZy1jYXJ0LWZ1bGwgew0KICAgICAgICBmb250LXNpemU6IDE2cHg7DQogICAgICB9DQogICAgfQ0KDQogICAgLmVsLWJ1dHRvbiB7DQogICAgICBvdmVyZmxvdzpoaWRkZW47IC8v6LaF5Ye655qE5paH5pys6ZqQ6JePDQp0ZXh0LW92ZXJmbG93OmVsbGlwc2lzOyAvL+a6ouWHuueUqOecgeeVpeWPt+aYvuekug0Kd2hpdGUtc3BhY2U6bm93cmFwOyANCiAgICAgIHdpZHRoOiA2N3B4Ow0KICAgICAgaGVpZ2h0OiAyM3B4Ow0KICAgICAgY29sb3I6IHZhcigtLWNvbG9yLW1haW4pOw0KICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3Itd2hpdGUpOw0KICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tY29sb3Itd2hpdGUpOw0KICAgICAgcGFkZGluZzogMDsNCiAgICB9DQogIH0NCn0NCg0KLnNob3AtY2FydC1kcmF3ZXIgew0KICBwb3NpdGlvbjogcmVsYXRpdmU7DQoNCiAgJi10aXRsZSB7DQogICAgLmVsLWljb24tc2hvcHBpbmctY2FydC1mdWxsIHsNCiAgICAgIGZvbnQtc2l6ZTogMjRweDsNCiAgICAgIGNvbG9yOiB2YXIoLS1jb2xvci1tYWluKTsNCiAgICAgIG1hcmdpbi1yaWdodDogMTZweDsNCiAgICB9DQoNCiAgICBoMyB7DQogICAgICBmb250LXdlaWdodDogNTAwOw0KICAgICAgZm9udC1zaXplOiAxNHB4Ow0KICAgICAgY29sb3I6IHZhcigtLWNvbG9yLXRpdGxlKTsNCiAgICB9DQoNCiAgICAuc2l0ZS1uYW1lIHsNCiAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7DQogICAgICBjb2xvcjogdmFyKC0tY29sb3Itc3VidGl0bGUpOw0KICAgICAgbWFyZ2luLXRvcDogNHB4Ow0KICAgIH0NCiAgfQ0KDQogICYtbGlzdCB7DQogICAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gMTUwcHgpOw0KICAgIG92ZXJmbG93OiBhdXRvOw0KDQogICAgJi5uby1jYXJ0IHsNCiAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCg0KICAgICAgaW1nIHsNCiAgICAgICAgd2lkdGg6IDMyMHB4Ow0KICAgICAgfQ0KDQogICAgICBkaXYgew0KICAgICAgICAvLyB3aWR0aDogMzIwcHg7DQogICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgICAgZm9udC1zaXplOiAyNHB4Ow0KICAgICAgfQ0KICAgICAgLmdvLXNob3BwaW5new0KICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1jb2xvci1tYWluKTsNCiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgICAgICBwYWRkaW5nOiAxMHB4IDIwcHg7DQogICAgICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICAgICAgY29sb3I6IHZhcigtLWNvbG9yLW1haW4pOw0KICAgICAgICBmb250LXdlaWdodDogNTAwOw0KICAgICAgICBtYXJnaW4tdG9wOiAyMHB4Ow0KICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICB9DQogICAgfQ0KICB9DQoNCiAgJi1jb250ZW50IHsNCiAgICBwYWRkaW5nOiAwIDEycHg7DQogICAgbWFyZ2luLWJvdHRvbTogMzBweDsNCg0KICAgIGltZyB7DQogICAgICB3aWR0aDogNjBweDsNCiAgICAgIGhlaWdodDogNjBweDsNCiAgICAgIG1hcmdpbjogMCAxMHB4Ow0KICAgICAgb2JqZWN0LWZpdDogY29udGFpbjsNCiAgICB9DQoNCiAgICA+IGRpdiB7DQogICAgICB3aWR0aDogMTcwcHg7DQogICAgfQ0KDQogICAgLnRpdC1jYXJ0IHsNCiAgICAgIGZsZXg6IDE7DQogICAgICBtYXgtd2lkdGg6IDE3MHB4Ow0KICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsNCiAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7DQogICAgICBmb250LXNpemU6IDEycHg7DQogICAgICBjb2xvcjogdmFyKC0tY29sb3ItYmxhY2spOw0KICAgICAgbWFyZ2luLWJvdHRvbTogMTBweDsNCiAgICB9DQoNCiAgICAucHJpY2Ugew0KICAgICAgY29sb3I6IHZhcigtLWNvbG9yLXByaWNlKTsNCiAgICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7DQogICAgICBmbGV4OiAxOw0KICAgICAgcGFkZGluZy1sZWZ0OiAxNXB4Ow0KICAgICAgb3ZlcmZsb3cteDogaGlkZGVuOw0KICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7DQogICAgfQ0KDQogICAgLmVsLWljb24tZGVsZXRlIHsNCiAgICAgIGZvbnQtc2l6ZTogMThweDsNCiAgICAgIGNvbG9yOiB2YXIoLS1jb2xvci1zdWJ0aXRsZSk7DQogICAgfQ0KDQogICAgLmVsLWlucHV0LW51bWJlcl9fZGVjcmVhc2UsDQogICAgLmVsLWlucHV0LW51bWJlcl9faW5jcmVhc2Ugew0KICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3ItbWFpbikgIWltcG9ydGFudDsNCiAgICAgIGNvbG9yOiB2YXIoLS1jb2xvci13aGl0ZSk7DQogICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1jb2xvci1tYWluKSAhaW1wb3J0YW50Ow0KICAgICAgYm9yZGVyLXJhZGl1czogNHB4ICFpbXBvcnRhbnQ7DQogICAgICB3aWR0aDogMjBweCAhaW1wb3J0YW50Ow0KICAgICAgaGVpZ2h0OiAyMHB4ICFpbXBvcnRhbnQ7DQogICAgICBsaW5lLWhlaWdodDogMjBweDsNCiAgICB9DQoNCiAgICAuZWwtaW5wdXQtbnVtYmVyLS1taW5pIHsNCiAgICAgIHdpZHRoOiA4MHB4Ow0KICAgIH0NCg0KICAgIC5lbC1pbnB1dF9faW5uZXIgew0KICAgICAgYm9yZGVyOiAwICFpbXBvcnRhbnQ7DQogICAgICBwYWRkaW5nOiAwIDIwcHggIWltcG9ydGFudDsNCiAgICAgIGhlaWdodDogMjBweCAhaW1wb3J0YW50Ow0KICAgICAgbGluZS1oZWlnaHQ6IDIwcHggIWltcG9ydGFudDsNCiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICAgIHRvcDogLTNweDsNCiAgICB9DQoNCiAgICAuZWwtaW5wdXQtbnVtYmVyX19kZWNyZWFzZTpob3ZlciwNCiAgICAuZWwtaW5wdXQtbnVtYmVyX19pbmNyZWFzZTpob3ZlciB7DQogICAgICBjb2xvcjogdmFyKC0tY29sb3Itd2hpdGUpOw0KICAgIH0NCiAgfQ0KDQogICYtYnV5IHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgYm90dG9tOiAxMHB4Ow0KICAgIGxlZnQ6IDA7DQoNCiAgICAuZWwtYnV0dG9uIHsNCiAgICAgIHdpZHRoOiAzMTJweDsNCiAgICAgIGhlaWdodDogNDBweDsNCiAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7DQogICAgICBmb250LXNpemU6IDE0cHg7DQogICAgfQ0KICB9DQoNCiAgLmVsLWRyYXdlcl9faGVhZGVyIHsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tY29sb3ItYm9yZGVyKTsNCiAgICBwYWRkaW5nLWJvdHRvbTogMTRweDsNCiAgICBtYXJnaW4tYm90dG9tOiAxNXB4Ow0KICB9DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA6TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/shopCart","sourcesContent":["<template>\r\n  <div class=\"shop-cart\">\r\n    <div\r\n      v-show=\"showShopCart\"\r\n      class=\"shop-cart-float flex-center\"\r\n      @click=\"openShopCart\"\r\n    >\r\n      <div class=\"shop-cart-float-count\">\r\n        <i class=\"el-icon-shopping-cart-full\"></i>\r\n        <span>\r\n          &nbsp;{{ totalCount }}&nbsp;{{\r\n            this.$t(\"message.home.item\" /**物品 */)\r\n          }}\r\n        </span>\r\n      </div>\r\n      <!--      <el-button size=\"mini\">${{ totalAmount }}</el-button>-->\r\n      <el-button size=\"mini\">${{ totalCheckAmount }}</el-button>\r\n    </div>\r\n    <el-drawer\r\n      :visible.sync=\"shopCartDrawer\"\r\n      direction=\"rtl\"\r\n      size=\"400px\"\r\n      custom-class=\"shop-cart-drawer\"\r\n    >\r\n      <div class=\"flex-start shop-cart-drawer-title\" slot=\"title\">\r\n        <i class=\"el-icon-shopping-cart-full\"></i>\r\n        <div>\r\n          <h3>\r\n            {{ totalCount }}&nbsp;{{ this.$t(\"message.home.item\" /**物品 */) }}\r\n          </h3>\r\n          <p class=\"site-name\">{{ this.$t(\"message.home.myCart\") }}</p>\r\n        </div>\r\n      </div>\r\n      <div class=\"shop-cart-drawer-list\" v-if=\"shopCart.length\">\r\n        <div\r\n          v-for=\"(item, index) in shopCart\"\r\n          :key=\"index\"\r\n          class=\"shop-cart-drawer-content flex-start\"\r\n        >\r\n          <el-checkbox v-model=\"checkMap[item.Identifier]\"></el-checkbox>\r\n          <img :src=\"item.zoomImg ? item.zoomImg : item.imgUrl1\" alt=\"\" />\r\n          <div>\r\n            <p class=\"tit-cart\">\r\n              {{ item.name }}\r\n            </p>\r\n            <p v-if=\"item.checkAttrName\" class=\"tit-cart\">\r\n              {{ item.checkAttrName }}\r\n            </p>\r\n            <el-input-number\r\n              size=\"mini\"\r\n              :key=\"item.buyMin\"\r\n              :min=\"item.buyMin ?? 1\"\r\n              :precision=\"0\"\r\n              :max=\"maxNum\"\r\n              v-model=\"shopCardNumMap[item.Identifier]\"\r\n            ></el-input-number>\r\n          </div>\r\n          <span class=\"price\" v-if=\"item.price\">\r\n            ${{ numberFormat(shopCardNumMap[item.Identifier] * item.price) }}\r\n          </span>\r\n          <span class=\"price\" v-else>\r\n            ${{\r\n              numberFormat(\r\n                shopCardNumMap[item.Identifier] *\r\n                  (item.discountPrice ?? item.sellingPrice)\r\n              )\r\n            }}\r\n          </span>\r\n          <i class=\"el-icon-delete\" @click=\"del(index)\"></i>\r\n        </div>\r\n      </div>\r\n      <div class=\"shop-cart-drawer-list no-cart\" v-else>\r\n        <img :src=\"noCart\" alt=\"\" />\r\n        <div>{{this.$t('message.home.购物车还没有商品')}}</div>\r\n        <div class=\"go-shopping\" @click=\"goShopping\">{{this.$t('message.home.去购物')}}</div>\r\n      </div>\r\n      <div class=\"shop-cart-drawer-buy flex-center\">\r\n        <el-button type=\"primary\" @click=\"pay\">\r\n          {{ this.$t(\"message.home.checkout\") }} ${{ totalCheckAmount }}\r\n        </el-button>\r\n      </div>\r\n    </el-drawer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapMutations, mapGetters } from \"vuex\";\r\nimport { getShopCartLocal } from \"@/util/shop\";\r\nimport { numberFormat } from \"@/util\";\r\nimport { ES_VUEX } from \"@/common\";\r\n\r\nexport default {\r\n  name: \"EsShopCart\",\r\n  data() {\r\n    return {\r\n      num: 1,\r\n      count: 0,\r\n      total: 0,\r\n      shopCartDrawer: false,\r\n      testData: new Array(30).fill(\"\"),\r\n      showShopCartRouterPath: [\r\n        \"/index\",\r\n        \"/classification\",\r\n        \"/commodity\",\r\n        \"/information\",\r\n        \"/productDetails\",\r\n        \"/store\",\r\n        \"/discounted\",\r\n        \"/userInfo/dashboard\"\r\n      ],\r\n      showShopCart: false,\r\n      checkMap: {},\r\n      shopCardNumMap: {},\r\n      allNumber: 0,\r\n      noCart: require(\"@/assets/image/no-cart-item.jpg\"),\r\n      maxNum: 0\r\n    };\r\n  },\r\n  created() {\r\n    this.$nextTick(() => {\r\n      this.init();\r\n    });\r\n    setTimeout(()=>{\r\n      this.maxNum = Number(localStorage.getItem('maxBuy') || 500) \r\n    },1500)\r\n    \r\n  },\r\n  computed: {\r\n    ...mapGetters(\"shopCart\", [\"shopCart\"]),\r\n    ...mapGetters([\"isLogin\"]),\r\n    totalAmount() {\r\n      return numberFormat(\r\n        this.shopCart.reduce(\r\n          (a, b) => a + (b.price ?? b.discountPrice ?? b.sellingPrice),\r\n          0\r\n        )\r\n      );\r\n    },\r\n    totalCount() {\r\n      let amount = 0;\r\n\r\n      // const checkData = this.shopCart.filter(\r\n      //   (item) => this.checkMap[item.Identifier]\r\n      // );\r\n      amount = this.shopCart.length;\r\n      // checkData.forEach((item) => {\r\n      //   amount += this.shopCardNumMap[item.Identifier];\r\n      // });\r\n      return amount;\r\n    },\r\n    totalCheckAmount() {\r\n      let amount = 0;\r\n      const checkData = this.shopCart.filter(\r\n        (item) => this.checkMap[item.Identifier]\r\n      );\r\n\r\n      checkData.forEach((item) => {\r\n        // console.log('item ->', item);\r\n        amount = this.$big(amount).plus(\r\n          this.$big(this.shopCardNumMap[item.Identifier]).times(\r\n            item.price ?? item.discountPrice ?? item.sellingPrice\r\n          ))\r\n          // numberFormat(item.price ?? item.discountPrice ?? item.sellingPrice);\r\n      });\r\n      \r\n      return numberFormat(amount);\r\n    },\r\n  },\r\n  watch: {\r\n    $route: {\r\n      handler(newValue) {\r\n        this.showShopCart =\r\n          this.showShopCartRouterPath.indexOf(newValue.path) >= 0;\r\n      },\r\n      deep: true,\r\n    },\r\n    shopCart: {\r\n      handler(newValue) {\r\n        // console.log(\"shopCart发生更新\", newValue);\r\n        const obj = {};\r\n        const numObj = {};\r\n        newValue.forEach((item) => {\r\n          obj[item.Identifier] = true;\r\n          numObj[item.Identifier] = item.count || 1;\r\n        });\r\n\r\n        this.checkMap = { ...obj, ...this.checkMap };\r\n        this.shopCardNumMap = { ...numObj, ...this.shopCardNumMap };\r\n        // console.log(`this.shopCardNumMap ::->`, this.shopCardNumMap);\r\n      },\r\n      deep: true,\r\n      immediate: true,\r\n    },\r\n    checkMap() {\r\n      console.log(\"checkMap\");\r\n    },\r\n    shopCartDrawer(val) {\r\n      function handler(e) {\r\n        e.preventDefault();\r\n      }\r\n      if (val) {\r\n        document.body.style.overflow = \"hidden\";\r\n        document.addEventListener(\"scroll\", handler, false);\r\n      } else {\r\n        document.body.style.overflow = \"\";\r\n        document.addEventListener(\"scroll\", handler, true);\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    ...mapMutations(\"shopCart\", [\"updateShopCart\", \"updateCheckProductPay\"]),\r\n    numberFormat,\r\n    openShopCart() {\r\n      this.shopCartDrawer = true;\r\n\r\n      setTimeout(() => {}, 500);\r\n    },\r\n    chlick(i) {\r\n      console.log(\"i ->\", i);\r\n    },\r\n    goShopping(){\r\n      this.shopCartDrawer = false;\r\n      this.$router.push('/index')\r\n    },\r\n    /**\r\n     * 不清楚为什么更新那么缓慢，先采用临时方案处理问题\r\n     */\r\n    init() {\r\n      setTimeout(() => {\r\n        this.initShopCartData();\r\n        this.initCheckProductPay();\r\n      }, 1500);\r\n    },\r\n    initShopCartData() {\r\n      const shopCart = getShopCartLocal().then(result =>{\r\n        return result;\r\n      });\r\n      // console.log(' shopCart->', shopCart);\r\n      if (shopCart && shopCart.length) {\r\n        // console.log('shopCart.length ->', shopCart.length);\r\n        this.updateShopCart(shopCart);\r\n      }\r\n    },\r\n    initCheckProductPay() {\r\n      const vuexData = localStorage.getItem(ES_VUEX);\r\n      if (vuexData) {\r\n        const vuexObj = JSON.parse(vuexData);\r\n        const checkProductPay = vuexObj.shopCart.checkProductPay;\r\n        if (checkProductPay && checkProductPay.length) {\r\n          this.updateCheckProductPay(checkProductPay);\r\n        }\r\n      }\r\n    },\r\n    getCheckInfo() {\r\n      let checkByStore = {};\r\n      const checkData = this.shopCart.filter(\r\n        (item) => this.checkMap[item.Identifier]\r\n      );\r\n      checkData.forEach((item) => {\r\n        if (!checkByStore[item.seller.id]) {\r\n          checkByStore[item.seller.id] = {\r\n            title: item.seller.name,\r\n            checkList: [],\r\n            checkAll: true,\r\n            isIndeterminate: false,\r\n            list: [],\r\n          };\r\n        }\r\n        checkByStore[item.seller.id].checkList.push(item.Identifier);\r\n        checkByStore[item.seller.id].list.push({\r\n          ...item,\r\n          ...{ checkTotal: this.shopCardNumMap[item.Identifier] },\r\n        });\r\n      });\r\n      return Object.values(checkByStore);\r\n    },\r\n    pay() {\r\n      console.log('getCheckInfo ->', this.getCheckInfo().length);\r\n      if (this.getCheckInfo().length === 0) {\r\n        this.$message({\r\n          message: this.$t(\r\n            \"message.home.unSelectedProduct\" /**您还未选中商品 */\r\n          ),\r\n          type: \"error\",\r\n        });\r\n        return;\r\n      }\r\n      if (this.totalCheckAmount) {\r\n        this.shopCartDrawer = false;\r\n        console.log(\"this.getCheckInfo() ->\", this.getCheckInfo());\r\n        this.updateCheckProductPay(this.getCheckInfo());\r\n        this.$router.push(\"/settlement\");\r\n      }\r\n    },\r\n    del(index) {\r\n      const data = JSON.parse(JSON.stringify(this.shopCart));\r\n      data.splice(index, 1);\r\n      this.updateShopCart(data);\r\n\r\n      // const delItem = this.shopCart.splice(index, 1);\r\n      // let shopCartData = getShopCartLocal();\r\n\r\n      // console.log('delItem', delItem)\r\n      // console.log('shopCartData', shopCartData)\r\n      // if (shopCartData && shopCartData.length) {\r\n      //   shopCartData = shopCartData.filter(\r\n      //     (item) => item.Identifier !== delItem.Identifier\r\n      //   );\r\n      //   this.updateShopCart(shopCartData);\r\n      //   this.$delete(this.checkMap, delItem.Identifier);\r\n      // }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\nhtml[dir=\"rtl\"]{\r\n  .el-icon-shopping-cart-full{\r\n    margin-right: 0;\r\n    margin-left: 16px;\r\n  }\r\n  .shop-cart-drawer-content .price{\r\n    padding-left: 0;\r\n    padding-right: 15px;\r\n  }\r\n  .shop-cart {\r\n  &-float {\r\n    right: auto;\r\n    left: 0;\r\n    border-radius: 0px 40px 40px 0px;\r\n    padding-left: 0;\r\n    padding-right: 15px;\r\n  }\r\n  .el-drawer.rtl{\r\n    right: auto;\r\n    left: 0;\r\n  }\r\n  }\r\n}\r\n.shop-cart {\r\n  &-float {\r\n    width: 108px;\r\n    height: 76px;\r\n    background-color: var(--color-main);\r\n    border-radius: 40px 0px 0px 40px;\r\n    position: fixed;\r\n    right: 0;\r\n    top: 50%;\r\n    transform: translateY(-50%);\r\n    flex-direction: column;\r\n    padding-left: 15px;\r\n    cursor: pointer;\r\n    z-index: 999;\r\n\r\n    &-count {\r\n      font-size: 12px;\r\n      color: var(--color-white);\r\n      margin-bottom: 10px;\r\n\r\n      .el-icon-shopping-cart-full {\r\n        font-size: 16px;\r\n      }\r\n    }\r\n\r\n    .el-button {\r\n      overflow:hidden; //超出的文本隐藏\r\ntext-overflow:ellipsis; //溢出用省略号显示\r\nwhite-space:nowrap; \r\n      width: 67px;\r\n      height: 23px;\r\n      color: var(--color-main);\r\n      background-color: var(--color-white);\r\n      border: 1px solid var(--color-white);\r\n      padding: 0;\r\n    }\r\n  }\r\n}\r\n\r\n.shop-cart-drawer {\r\n  position: relative;\r\n\r\n  &-title {\r\n    .el-icon-shopping-cart-full {\r\n      font-size: 24px;\r\n      color: var(--color-main);\r\n      margin-right: 16px;\r\n    }\r\n\r\n    h3 {\r\n      font-weight: 500;\r\n      font-size: 14px;\r\n      color: var(--color-title);\r\n    }\r\n\r\n    .site-name {\r\n      font-size: 12px;\r\n      font-weight: 400;\r\n      color: var(--color-subtitle);\r\n      margin-top: 4px;\r\n    }\r\n  }\r\n\r\n  &-list {\r\n    height: calc(100vh - 150px);\r\n    overflow: auto;\r\n\r\n    &.no-cart {\r\n      display: flex;\r\n      box-sizing: border-box;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      justify-content: center;\r\n\r\n      img {\r\n        width: 320px;\r\n      }\r\n\r\n      div {\r\n        // width: 320px;\r\n        text-align: center;\r\n        font-size: 24px;\r\n      }\r\n      .go-shopping{\r\n        border: 1px solid var(--color-main);\r\n        border-radius: 4px;\r\n        padding: 10px 20px;\r\n        font-size: 14px;\r\n        color: var(--color-main);\r\n        font-weight: 500;\r\n        margin-top: 20px;\r\n        cursor: pointer;\r\n      }\r\n    }\r\n  }\r\n\r\n  &-content {\r\n    padding: 0 12px;\r\n    margin-bottom: 30px;\r\n\r\n    img {\r\n      width: 60px;\r\n      height: 60px;\r\n      margin: 0 10px;\r\n      object-fit: contain;\r\n    }\r\n\r\n    > div {\r\n      width: 170px;\r\n    }\r\n\r\n    .tit-cart {\r\n      flex: 1;\r\n      max-width: 170px;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      white-space: nowrap;\r\n      font-weight: 400;\r\n      font-size: 12px;\r\n      color: var(--color-black);\r\n      margin-bottom: 10px;\r\n    }\r\n\r\n    .price {\r\n      color: var(--color-price);\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      flex: 1;\r\n      padding-left: 15px;\r\n      overflow-x: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n\r\n    .el-icon-delete {\r\n      font-size: 18px;\r\n      color: var(--color-subtitle);\r\n    }\r\n\r\n    .el-input-number__decrease,\r\n    .el-input-number__increase {\r\n      background-color: var(--color-main) !important;\r\n      color: var(--color-white);\r\n      border: 1px solid var(--color-main) !important;\r\n      border-radius: 4px !important;\r\n      width: 20px !important;\r\n      height: 20px !important;\r\n      line-height: 20px;\r\n    }\r\n\r\n    .el-input-number--mini {\r\n      width: 80px;\r\n    }\r\n\r\n    .el-input__inner {\r\n      border: 0 !important;\r\n      padding: 0 20px !important;\r\n      height: 20px !important;\r\n      line-height: 20px !important;\r\n      position: relative;\r\n      top: -3px;\r\n    }\r\n\r\n    .el-input-number__decrease:hover,\r\n    .el-input-number__increase:hover {\r\n      color: var(--color-white);\r\n    }\r\n  }\r\n\r\n  &-buy {\r\n    width: 100%;\r\n    position: absolute;\r\n    bottom: 10px;\r\n    left: 0;\r\n\r\n    .el-button {\r\n      width: 312px;\r\n      height: 40px;\r\n      font-weight: 700;\r\n      font-size: 14px;\r\n    }\r\n  }\r\n\r\n  .el-drawer__header {\r\n    border-bottom: 1px solid var(--color-border);\r\n    padding-bottom: 14px;\r\n    margin-bottom: 15px;\r\n  }\r\n}\r\n</style>\r\n"]}]}