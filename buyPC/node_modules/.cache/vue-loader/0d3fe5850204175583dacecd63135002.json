{"remainingRequest":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\src\\page\\userInfo\\my-order\\order-evaluation.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\src\\page\\userInfo\\my-order\\order-evaluation.vue","mtime":1760944158225},{"path":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1761044715083},{"path":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\node_modules\\babel-loader\\lib\\index.js","mtime":1761044716268},{"path":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1761044715083},{"path":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\node_modules\\vue-loader\\lib\\index.js","mtime":1761044716737}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBtYXBHZXR0ZXJzLCBtYXBBY3Rpb25zIH0gZnJvbSAidnVleCI7DQppbXBvcnQgeyBudW1iZXJGb3JtYXQgfSBmcm9tICJAL3V0aWwiOw0KaW1wb3J0IHsgVXBsb2FkQXBpLCBBZGRPcmRlckV2YWx1YXRlTGlzdCB9IGZyb20gIkAvYXBpIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIm9yZGVyLWV2YWx1YXRpb24tZGlhbG9nIiwNCiAgcHJvcHM6IHsNCiAgICB2YWx1ZTogew0KICAgICAgdHlwZTogQm9vbGVhbiwNCiAgICAgIGRlZmF1bHQ6IGZhbHNlLA0KICAgIH0sDQogICAgLy8gY3VycmVudE9yZGVySW5mbzogew0KICAgIC8vICAgICB0eXBlOiBPYmplY3QsDQogICAgLy8gICAgIGRlZmF1bHQ6ICgpID0+IHsgfSwNCiAgICAvLyB9LA0KICAgIHJlZnJlc2g6IHsNCiAgICAgIHR5cGU6IEZ1bmN0aW9uLA0KICAgIH0sDQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIC8vIGN1cnJlbnRPcmRlckluZm86IHRoaXMuJHJvdXRlLnBhcmFtcz8uY3VycmVudE9yZGVySW5mbyB8fCB7fSwNCiAgICAgIC8vIGRpYWxvZ1Zpc2libGU6IHRoaXMudmFsdWUgfHwgZmFsc2UsDQogICAgICBvcmRlcklkOiB0aGlzLiRyb3V0ZS5xdWVyeS5vcmRlcklkLA0KICAgICAgbG9hZGluZzogZmFsc2UsDQogICAgICByYXRlTWFwOiB7fSwNCiAgICAgIGNvbnRlbnRNYXA6IHt9LA0KICAgICAgaW1hZ2VzTWFwOiB7fSwNCiAgICAgIHJlc3VsdE1hcDoge30sDQogICAgICBkaWFsb2dJbWFnZVVybDogIiIsDQogICAgICBpc1VwbG9hZDpmYWxzZSwNCiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLA0KICAgICAgZGlzYWJsZWQ6IGZhbHNlLA0KICAgICAgVXBsb2FkQXBpLA0KICAgICAgdXBsb2FkUGFyYW1zOiB7DQogICAgICAgIG1vZHVsZU5hbWU6ICJldmFsdWF0ZSIsDQogICAgICAgIHRva2VuOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiRVNfVE9LRU4iKSwNCiAgICAgIH0sDQogICAgfTsNCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICBpZiAodGhpcy5vcmRlcklkKSB7DQogICAgICB0aGlzLnJlcXVlc3REYXRhKCk7DQogICAgfQ0KICB9LA0KICBjb21wdXRlZDogew0KICAgIC4uLm1hcEdldHRlcnMoew0KICAgICAgb3JkZXJHb29kczogIm9yZGVyL29yZGVyR29vZHMiLA0KICAgIH0pLA0KICB9LA0KICB3YXRjaDogew0KICAgIG9yZGVyR29vZHMobmV3VmFsdWUpIHsNCiAgICAgIGxldCByYXRlTWFwID0ge307DQogICAgICBsZXQgY29udGVudE1hcCA9IHt9Ow0KICAgICAgbGV0IHJlc3VsdE1hcCA9IHt9Ow0KDQogICAgICBuZXdWYWx1ZS5mb3JFYWNoKChpdGVtKSA9PiB7DQogICAgICAgIHJhdGVNYXBbaXRlbS5nb29kc0lkXSA9IDU7DQogICAgICAgIGNvbnRlbnRNYXBbaXRlbS5nb29kc0lkXSA9ICIiOw0KICAgICAgICByZXN1bHRNYXBbaXRlbS5nb29kc0lkXSA9IGZhbHNlOw0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMucmF0ZU1hcCA9IHsgLi4ucmF0ZU1hcCB9Ow0KICAgICAgdGhpcy5jb250ZW50TWFwID0geyAuLi5jb250ZW50TWFwIH07DQogICAgICB0aGlzLnJlc3VsdE1hcCA9IHsgLi4ucmVzdWx0TWFwIH07DQogICAgfSwNCg0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLi4ubWFwQWN0aW9ucyh7DQogICAgICByZXF1ZXN0T3JkZXJHb29kc0xpc3Q6ICJvcmRlci9yZXF1ZXN0T3JkZXJHb29kc0xpc3QiLA0KICAgICAgcmVxdWVzdE9yZGVyRXZhbHVhdGlvbkxpc3Q6ICJvcmRlci9yZXF1ZXN0T3JkZXJFdmFsdWF0aW9uTGlzdCIsDQogICAgfSksDQogICAgdXBsb2FkRmlsZShwYXJhbXMsIGdvb2RzSWQpIHsNCiAgICAgIGNvbnNvbGUubG9nKGdvb2RzSWQsIHBhcmFtcyk7DQogICAgfSwNCg0KICAgIGhhbmRsZVJlbW92ZShmaWxlLCBnb29kc0lkKSB7DQogICAgICBjb25zdCBpbmRleCA9IHRoaXMuaW1hZ2VzTWFwW2dvb2RzSWRdPy5maW5kSW5kZXgoDQogICAgICAgICh4KSA9PiB4LnVpZCA9PSBmaWxlLnVpZA0KICAgICAgKTsNCiAgICAgIGluZGV4ID49IDAgJiYgdGhpcy5pbWFnZXNNYXBbZ29vZHNJZF0/LnNwbGljZShpbmRleCwgMSk7DQogICAgfSwNCiAgICBoYW5kbGVQaWN0dXJlQ2FyZFByZXZpZXcoZmlsZSkgew0KICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybCA9IGZpbGUudXJsOw0KICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsNCiAgICB9LA0KDQogICAgaGFuZGxlRmlsZXNDaGFuZ2UoZmlsZXMsIGdvb2RzSWQpIHsNCiAgICAgIGlmIChmaWxlcy5sZW5ndGggPjgpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKHRoaXMuJHQoIm1lc3NhZ2UuaG9tZS7mnIDlpJrkuIrkvKA55byg5Zu+54mHIikpOw0KICAgICAgICB0aGlzLmlzVXBsb2FkID0gdHJ1ZQ0KICAgICAgfWVsc2V7DQogICAgICAgIHRoaXMuaW1hZ2VzTWFwW2dvb2RzSWRdID0gZmlsZXM7DQogICAgICB9DQogICAgICANCiAgICB9LA0KDQogICAgZ29CYWNrKCkgew0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi91c2VySW5mby9teS1vcmRlciIpOw0KICAgIH0sDQogICAgZ2V0UmF0ZShpZCkgew0KICAgICAgaWYgKHRoaXMucmF0ZU1hcFtpZF0gPCAyKSB7DQogICAgICAgIHJldHVybiAzOw0KICAgICAgfSBlbHNlIGlmICh0aGlzLnJhdGVNYXBbaWRdIDwgNCkgew0KICAgICAgICByZXR1cm4gMjsNCiAgICAgIH0NCiAgICAgIHJldHVybiAxOw0KICAgIH0sDQogICAgYXN5bmMgcmVxdWVzdERhdGEoKSB7DQogICAgICB0cnkgew0KICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgICBhd2FpdCB0aGlzLnJlcXVlc3RPcmRlckdvb2RzTGlzdCh7IG9yZGVySWQ6IHRoaXMub3JkZXJJZCB9KTsNCiAgICAgIH0gZmluYWxseSB7DQogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgICAgfQ0KICAgIH0sDQogICAgYXN5bmMgc3VibWl0KCkgew0KICAgICAgLy8gY29uc3QgY29udGVudCA9IHRoaXMuY29udGVudE1hcFtpdGVtLmdvb2RzSWRdPy50cmltKCkgPz8gJycNCiAgICAgIC8vIGlmICghY29udGVudCkgew0KICAgICAgLy8gICB0aGlzLiRtZXNzYWdlLndhcm5pbmcodGhpcy4kdCgnbWVzc2FnZS5ob21lLmV2YWx1YXRlT3JkZXJQbGFjZWhvbGRlcicpKQ0KICAgICAgLy8gICByZXR1cm4NCiAgICAgIC8vIH0NCg0KICAgICAgdHJ5IHsNCiAgICAgICAgdGhpcy5idG5Mb2FkaW5nID0gdHJ1ZTsNCiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IHRydWU7DQogICAgICAgIC8vIGF3YWl0IHRoaXMucmVxdWVzdE9yZGVyRXZhbHVhdGlvbkxpc3Qoew0KICAgICAgICAvLyAgICAgc2VsbGVyR29vZHNJZDogaXRlbS5nb29kc0lkLA0KICAgICAgICAvLyAgICAgZXZhbHVhdGlvblR5cGU6IHRoaXMuZ2V0UmF0ZSgpLA0KICAgICAgICAvLyAgICAgcmF0aW5nOiB0aGlzLnJhdGVNYXBbaXRlbS5nb29kc0lkXSwNCiAgICAgICAgLy8gICAgIG9yZGVySWQ6IHRoaXMub3JkZXJJZCwNCiAgICAgICAgLy8gICAgIGNvbnRlbnQ6IGNvbnRlbnQgfHwgdGhpcy4kdCgnbWVzc2FnZS5ob21lLmRlZmF1bHRSYXRlJyksDQogICAgICAgIC8vIH0pDQogICAgICAgIC8vIHRoaXMucmVzdWx0TWFwW2l0ZW0uZ29vZHNJZF0gPSB0cnVlDQogICAgICAgIGNvbnN0IGV2YWx1YXRpb25BZGRzID0gW107DQogICAgICAgIC8vIGNvbnN0IGNhbkNvbnRpbnVlID0gdHJ1ZTsNCiAgICAgICAgZm9yIChsZXQgeyBnb29kc0lkIH0gb2YgdGhpcy5vcmRlckdvb2RzKSB7DQogICAgICAgICAgY29uc3QgZXZhbHVhdGlvbiA9IHsNCiAgICAgICAgICAgIHNlbGxlckdvb2RzSWQ6IGdvb2RzSWQsDQogICAgICAgICAgICBldmFsdWF0aW9uVHlwZTogdGhpcy5nZXRSYXRlKGdvb2RzSWQpLA0KICAgICAgICAgICAgcmF0aW5nOiB0aGlzLnJhdGVNYXBbZ29vZHNJZF0sDQogICAgICAgICAgICBjb250ZW50OiB0aGlzLmNvbnRlbnRNYXBbZ29vZHNJZF0sDQogICAgICAgICAgfTsNCg0KICAgICAgICAgIGNvbnN0IG5vdFVwbG9hZCA9IHRoaXMuaW1hZ2VzTWFwW2dvb2RzSWRdPy5maWx0ZXIoKHgpID0+ICF4LnJlc3BvbnNlKTsNCg0KICAgICAgICAgIGlmIChub3RVcGxvYWQgJiYgbm90VXBsb2FkLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICAvLyB0aXRsZTogdGhpcy4kdCgnbWVzc2FnZS5ob21lLnN1Y2Nlc3NUaXBzJyksDQogICAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoIm1lc3NhZ2UuaG9tZS5ldmFsdWF0aW9uVXBsb2FkaW5nIiksDQogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBjb25zdCBpbWFnZVVybHMgPQ0KICAgICAgICAgICAgdGhpcy5pbWFnZXNNYXBbZ29vZHNJZF0NCiAgICAgICAgICAgICAgPy5maWx0ZXIoKHgpID0+IHgucmVzcG9uc2UgJiYgeC5yZXNwb25zZS5jb2RlID09ICIwIikNCiAgICAgICAgICAgICAgLm1hcCgoeCkgPT4geC5yZXNwb25zZS5kYXRhKSB8fCBbXTsNCg0KICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW1hZ2VVcmxzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBldmFsdWF0aW9uW2BpbWdVcmwke2kgKyAxfWBdID0gaW1hZ2VVcmxzW2ldOw0KICAgICAgICAgIH0NCiAgICAgICAgICBldmFsdWF0aW9uQWRkcy5wdXNoKGV2YWx1YXRpb24pOw0KICAgICAgICB9DQoNCiAgICAgICAgbGV0IHJlcyA9IGF3YWl0IEFkZE9yZGVyRXZhbHVhdGVMaXN0KHsNCiAgICAgICAgICBvcmRlcklkOiB0aGlzLm9yZGVySWQsDQogICAgICAgICAgZXZhbHVhdGlvbkFkZHMsDQogICAgICAgIH0pOw0KDQogICAgICAgIGlmIChyZXMuY29kZSA9PSAwKSB7DQogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goe3BhdGg6Ii91c2VySW5mby9teS1vcmRlciIscmVwbGFjZTp0cnVlfSk7DQogICAgICAgICAgdGhpcy4kbm90aWZ5KHsNCiAgICAgICAgICAgIHRpdGxlOiB0aGlzLiR0KCJtZXNzYWdlLmhvbWUuc3VjY2Vzc1RpcHMiKSwNCiAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoIm1lc3NhZ2UuaG9tZS5ldmFsdWF0ZU9yZGVyU3VjY2VzcyIpLA0KICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLA0KICAgICAgICAgIH0pOw0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAvLyB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAvLyAgIHRpdGxlOiB0aGlzLiR0KCdtZXNzYWdlLmhvbWUuZnVpbFRpcHMnKSwNCiAgICAgICAgICAvLyAgIG1lc3NhZ2U6IHRoaXMuJHQoIm1lc3NhZ2UuaG9tZS5ldmFsdWF0ZU9yZGVyRnVpbCIpLA0KICAgICAgICAgIC8vICAgdHlwZTogImVycm9yIiwNCiAgICAgICAgICAvLyB9KTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIHRoaXMuJGVtaXQoImNsb3NlRGV0YWlscyIpOw0KICAgICAgICAvLyB0aGlzLnJlZnJlc2ggJiYgdGhpcy5yZWZyZXNoKCkNCiAgICAgIH0gZmluYWxseSB7DQogICAgICAgIHRoaXMuYnRuTG9hZGluZyA9IGZhbHNlOw0KICAgICAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7DQogICAgICB9DQogICAgfSwNCg0KICAgIG51bWJlckZvcm1hdEZuKG51bSkgew0KICAgICAgcmV0dXJuIG51bWJlckZvcm1hdChudW0pOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["order-evaluation.vue"],"names":[],"mappings":";AAiHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"order-evaluation.vue","sourceRoot":"src/page/userInfo/my-order","sourcesContent":["<template>\r\n  <div\r\n    class=\"evaluation-list\"\r\n    style=\"width: 866px; margin-top: 24px\"\r\n    v-loading=\"loading\"\r\n  >\r\n    <div\r\n      class=\"page-title\"\r\n      style=\"cursor: pointer; margin-bottom: 20px; margin-left: 34px\"\r\n      @click=\"goBack\"\r\n    >\r\n      <i class=\"el-icon-arrow-left\"></i> {{ $t(\"message.home.myOrder\") }}/{{\r\n        $t(\"message.home.Submitareview\")\r\n      }}\r\n    </div>\r\n    <div\r\n      class=\"evaluation-item\"\r\n      v-for=\"(item, index) in orderGoods\"\r\n      :key=\"item.id\"\r\n    >\r\n      <div style=\"margin-left: 40px; margin-top: 30px\">\r\n        <div class=\"product-item\">\r\n          <el-image\r\n            style=\"width: 62px; height: 62px\"\r\n            fit=\"scale-down\"\r\n            :src=\"item.goodsIcon\"\r\n            alt=\"order-detail-product\"\r\n          />\r\n          <div class=\"info\">\r\n            <div class=\"tit\">{{ item.goodsName }}</div>\r\n            <div\r\n              style=\"margin-top: 9px; font-size: 12px\"\r\n              v-if=\"item.attributes && item.attributes.length > 0\"\r\n            >\r\n              {{\r\n                item.attributes\r\n                  .map((it) => `${it.attrName}:${it.attrValue}`)\r\n                  .join(\" \")\r\n              }}\r\n            </div>\r\n            <div class=\"price\">${{ numberFormatFn(item.goodsReal) }}</div>\r\n            <el-rate\r\n              v-model=\"rateMap[item.goodsId]\"\r\n              :disabled=\"resultMap[item.goodsId]\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <el-input\r\n          v-model=\"contentMap[item.goodsId]\"\r\n          class=\"content\"\r\n          type=\"textarea\"\r\n          :placeholder=\"$t('message.home.evaluateOrderPlaceholder')\"\r\n          resize=\"none\"\r\n          :disabled=\"resultMap[item.goodsId]\"\r\n          :maxlength=\"1000\"\r\n          show-word-limit\r\n        />\r\n\r\n        <div style=\"height: 15px\" />\r\n\r\n        <span>{{ $t(\"message.home.evaluateInput\") }}</span>\r\n\r\n        <el-upload\r\n          :data=\"uploadParams\"\r\n          style=\"margin-top: 10px\"\r\n          :action=\"UploadApi\"\r\n          :on-change=\"(_, files) => handleFilesChange(files, item.goodsId)\"\r\n          list-type=\"picture-card\"\r\n          :disabled =\"isUpload\"\r\n        >\r\n          <img\r\n            src=\"@/assets/image/bxs_camera-plus.png\"\r\n            style=\"width: 25.54px; height: 22.81px\"\r\n          />\r\n          <div slot=\"file\" slot-scope=\"{ file }\">\r\n            <img\r\n              class=\"el-upload-list__item-thumbnail\"\r\n              :src=\"file.url\"\r\n              alt=\"\"\r\n            />\r\n            <span class=\"el-upload-list__item-actions\">\r\n              <span\r\n                class=\"el-upload-list__item-preview\"\r\n                @click=\"handlePictureCardPreview(file)\"\r\n              >\r\n                <i class=\"el-icon-zoom-in\"></i>\r\n              </span>\r\n              <span\r\n                v-if=\"!disabled\"\r\n                class=\"el-upload-list__item-delete\"\r\n                @click=\"handleRemove(file, item.goodsId)\"\r\n              >\r\n                <i class=\"el-icon-delete\"></i>\r\n              </span>\r\n            </span>\r\n          </div>\r\n        </el-upload>\r\n      </div>\r\n      <el-divider v-if=\"index < orderGoods.length - 1\"></el-divider>\r\n    </div>\r\n    <div class=\"action\">\r\n      <el-button @click=\"submit\" :disabled=\"disabled\">\r\n        {{ $t(\"message.home.Submitareview\") }}\r\n      </el-button>\r\n    </div>\r\n    <el-dialog :visible.sync=\"dialogVisible\">\r\n      <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\" />\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters, mapActions } from \"vuex\";\r\nimport { numberFormat } from \"@/util\";\r\nimport { UploadApi, AddOrderEvaluateList } from \"@/api\";\r\nexport default {\r\n  name: \"order-evaluation-dialog\",\r\n  props: {\r\n    value: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    // currentOrderInfo: {\r\n    //     type: Object,\r\n    //     default: () => { },\r\n    // },\r\n    refresh: {\r\n      type: Function,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      // currentOrderInfo: this.$route.params?.currentOrderInfo || {},\r\n      // dialogVisible: this.value || false,\r\n      orderId: this.$route.query.orderId,\r\n      loading: false,\r\n      rateMap: {},\r\n      contentMap: {},\r\n      imagesMap: {},\r\n      resultMap: {},\r\n      dialogImageUrl: \"\",\r\n      isUpload:false,\r\n      dialogVisible: false,\r\n      disabled: false,\r\n      UploadApi,\r\n      uploadParams: {\r\n        moduleName: \"evaluate\",\r\n        token: localStorage.getItem(\"ES_TOKEN\"),\r\n      },\r\n    };\r\n  },\r\n  mounted() {\r\n    if (this.orderId) {\r\n      this.requestData();\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      orderGoods: \"order/orderGoods\",\r\n    }),\r\n  },\r\n  watch: {\r\n    orderGoods(newValue) {\r\n      let rateMap = {};\r\n      let contentMap = {};\r\n      let resultMap = {};\r\n\r\n      newValue.forEach((item) => {\r\n        rateMap[item.goodsId] = 5;\r\n        contentMap[item.goodsId] = \"\";\r\n        resultMap[item.goodsId] = false;\r\n      });\r\n\r\n      this.rateMap = { ...rateMap };\r\n      this.contentMap = { ...contentMap };\r\n      this.resultMap = { ...resultMap };\r\n    },\r\n\r\n  },\r\n  methods: {\r\n    ...mapActions({\r\n      requestOrderGoodsList: \"order/requestOrderGoodsList\",\r\n      requestOrderEvaluationList: \"order/requestOrderEvaluationList\",\r\n    }),\r\n    uploadFile(params, goodsId) {\r\n      console.log(goodsId, params);\r\n    },\r\n\r\n    handleRemove(file, goodsId) {\r\n      const index = this.imagesMap[goodsId]?.findIndex(\r\n        (x) => x.uid == file.uid\r\n      );\r\n      index >= 0 && this.imagesMap[goodsId]?.splice(index, 1);\r\n    },\r\n    handlePictureCardPreview(file) {\r\n      this.dialogImageUrl = file.url;\r\n      this.dialogVisible = true;\r\n    },\r\n\r\n    handleFilesChange(files, goodsId) {\r\n      if (files.length >8) {\r\n        this.$message.warning(this.$t(\"message.home.最多上传9张图片\"));\r\n        this.isUpload = true\r\n      }else{\r\n        this.imagesMap[goodsId] = files;\r\n      }\r\n      \r\n    },\r\n\r\n    goBack() {\r\n      this.$router.push(\"/userInfo/my-order\");\r\n    },\r\n    getRate(id) {\r\n      if (this.rateMap[id] < 2) {\r\n        return 3;\r\n      } else if (this.rateMap[id] < 4) {\r\n        return 2;\r\n      }\r\n      return 1;\r\n    },\r\n    async requestData() {\r\n      try {\r\n        this.loading = true;\r\n        await this.requestOrderGoodsList({ orderId: this.orderId });\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    async submit() {\r\n      // const content = this.contentMap[item.goodsId]?.trim() ?? ''\r\n      // if (!content) {\r\n      //   this.$message.warning(this.$t('message.home.evaluateOrderPlaceholder'))\r\n      //   return\r\n      // }\r\n\r\n      try {\r\n        this.btnLoading = true;\r\n        this.disabled = true;\r\n        // await this.requestOrderEvaluationList({\r\n        //     sellerGoodsId: item.goodsId,\r\n        //     evaluationType: this.getRate(),\r\n        //     rating: this.rateMap[item.goodsId],\r\n        //     orderId: this.orderId,\r\n        //     content: content || this.$t('message.home.defaultRate'),\r\n        // })\r\n        // this.resultMap[item.goodsId] = true\r\n        const evaluationAdds = [];\r\n        // const canContinue = true;\r\n        for (let { goodsId } of this.orderGoods) {\r\n          const evaluation = {\r\n            sellerGoodsId: goodsId,\r\n            evaluationType: this.getRate(goodsId),\r\n            rating: this.rateMap[goodsId],\r\n            content: this.contentMap[goodsId],\r\n          };\r\n\r\n          const notUpload = this.imagesMap[goodsId]?.filter((x) => !x.response);\r\n\r\n          if (notUpload && notUpload.length > 0) {\r\n            this.$message({\r\n              // title: this.$t('message.home.successTips'),\r\n              message: this.$t(\"message.home.evaluationUploading\"),\r\n              type: \"error\",\r\n            });\r\n            return;\r\n          }\r\n\r\n          const imageUrls =\r\n            this.imagesMap[goodsId]\r\n              ?.filter((x) => x.response && x.response.code == \"0\")\r\n              .map((x) => x.response.data) || [];\r\n\r\n          for (let i = 0; i < imageUrls.length; i++) {\r\n            evaluation[`imgUrl${i + 1}`] = imageUrls[i];\r\n          }\r\n          evaluationAdds.push(evaluation);\r\n        }\r\n\r\n        let res = await AddOrderEvaluateList({\r\n          orderId: this.orderId,\r\n          evaluationAdds,\r\n        });\r\n\r\n        if (res.code == 0) {\r\n          this.$router.push({path:\"/userInfo/my-order\",replace:true});\r\n          this.$notify({\r\n            title: this.$t(\"message.home.successTips\"),\r\n            message: this.$t(\"message.home.evaluateOrderSuccess\"),\r\n            type: \"success\",\r\n          });\r\n        }else{\r\n          // this.$message({\r\n          //   title: this.$t('message.home.fuilTips'),\r\n          //   message: this.$t(\"message.home.evaluateOrderFuil\"),\r\n          //   type: \"error\",\r\n          // });\r\n        }\r\n\r\n        // this.$emit(\"closeDetails\");\r\n        // this.refresh && this.refresh()\r\n      } finally {\r\n        this.btnLoading = false;\r\n        this.disabled = false;\r\n      }\r\n    },\r\n\r\n    numberFormatFn(num) {\r\n      return numberFormat(num);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.evaluation-list {\r\n  /deep/ .el-upload--picture-card {\r\n    width: 70px;\r\n    height: 70px;\r\n  }\r\n\r\n  /deep/ .el-upload {\r\n    width: 70px;\r\n    height: 70px;\r\n    line-height: 70px;\r\n  }\r\n\r\n  /deep/ .el-upload-list--picture-card .el-upload-list__item {\r\n    width: 70px;\r\n    height: 70px;\r\n    line-height: 70px;\r\n  }\r\n\r\n  /deep/ .el-upload-list--picture-card .el-upload-list__item-thumbnail {\r\n    width: 70px;\r\n    height: 70px;\r\n    line-height: 70px;\r\n  }\r\n\r\n  .evaluation-item {\r\n    + .evaluation-item {\r\n      margin-top: 18px;\r\n    }\r\n\r\n    .product-item {\r\n      display: flex;\r\n      flex-direction: row;\r\n\r\n      img {\r\n        width: 62px;\r\n        height: 62px;\r\n      }\r\n\r\n      .info {\r\n        margin-left: 18px;\r\n        flex: 1;\r\n\r\n        .price {\r\n          font-weight: 500;\r\n          font-size: 16px;\r\n          color: var(--color-main);\r\n          margin-top: 8px;\r\n        }\r\n\r\n        .el-rate {\r\n          margin-top: 5px;\r\n        }\r\n      }\r\n    }\r\n\r\n    .content {\r\n      margin-top: 25px;\r\n\r\n      .el-textarea__inner {\r\n        border: 1px solid #efefef;\r\n        height: 70px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.action {\r\n  // padding: 20px 0;\r\n  display: flex;\r\n  align-items: center;\r\n  // justify-content: center;\r\n  margin-top: 52px;\r\n  margin-left: 34px;\r\n\r\n  .el-button {\r\n    width: 480px;\r\n    height: 44px;\r\n    color: #fff;\r\n    background: var(--color-main);\r\n    border-color: var(--color-main);\r\n    border-radius: 4px;\r\n  }\r\n}\r\n</style>\r\n"]}]}