{"remainingRequest":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\src\\page\\searchResultPage\\index.vue?vue&type=style&index=0&id=1ddeadce&lang=scss","dependencies":[{"path":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\src\\page\\searchResultPage\\index.vue","mtime":1760944158216},{"path":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\node_modules\\css-loader\\dist\\cjs.js","mtime":1761044715569},{"path":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1761044717168},{"path":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\node_modules\\postcss-loader\\src\\index.js","mtime":1761044716266},{"path":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1761044715084},{"path":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1761044715083},{"path":"C:\\Users\\HP\\Desktop\\tk08\\tiktok08\\buyPC\\node_modules\\vue-loader\\lib\\index.js","mtime":1761044716737}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5hcHAtY29udGFpbmVyIHsKICB3aWR0aDogMTIwMHB4Owp9Ci5zZXJhY2gtcmVzdWx0IHsKICAmLXdyYXAgewogICAgbWluLWhlaWdodDogY2FsYygxMDB2aCAtIDM5MHB4KTsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHBhZGRpbmctYm90dG9tOiAxMTJweDsKCiAgICAuY29tbW9uLXBhZ2luYXRpb24gewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIGJvdHRvbTogMDsKICAgICAgbGVmdDogMDsKICAgIH0KICB9CgogIC5jb21tb2RpdHktY29udGVudC10aXRsZSB7CiAgICBwYWRkaW5nOiAwcHggNDBweDsKICB9CiAgLm5vLWRhdGEgewogICAgZGlzcGxheTogZmxleDsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA6NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/page/searchResultPage","sourcesContent":["<template>\r\n  <div class=\"serach-result\">\r\n    <EsHeaderView @searchValueChange=\"searchValueChange\" />\r\n    <div class=\"serach-result-wrap app-container app-center\">\r\n      <EsLoadingView :loading=\"httpLoading\">\r\n        <div class=\"serach-result-product\">\r\n          <EsSortView @sort=\"sortEvent\" />\r\n          <div class=\"product-list\" v-if=\"serachResultList.length\">\r\n            <EsProductView\r\n              v-for=\"(item, index) in serachResultList\"\r\n              :key=\"index\"\r\n              :item=\"item\"\r\n            />\r\n          </div>\r\n          <div\r\n            class=\"common-pagination\"\r\n            v-if=\"serachResultList.length || total\"\r\n          >\r\n            <el-pagination\r\n              background\r\n              layout=\"prev, pager, next\"\r\n              class=\"es-pagination\"\r\n              :page-size=\"pageSize\"\r\n              :current-page=\"pageNum\"\r\n              :total=\"total\"\r\n              @current-change=\"currentChange\"\r\n            />\r\n          </div>\r\n          <div class=\"no-data\" v-if=\"!serachResultList.length\">\r\n            <el-empty :description=\"$t('message.home.noData')\"></el-empty>\r\n          </div>\r\n        </div>\r\n      </EsLoadingView>\r\n    </div>\r\n    <EsFooterView />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  // import EsStore from '@/components/store'\r\n  import EsSortView from \"@/page/commodityPage/sort.vue\";\r\n  import EsProductView from \"@/components/product\";\r\n  import { mapActions, mapGetters, mapMutations } from \"vuex\";\r\n  // import { SearchApi } from \"@/api\";\r\n  const emptyParam = [undefined, null, \"\"];\r\n\r\n  export default {\r\n    name: \"EsSearchResult\",\r\n    components: { EsSortView, EsProductView },\r\n    props: {\r\n      // 类型 store 商铺， product 商品\r\n      type: {\r\n        type: String,\r\n        default: \"product\",\r\n      },\r\n    },\r\n    data() {\r\n      return {\r\n        httpLoading: false,\r\n        pageNum: 1,\r\n        pageSize: 12,\r\n        total: 0,\r\n        searchListInfo: [],\r\n        beforeSortParams: {},\r\n        dataType: \"\",\r\n      };\r\n    },\r\n    watch: {\r\n      goodsList(val) {\r\n        // debugger;\r\n        this.serachResultList = val;\r\n      },\r\n      route: \"requestData\",\r\n    },\r\n    computed: {\r\n      ...mapGetters({\r\n        storeSearchValue: \"home/storeSearchValue\",\r\n        serachResultList: \"user/serachResultList\",\r\n      }),\r\n      isStoreView() {\r\n        return this.type === \"store\";\r\n      },\r\n      goodsList() {\r\n        return JSON.parse(localStorage.getItem(\"ES_SEARCH_RESULT\") || \"[]\");\r\n      },\r\n      \r\n    },\r\n   activated () {\r\n    this.$nextTick(() => {\r\n       const { k } = this.$route.query\r\n      if (k) {\r\n      this.pageInit(k)\r\n      }\r\n    })\r\n  },\r\n    \r\n    methods: {\r\n      ...mapActions({\r\n        requestSearchResultList: \"user/requestSearchResultList\",\r\n      }),\r\n      ...mapMutations({\r\n        updateSerachResultList: \"user/updateSerachResultList\",\r\n      }),\r\n      pageInit(k) {\r\n      // if (k) {\r\n      //   this.keyword = k\r\n      //   this.requestData()\r\n      // } else {\r\n      //   this.$router.push('/')\r\n      // }\r\n    },\r\n      async requestData(params = {}) {\r\n        const keywords = this.storeSearchValue;\r\n        console.log('3333 ->', 3333);\r\n        // if (keywords.indexOf('&') !== -1){\r\n        //     const val  = JSON.parse(keywords)\r\n        //     keywords =  String(encodeURIComponent(val)).trim()\r\n        //     }else{\r\n        //     const val  = JSON.parse(keywords)\r\n        //     keywords = String(val).trim()\r\n        // }\r\n        if (params) {\r\n          const hasId = Object.prototype.hasOwnProperty.call(params, \"keyword\");\r\n          const sortParams = hasId ? this.beforeSortParams : {};\r\n          await this.requestSearchResultList({\r\n            keyword: hasId ? params.categoryId : keywords,\r\n            ...sortParams,\r\n            ...params,\r\n            pageNum: this.pageNum,\r\n            pageSize: this.pageSize,\r\n          }).then((res) => {\r\n            this.total =\r\n              this.pageNum === 1 && !res.pageList.length\r\n                ? 0\r\n                : res.pageList.length < this.pageSize\r\n                ? res.pageInfo.pageNum * this.pageSize\r\n                : res.pageInfo.pageNum * this.pageSize + 1;\r\n          });\r\n        } else {\r\n          try {\r\n            if (emptyParam.includes(keywords)) {\r\n              return;\r\n            }\r\n            this.httpLoading = true;\r\n            await this.requestSearchResultList({\r\n              ...beforeSortParams,\r\n              keyword: keywords,\r\n              pageNum: this.pageNum,\r\n              pageSize: this.pageSize,\r\n            })\r\n              .then((res) => {\r\n                this.total =\r\n                  this.pageNum === 1 && !res.pageList.length\r\n                    ? 0\r\n                    : res.pageList.length < this.pageSize\r\n                    ? res.pageInfo.pageNum * this.pageSize\r\n                    : res.pageInfo.pageNum * this.pageSize + 1;\r\n                this.httpLoading = false;\r\n              })\r\n              .catch(() => {\r\n                this.httpLoading = false;\r\n              });\r\n          } finally {\r\n            this.httpLoading = false;\r\n          }\r\n        }\r\n      },\r\n      currentChange(page) {\r\n        this.pageNum = page;\r\n        this.requestData();\r\n      },\r\n      searchValueChange(val) {\r\n        if (!emptyParam.includes(val)) {\r\n          this.pageNum = 1;\r\n          this.requestData({ keyword: val });\r\n        }\r\n      },\r\n      sortEvent(params) {\r\n        this.beforeSortParams = params;\r\n        if (!this.storeSearchValue) {\r\n          this.updateSerachResultList({ pageList: [] });\r\n          return;\r\n        }\r\n\r\n        this.pageNum = 1;\r\n        this.requestData(params);\r\n      },\r\n    },\r\n    beforeDestroy() {\r\n      console.log(\"实例销毁完成\");\r\n    },\r\n  };\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n  .app-container {\r\n    width: 1200px;\r\n  }\r\n  .serach-result {\r\n    &-wrap {\r\n      min-height: calc(100vh - 390px);\r\n      position: relative;\r\n      padding-bottom: 112px;\r\n\r\n      .common-pagination {\r\n        position: absolute;\r\n        bottom: 0;\r\n        left: 0;\r\n      }\r\n    }\r\n\r\n    .commodity-content-title {\r\n      padding: 0px 40px;\r\n    }\r\n    .no-data {\r\n      display: flex;\r\n      justify-content: center;\r\n    }\r\n  }\r\n</style>\r\n"]}]}