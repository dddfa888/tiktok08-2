import{_,e as I,$ as Q,o as c,c as u,b as m,w as S,a as r,F as D,E as M,x as E,v as V,r as v,T as f,B as y,a9 as x,aa as T,d as F,t as b,ab as H,I as N}from"./index-55507c28.js";import{B as X}from"./index-64f4bac7.js";import{S as q,a as d}from"./index-e67ee6ff.js";import{u as z}from"./upload.api-93555138.js";const Y=I({name:"ShopBanner",components:{VuePictureCropper:q},setup(){const{t:e}=V.useI18n(),h=v(localStorage.getItem("sellerId")||""),w=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABYCAYAAABxlTA0AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAThSURBVHgB7ZxdTttaEMeHDyFEQMoOrnfQsIJrVgCR+Hy6zgpu7wpIV9DeFeA+QQhS6QpqVkC6gywhL8lLCPQ/xa4QTY5PSjxnWuYnRU7k48T5e3zOnJk5JjIMwzAMwzAUskRKODs7q29sbLxdWVn5i15GNh6Pb05OTvqkABUCn5+fRxD2C95GtBj6k8lkR4PIwQWuQNwCFSIHFbhCcQuCixxMYAFxC4KKHERgQXELgoksLnAAcQuCiCwqcEBxC8RFFhNYgbgFoiKLCKxI3AIxkSsXWKG4BSIizyUwT2drtdrew8PDG4hW9znm/v4+Jn3iFvSXl5czn4a4GANsbo6Ojq5pDrwF7na7b7E5hbhewv7B8EVp7+/vf/Rp7CVwp9NpLy0tnZLxAxjaO1hzu6xdqcCXl5cJNmdk/AS6v/+Oj48/uNosUzlmuTNAV3HK45KzjWvn1dXVHukdoDRQ39ra2nU1cAqMfuZvMpzAu2i49q+6dmrxGHAefQyyfbzlV/3Jq0GBwXk5NXIKHJABRE1x8tfD4fBrq9UazGqIQZjvsgTtY7SPSBnaBM7wah8eHt74HpC3/d4es8aEBx5NQmsReACXpw2X5396AZj2ptikFxcXnDxVMSnycdMqBSL0MFBsv1Tcp7Bvend3t819NwUmqMCw2nQ0GlUScOHvXFtb28bbuWIHiyZkF3ENS2tRhTSbTR4cm5jq84D5DwUgiAXzrQvvoFJxnwJL5kBVjwIQwoJ5QNtxuV5PgRvGcZBkxu4UXkTphWJLhofRXF1dvZUe+MQtmL2FENld/k0Mpu9IGFGBuWtYpLcwL3nkKyNBpC24TYGRtmIxgdl6EaD2ygJUCbqKDB6FV/+/CMQExp/KSA8pCSHZRaSkBMzyPpMQYm6aK4CDwP7MlFSelZ5F7DoWicmpLtz6+npvPB6TBCICc7zBtR8iJvRrRCXHThWY/WL4130SyNaIdBGSg4oveQC/ckQEhgWrE1gq0vZqLZgeU06VI+VFRKSMslzaoni1ApOQBUu5aREXaDgiaOmsA13JzDzbnNEvgGNFMtJifjB8T/5D2bR9rpCjK1zJ4vqEK5/T7XZjCEwSiM3kkO3dJSVAXLHshmQsIiE9xCSEZCyijqxCTIHJq0UjEkI0Hsy1ChQe0XOQDrjHXBRCgcir9CMSRDwnx6VNvDCGhMl/U/wOCpFVrkPkT/CLvTLLuRv2ohQ/++C80ilEKVWQugh4FI1arfaehMBvsS8dUQBCVvYknU6nPhqNWr41EvOSP0WFM8l7FIigtWmw5D1Y120VfTJ/J777S6iSqYLg1ZWAV4LeLtK7YG+Bq3hIQQW8lvpgHvjeYxLw7zyL/J7DMQZ6XCwZkxK0Vbhzji2F0G285/qFjwcHB9msxtzHbm5uNnDMLi5MonEVqtY1GhE9rrtIIDZ/7nFWhFNPEJK3Eb+4HUfFsI+komPzolXg5zQKAWGt9DuhYZD7ozGBK8YErhinwErT7aooK2BxCixZJPe7gsE3c+33eV4EP28nJmManHTdcTUo7YMnk0nLuoqpDFibskalAvPiEdwGOxpWTSqCDc5rAaWXF4HboMdLr0hREXUgeBb5gZf+siY+B8z93LT80V5vuLYLor+aJ1Dh/34dDof9qmLXhmEYhmEYhmEYhmEYhmF8AwdhLA50cpBqAAAAAElFTkSuQmCC",self.location),t=v([{name:"".concat(e("storeBanner")," 1(1920X300)"),id:"banner1",dataURL:"",blobURL:"",file:"",imgUrl:""},{name:"".concat(e("storeBanner")," 2(1920X300)"),id:"banner2",dataURL:"",blobURL:"",file:"",imgUrl:""},{name:"".concat(e("storeBanner")," 3(1920X300)"),id:"banner3",dataURL:"",blobURL:"",file:"",imgUrl:""}]);f.loading({duration:0,message:e("loading"),forbidClick:!0}),y().then(a=>{t.value[0].dataURL=a.banner1||"",t.value[1].dataURL=a.banner2||"",t.value[2].dataURL=a.banner3||"",f.clear()}).catch(()=>{f.clear()});const g=v(!1),A=v(""),i=v(null),C=(a,n)=>{A.value="",t.value[n].dataURL="",t.value[n].blobURL="",t.value[n].file="",i.value=n;const{files:l}=a.target;if(!l||!l.length)return;const o=l[0],p=new FileReader;p.readAsDataURL(o),p.onload=()=>{A.value=String(p.result),g.value=!0}},B=async()=>{if(!d)return;const a=d.getDataURL(),n=await d.getBlob();if(!n)return;const l=await d.getFile();if(i.value===null)return g.value=!1,!1;t.value[i.value].dataURL=a,t.value[i.value].blobURL=URL.createObjectURL(n),t.value[i.value].file=l,g.value=!1},L=()=>{d&&(d.clear(),d.reset(),g.value=!1)},R=async a=>{for(let n=0;n<a.length;n++)await z({file:a[n].file,moduleName:a[n].id}).then(l=>{const o=t.value.find(p=>p.id===a[n].id);o.imgUrl=l})},s=v(!1);return{bannerImg:w,bannerData:t,submitLoading:s,isShowModal:g,cropperImage:A,showBtn:h,t:e,selectFile:C,getResult:B,croperBack:L,submitHandle:async()=>{const a=t.value.filter(n=>n.file||n.remove);if(a.length){const n=a.filter(o=>o.file);s.value=!0;try{await R(n)}catch(o){return s.value=!1,!1}const l={};a.forEach(o=>{l[o.id]=o.imgUrl}),H(l).then(()=>{s.value=!1,t.value.map(o=>{o.file="",o.imgUrl="",o.remove=!1}),f.success(e("saveSuc"))}).catch(()=>{s.value=!1})}else f(e("noNeedSub"))},removeHandle:a=>{a.dataURL="",a.imgUrl="",a.blobURL="",a.file="",a.remove=!0}}}}),J={class:"banner-content"},j={class:"title"},W={class:"img-content"},K=["onClick"],G=["onChange"],P=["src"],Z={key:2,class:"default"},O=["src"],$={class:"submit-btn"},ee={key:0,class:"croper-content-modal"};function ae(e,h,w,t,g,A){const i=x,C=N,B=X,L=T,R=Q("VuePictureCropper");return c(),u("div",null,[m(i,{fixed:!0},{title:S(()=>[F(b(e.t("bannerSet")),1)]),_:1}),h[0]||(h[0]=r("div",{style:{height:"46px"}},null,-1)),r("div",J,[(c(!0),u(D,null,M(e.bannerData,(s,k)=>(c(),u("div",{key:s.id,class:"item"},[r("div",j,b(s.name),1),r("div",W,[s.dataURL?(c(),u("div",{key:0,class:"close",onClick:U=>e.removeHandle(s)},[m(C,{name:"cross"})],8,K)):E("",!0),r("input",{type:"file",accept:"image/jpg, image/jpeg, image/png, image/gif",onChange:U=>e.selectFile(U,k)},null,40,G),s.dataURL?(c(),u("img",{key:1,src:s.dataURL,alt:""},null,8,P)):(c(),u("div",Z,[r("img",{src:e.bannerImg,alt:""},null,8,O),r("p",null,b(e.t("addBanner")),1)]))])]))),128)),r("div",$,[m(B,{loading:e.submitLoading,type:"primary",size:"large",disabled:!e.showBtn,onClick:e.submitHandle},{default:S(()=>[F(b(e.showBtn?e.t("save"):e.t("商家入驻尚未完成")),1)]),_:1},8,["loading","disabled","onClick"])])]),e.isShowModal?(c(),u("div",ee,[m(L,{title:e.t("selectPhotos"),"right-text":e.t("sure"),"left-arrow":"",fixed:"",onClickLeft:e.croperBack,onClickRight:e.getResult},null,8,["title","right-text","onClickLeft","onClickRight"]),m(R,{boxStyle:{width:"100%",height:"100%",backgroundColor:"#f8f8f8",margin:"auto"},img:e.cropperImage,options:{viewMode:1,dragMode:"crop",aspectRatio:1920/300}},null,8,["img"])])):E("",!0)])}const le=_(Y,[["render",ae],["__scopeId","data-v-05b4cb50"]]);export{le as default};
