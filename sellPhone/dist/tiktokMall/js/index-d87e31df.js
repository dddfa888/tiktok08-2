import{_ as j,j as A,i as R,v as z,a0 as D,l as E,r as c,q as H,m as M,o as h,c as g,b as f,w as x,a as n,t as l,u as t,x as k,d as m,n as T,T as v,a9 as G,cb as J,F as K,I as O}from"./index-55507c28.js";import{B as P}from"./index-64f4bac7.js";import"./index-6e53b41f.js";import{F as Q}from"./index-3bdff75a.js";import{a as W}from"./login.api-f8cfd6d7.js";import"./use-id-acc627d9.js";const X={class:"verify-content"},Y={class:"info-content"},Z={class:"info-item"},$={class:"gap"},ee={class:"info-item"},te={class:"gap"},se={key:0},ne={class:"change-ver-type"},oe={class:"submit-content"},ae={__name:"index",setup(le){const p=A(),C=R(),{t:e}=z.useI18n(),i=D(),q=E(),o=c(1),N=c(1),b=c("44"),y=c(""),r=c(0),_=c(null),I=c(!1);o.value=i.query&&i.query.type?Number(i.query.type):1,N.value=i.query&&i.query.verType?Number(i.query.verType):1,H(()=>{clearInterval(_.value),_.value=null});const S=M(()=>{if(!p.userInfo.token)q.push("/login");else{const{email:u,phone:s}=p.userInfo;let a="";if(o.value===1){if(s){const d=s.split(" ");d.length===2?(b.value=d[0],a=d[1]):a=d[0]}}else a=u||"";return a}}),B=()=>{if(r.value>0)return!1;const{email:u,phone:s}=p.userInfo;v.loading({duration:0,forbidClick:!0}),W({target:o.value===1?s:u}).then(()=>{v(e("sendSuccess")),r.value=60,_.value=setInterval(()=>{r.value>0?r.value=r.value-1:(r.value=0,clearInterval(_.value),_.value=null)},1e3)}).catch(()=>{v.clear()})},w=()=>{const{email:u,phone:s}=p.userInfo,a=o.value===1?2:1;if(a===2&&!u)return v(e("暂未绑定邮箱，无法进行邮箱验证")),!1;if(a===1&&!s)return v(e("暂未绑定手机号，无法进行手机验证")),!1;o.value=a},F=()=>{if(y.value===""){v(e("entryVerifyCode"));return}I.value=!0;const{email:u,phone:s}=p.userInfo;o.value,y.value,o.value};return(u,s)=>{const a=G,d=Q,V=P,L=O;return h(),g("div",X,[f(a,{fixed:!0},{title:x(()=>[m(l(t(e)("身份验证")),1)]),_:1}),s[1]||(s[1]=n("div",{style:{height:"46px"}},null,-1)),n("div",Y,[n("div",Z,[n("h2",$,l(o.value===1?t(e)("手机验证"):t(e)("邮箱验证")),1),n("p",null,l(t(e)("为了保障您的账号安全，请验证后进行下一步操作")),1)]),n("div",ee,[n("p",te,l(o.value===1?t(e)("当前绑定手机号"):t(e)("当前绑定邮箱")),1),n("h2",null,[o.value===1?(h(),g("span",se,"(+"+l(b.value)+")",1)):k("",!0),m(l(t(J)(S.value,!1)),1)])]),n("div",{class:T(["code-content",{"is-ar":t(C)}])},[f(d,{modelValue:y.value,"onUpdate:modelValue":s[0]||(s[0]=U=>y.value=U),type:"tel",label:"",placeholder:t(e)("entryVerifyCode")},null,8,["modelValue","placeholder"]),n("div",{class:T(["btn",{"is-ar":t(C)}])},[f(V,{type:"primary",onClick:B},{default:x(()=>[m(l(t(e)("sendVerifyCode")),1),r.value?(h(),g(K,{key:0},[m("("+l(r.value)+")s",1)],64)):k("",!0)]),_:1})],2)],2),n("div",ne,[f(L,{name:"exchange"}),n("p",{onClick:w},l(o.value===1?t(e)("切换为邮箱验证"):t(e)("切换为手机验证")),1)])]),n("div",oe,[f(V,{type:"primary",loading:I.value,onClick:F},{default:x(()=>[m(l(t(e)("nextStep")),1)]),_:1},8,["loading"])])])}}},pe=j(ae,[["__scopeId","data-v-92b6e316"]]);export{pe as default};
