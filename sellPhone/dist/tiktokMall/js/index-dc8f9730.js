import{aq as j,aG as I,as as q,ax as E,e as G,r as L,p as J,aI as ue,ar as b,m as f,ay as K,f as C,by as re,bz as ve,q as U,a1 as fe,bA as de,bB as he,ac as ge,b as P,bC as V,s as F,aJ as me,aC as O,av as Q}from"./index-55507c28.js";const[Z,M]=j("swipe"),we={loop:I,width:q,height:q,vertical:Boolean,autoplay:E(0),duration:E(500),touchable:I,lazyRender:Boolean,initialSwipe:E(0),indicatorColor:String,showIndicators:I,stopPropagation:I},ee=Symbol(Z);var be=G({name:Z,props:we,emits:["change"],setup(a,{emit:A,slots:h}){const u=L(),d=L(),e=J({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),r=ue(),{children:g,linkChildren:R}=b.useChildren(ee),i=f(()=>g.length),s=f(()=>e[a.vertical?"height":"width"]),l=f(()=>a.vertical?r.deltaY.value:r.deltaX.value),m=f(()=>e.rect?(a.vertical?e.rect.height:e.rect.width)-s.value*i.value:0),_=f(()=>Math.ceil(Math.abs(m.value)/s.value)),p=f(()=>i.value*s.value),$=f(()=>(e.active+i.value)%i.value),D=f(()=>{const t=a.vertical?"vertical":"horizontal";return r.direction.value===t}),te=f(()=>{const t={transitionDuration:"".concat(e.swiping?0:a.duration,"ms"),transform:"translate".concat(a.vertical?"Y":"X","(").concat(e.offset,"px)")};if(s.value){const o=a.vertical?"height":"width",n=a.vertical?"width":"height";t[o]="".concat(p.value,"px"),t[n]=a[n]?"".concat(a[n],"px"):""}return t}),ae=t=>{const{active:o}=e;return t?a.loop?O(o+t,-1,i.value):O(o+t,0,_.value):o},B=(t,o=0)=>{let n=t*s.value;a.loop||(n=Math.min(n,-m.value));let v=o-n;return a.loop||(v=O(v,m.value,0)),v},w=({pace:t=0,offset:o=0,emitChange:n})=>{if(i.value<=1)return;const{active:v}=e,c=ae(t),S=B(c,o);if(a.loop){if(g[0]&&S!==m.value){const k=S<m.value;g[0].setOffset(k?p.value:0)}if(g[i.value-1]&&S!==0){const k=S>0;g[i.value-1].setOffset(k?-p.value:0)}}e.active=c,e.offset=S,n&&c!==v&&A("change",$.value)},z=()=>{e.swiping=!0,e.active<=-1?w({pace:i.value}):e.active>=i.value&&w({pace:-i.value})},ie=()=>{z(),r.reset(),b.doubleRaf(()=>{e.swiping=!1,w({pace:-1,emitChange:!0})})},Y=()=>{z(),r.reset(),b.doubleRaf(()=>{e.swiping=!1,w({pace:1,emitChange:!0})})};let X;const x=()=>clearTimeout(X),T=()=>{x(),a.autoplay>0&&i.value>1&&(X=setTimeout(()=>{Y(),T()},+a.autoplay))},y=(t=+a.initialSwipe)=>{if(!u.value)return;const o=()=>{var n,v;if(!V(u)){const c={width:u.value.offsetWidth,height:u.value.offsetHeight};e.rect=c,e.width=+((n=a.width)!=null?n:c.width),e.height=+((v=a.height)!=null?v:c.height)}i.value&&(t=Math.min(i.value-1,t)),e.active=t,e.swiping=!0,e.offset=B(t),g.forEach(c=>{c.setOffset(0)}),T()};V(u)?F().then(o):o()},H=()=>y(e.active);let N;const ne=t=>{a.touchable&&(r.start(t),N=Date.now(),x(),z())},oe=t=>{a.touchable&&e.swiping&&(r.move(t),D.value&&(!a.loop&&(e.active===0&&l.value>0||e.active===i.value-1&&l.value<0)||(me(t,a.stopPropagation),w({offset:l.value}))))},W=()=>{if(!a.touchable||!e.swiping)return;const t=Date.now()-N,o=l.value/t;if((Math.abs(o)>.25||Math.abs(l.value)>s.value/2)&&D.value){const v=a.vertical?r.offsetY.value:r.offsetX.value;let c=0;a.loop?c=v>0?l.value>0?-1:1:0:c=-Math[l.value>0?"ceil":"floor"](l.value/s.value),w({pace:c,emitChange:!0})}else l.value&&w({pace:0});e.swiping=!1,T()},le=(t,o={})=>{z(),r.reset(),b.doubleRaf(()=>{let n;a.loop&&t===i.value?n=e.active===0?0:t:n=t%i.value,o.immediate?b.doubleRaf(()=>{e.swiping=!1}):e.swiping=!1,w({pace:n-e.active,emitChange:!0})})},se=(t,o)=>{const n=o===$.value,v=n?{backgroundColor:a.indicatorColor}:void 0;return P("i",{style:v,class:M("indicator",{active:n})},null)},ce=()=>{if(h.indicator)return h.indicator({active:$.value,total:i.value});if(a.showIndicators&&i.value>1)return P("div",{class:M("indicators",{vertical:a.vertical})},[Array(i.value).fill("").map(se)])};return K({prev:ie,next:Y,state:e,resize:H,swipeTo:le}),R({size:s,props:a,count:i,activeIndicator:$}),C(()=>a.initialSwipe,t=>y(+t)),C(i,()=>y(e.active)),C(()=>a.autoplay,T),C([re,ve],H),C(b.usePageVisibility(),t=>{t==="visible"?T():x()}),U(y),fe(()=>y(e.active)),de(()=>y(e.active)),he(x),ge(x),b.useEventListener("touchmove",oe,{target:d}),()=>{var t;return P("div",{ref:u,class:M()},[P("div",{ref:d,style:te.value,class:M("track",{vertical:a.vertical}),onTouchstartPassive:ne,onTouchend:W,onTouchcancel:W},[(t=h.default)==null?void 0:t.call(h)]),ce()])}}});const Se=Q(be),[ye,pe]=j("swipe-item");var xe=G({name:ye,setup(a,{slots:A}){let h;const u=J({offset:0,inited:!1,mounted:!1}),{parent:d,index:e}=b.useParent(ee);if(!d)return;const r=f(()=>{const i={},{vertical:s}=d.props;return d.size.value&&(i[s?"height":"width"]="".concat(d.size.value,"px")),u.offset&&(i.transform="translate".concat(s?"Y":"X","(").concat(u.offset,"px)")),i}),g=f(()=>{const{loop:i,lazyRender:s}=d.props;if(!s||h)return!0;if(!u.mounted)return!1;const l=d.activeIndicator.value,m=d.count.value-1,_=l===0&&i?m:l-1,p=l===m&&i?0:l+1;return h=e.value===l||e.value===_||e.value===p,h}),R=i=>{u.offset=i};return U(()=>{F(()=>{u.mounted=!0})}),K({setOffset:R}),()=>{var i;return P("div",{class:pe(),style:r.value},[g.value?(i=A.default)==null?void 0:i.call(A):null])}}});const Ce=Q(xe);export{Ce as S,Se as a};
