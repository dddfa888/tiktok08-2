import{_ as M,i as Z,b3 as G,j as H,v as J,a0 as Q,r as l,m as B,q as W,f as X,o as v,c as p,b as m,w as b,a as e,u as n,n as F,t as s,d as y,x as D,a8 as L,T as f,bg as Y,bh as ee,Z as c,a9 as se,F as te,E as oe,b4 as ae}from"./index-55507c28.js";import{A as ne}from"./index-3ce1345e.js";import{P as le,N as ue}from"./index-e25caf73.js";import{B as ie}from"./index-64f4bac7.js";import{L as re}from"./index-748d9839.js";import{D as ce}from"./decimal-2def1975.js";const de={class:"listitem"},_e={class:"pic"},ve=["src"],pe={class:"name"},me={class:"title"},he={class:"col"},fe={class:"title money"},ge={class:"line"},be={class:"line-item"},ye={class:"count"},$e={class:"line-item"},we={class:"count"},Ne={key:0,class:"price-content"},Ie={class:"line-item"},De={class:"count"},Le={class:"line-item"},ke={class:"count"},Pe={class:"line-item"},Se={class:"count"},Ce={class:"line-item"},Ve={class:"count"},qe={class:"line-item"},Be={class:"count"},Fe={key:1,class:"btn"},xe={style:{height:"22rem"}},Oe={__name:"qr_order",setup(Te){const k=Z(),x=G(),O=H(),{t:h}=J.useI18n(),P=Q();let i=l(!0);l(0),l(0),l(0),l(0);const $=l([]),g=l(!1),w=l(!1),N=l({pageNum:1}),S=P.query.id;l(0),l(0);const d=l("");let _=l(!1);const a=l({}),C=l(!0),T=B(()=>{var t;return(t=O.userInfo)==null?void 0:t.safeword}),j=()=>{T.value?(_.value=!0,i.value=!0):(f(h("请设置资金密码")),setTimeout(()=>{router.push({path:"/fundsPasswordSettings"})},1500))},E=()=>{const t={...N.value,orderId:S};Y(t).then(o=>{const r=o.pageList||[];$.value=N.value.pageNum===1?r:[...$.value,...r],N.value.pageNum++,g.value=!1,w.value=o.pageInfo.lastPage}).catch(()=>{w.value=!0,g.value=!1})},U=async()=>{f.loading({forbidClick:!0,duration:0}),await ee({orderId:S}).then(t=>{a.value=t.orderInfo,C.value=!1,f.clear()}).catch(()=>{f.clear()})};W(()=>{U()});const z=()=>{const o={orderId:P.query.id,safeword:d.value};ae(o).then(r=>{x.decrement(),document.dispatchEvent(new CustomEvent("reloadOrderList")),setTimeout(()=>{router.back()},1e3)})};X(()=>d.value,t=>{t.length===6&&(f.loading(""),z(),_.value=!1,d.value="")});const V=B(()=>{const{sellerDiscountPrice:t,systemPrice:o,sellerFees:r,tax:I}=a.value;return c(Number(t||o)+Number(r)+Number(I))});return(t,o)=>{const r=se,I=re,q=ie,A=le,R=ue,K=ne;return v(),p("div",null,[m(r,{fixed:""},{title:b(()=>[y(s(t.$t("采购确认")),1)]),_:1}),o[5]||(o[5]=e("div",{style:{height:"46px"}},null,-1)),m(I,{loading:g.value,"onUpdate:loading":o[0]||(o[0]=u=>g.value=u),finished:w.value,"loading-text":n(h)("loading"),onLoad:E},{default:b(()=>[e("div",{class:F(["list",{"is-ar":n(k)}])},[(v(!0),p(te,null,oe($.value,u=>(v(),p("div",de,[e("div",_e,[e("img",{style:{"object-fit":"contain"},src:u.goodsIcon},null,8,ve)]),e("div",pe,[e("p",me,s(u.goodsName),1),e("p",he,s(t.$t("采购数量")),1),e("p",fe,"$"+s(n(c)(u.systemPrice)),1),e("span",null,"x"+s(u.goodsNum),1)])]))),256))],2)]),_:1},8,["loading","finished","loading-text"]),Object.keys(a.value).length>0?(v(),p("div",{key:0,class:F(["line-content",{"is-ar":n(k)}])},[e("div",ge,[e("div",be,[e("p",null,s(t.$t("买家付款")),1),e("p",ye,"$"+s(n(c)(a.value.prizeReal)),1)]),e("div",$e,[e("p",null,s(t.$t("采购金额")),1),e("p",we,"$"+s(n(c)(a.value.systemPrice)),1)]),a.value.sellerDiscountPrice?(v(),p("div",Ne,[y(s(n(h)("优惠价")),1),e("span",null,"$"+s(a.value.sellerDiscountPrice),1),y(", "+s(n(h)("采购优惠")),1),e("span",null,s(new(n(ce))(a.value.sellerDiscount).mul(100))+"%",1)])):D("",!0),e("div",Ie,[e("p",null,s(t.$t("采购数量")),1),e("p",De,s(a.value.goodsCount),1)]),e("div",Le,[e("p",null,s(t.$t("利润")),1),e("p",ke,"$"+s(n(c)(a.value.profit)),1)]),e("div",Pe,[e("p",null,s(t.$t("运费")),1),e("p",Se,"$"+s(n(c)(a.value.sellerFees)),1)]),e("div",Ce,[e("p",null,s(t.$t("税")),1),e("p",Ve,"$"+s(n(c)(a.value.tax)),1)]),e("div",qe,[e("p",null,s(t.$t("合计")),1),e("p",Be,"$"+s(V.value),1)])])],2)):D("",!0),!C.value&&a.value.purchStatus/1!==1&&a.value.status/1!==-1&&a.value.status/1!==0&&a.value.status/1!==6?(v(),p("div",Fe,[m(q,{type:"primary",size:"large",onClick:j},{default:b(()=>[y(s("".concat(t.$t("立即支付")," $").concat(V.value)),1)]),_:1})])):D("",!0),m(K,{show:n(_),"onUpdate:show":o[4]||(o[4]=u=>L(_)?_.value=u:_=u),title:n(h)("请输入交易密码")},{default:b(()=>[e("div",xe,[m(A,{length:6,value:d.value,focused:n(i),onFocus:o[1]||(o[1]=u=>L(i)?i.value=!0:i=!0)},null,8,["value","focused"]),m(R,{modelValue:d.value,"onUpdate:modelValue":o[2]||(o[2]=u=>d.value=u),show:n(i),onBlur:o[3]||(o[3]=u=>L(i)?i.value=!1:i=!1)},null,8,["modelValue","show"])])]),_:1},8,["show","title"])])}}},Ke=M(Oe,[["__scopeId","data-v-d1e5b7a4"]]);export{Ke as default};
