import{aq as O,e as T,r as $,bX as j,ar as I,aG as S,b as a,av as D,aw as g,bi as M,bj as Y,m as _,ay as q,bS as G,as as V,at as X,aD as Z,bT as J,p as Q,bY as ee,bZ as A,az as K,aA as te,au as ne,ap as oe,bP as ae,bp as le,bW as se,b_ as re,bK as ce,b$ as ie,c0 as ue}from"./index-55507c28.js";import{B as k}from"./index-64f4bac7.js";const[N,E]=O("action-bar"),F=Symbol(N),de={placeholder:Boolean,safeAreaInsetBottom:S};var fe=T({name:N,props:de,setup(e,{slots:l}){const o=$(),r=j(o,E),{linkChildren:c}=I.useChildren(F);c();const m=()=>{var B;return a("div",{ref:o,class:[E(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[(B=l.default)==null?void 0:B.call(l)])};return()=>e.placeholder?r(m):m()}});const me=D(fe),[Be,ge]=O("action-bar-button"),be=g({},M,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var he=T({name:Be,props:be,setup(e,{slots:l}){const o=Y(),{parent:r,index:c}=I.useParent(F),m=_(()=>{if(r){const i=r.children[c.value-1];return!(i&&"isButton"in i)}}),B=_(()=>{if(r){const i=r.children[c.value+1];return!(i&&"isButton"in i)}});return q({isButton:!0}),()=>{const{type:i,icon:b,text:h,color:y,loading:p,disabled:P}=e;return a(k,{class:ge([i,{last:B.value,first:m.value}]),size:"large",type:i,icon:b,color:y,loading:p,disabled:P,onClick:o},{default:()=>[l.default?l.default():h]})}}});const R=D(he),[Ce,u,v]=O("dialog"),we=g({},G,{title:String,theme:String,width:V,message:[String,Function],callback:Function,allowHtml:Boolean,className:X,transition:Z("van-dialog-bounce"),messageAlign:String,closeOnPopstate:S,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:S,closeOnClickOverlay:Boolean}),ve=[...J,"transition","closeOnPopstate"];var H=T({name:Ce,props:we,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:l,slots:o}){const r=$(),c=Q({confirm:!1,cancel:!1}),m=t=>l("update:show",t),B=t=>{var s;m(!1),(s=e.callback)==null||s.call(e,t)},i=t=>()=>{e.show&&(l(t),e.beforeClose?(c[t]=!0,ae(e.beforeClose,{args:[t],done(){B(t),c[t]=!1},canceled(){c[t]=!1}})):B(t))},b=i("cancel"),h=i("confirm"),y=ee(t=>{var s,d;if(t.target!==((d=(s=r.value)==null?void 0:s.popupRef)==null?void 0:d.value))return;({Enter:e.showConfirmButton?h:A,Escape:e.showCancelButton?b:A})[t.key](),l("keydown",t)},["enter","esc"]),p=()=>{const t=o.title?o.title():e.title;if(t)return a("div",{class:u("header",{isolated:!e.message&&!o.default})},[t])},P=t=>{const{message:s,allowHtml:d,messageAlign:f}=e,w=u("message",{"has-title":t,[f]:f}),x=le(s)?s():s;return d&&typeof x=="string"?a("div",{class:w,innerHTML:x},null):a("div",{class:w},[x])},z=()=>{if(o.default)return a("div",{class:u("content")},[o.default()]);const{title:t,message:s,allowHtml:d}=e;if(s){const f=!!(t||o.title);return a("div",{key:d?1:0,class:u("content",{isolated:!f})},[P(f)])}},L=()=>a("div",{class:[re,u("footer")]},[e.showCancelButton&&a(k,{size:"large",text:e.cancelButtonText||v("cancel"),class:u("cancel"),style:{color:e.cancelButtonColor},loading:c.cancel,disabled:e.cancelButtonDisabled,onClick:b},null),e.showConfirmButton&&a(k,{size:"large",text:e.confirmButtonText||v("confirm"),class:[u("confirm"),{[se]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:c.confirm,disabled:e.confirmButtonDisabled,onClick:h},null)]),U=()=>a(me,{class:u("footer")},{default:()=>[e.showCancelButton&&a(R,{type:"warning",text:e.cancelButtonText||v("cancel"),class:u("cancel"),color:e.cancelButtonColor,loading:c.cancel,disabled:e.cancelButtonDisabled,onClick:b},null),e.showConfirmButton&&a(R,{type:"danger",text:e.confirmButtonText||v("confirm"),class:u("confirm"),color:e.confirmButtonColor,loading:c.confirm,disabled:e.confirmButtonDisabled,onClick:h},null)]}),W=()=>o.footer?o.footer():e.theme==="round-button"?U():L();return()=>{const{width:t,title:s,theme:d,message:f,className:w}=e;return a(oe,K({ref:r,role:"dialog",class:[u([d]),w],style:{width:ne(t)},tabindex:0,"aria-labelledby":s||f,onKeydown:y,"onUpdate:show":m},te(e,ve)),{default:()=>[p(),z(),W()]})}}});let C;function ye(){({instance:C}=ie({setup(){const{state:l,toggle:o}=ue();return()=>a(H,K(l,{"onUpdate:show":o}),null)}}))}function n(e){return ce?new Promise((l,o)=>{C||ye(),C.open(g({},n.currentOptions,e,{callback:r=>{(r==="confirm"?l:o)(r)}}))}):Promise.resolve()}n.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};n.currentOptions=g({},n.defaultOptions);n.alert=n;n.confirm=e=>n(g({showCancelButton:!0},e));n.close=()=>{C&&C.toggle(!1)};n.setDefaultOptions=e=>{g(n.currentOptions,e)};n.resetDefaultOptions=()=>{n.currentOptions=g({},n.defaultOptions)};n.Component=D(H);n.install=e=>{e.use(n.Component),e.config.globalProperties.$dialog=n};export{n as D};
