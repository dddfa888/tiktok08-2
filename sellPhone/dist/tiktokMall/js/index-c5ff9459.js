import{_ as Y,e as F,o as v,c as A,y as B,w as W,x as y,a as r,b as J,t as _,F as G,E as K,v as Z,a0 as H,r as f,f as Q,cC as j,s as N,j as X,T as M,ae as R,M as L,a9 as q,d as $,cD as ee,O as se,cE as te,I as ae,cb as ne,ag as oe,ah as a}from"./index-55507c28.js";import{m as re}from"./config-d229b60a.js";const ie=F({name:"MessageList",setup(){const{t:s,locale:h}=Z.useI18n(),V=H(),b=new URL("data:image/png;base64,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",self.location),S=new URL("/www/png/name-b2bb3866.png",self.location),D=f([]),l=f(!0),g=f(0),u=async t=>{const o=[];for(let n=0;n<t.length;n++){const e={...t[n]},d=new Date().getTime(),p=R(e.updatetime,"YYYY-MM-DD HH:mm"),m=new Date(p).getTime(),I=p.slice(p.indexOf(" ")+1),c=(d-m)/1e3;let i="";c<60?i=s("刚刚"):c<60*60*24?i=I:i=p,e.showTime=i,e.count=e.unreadmsg>99?99:e.unreadmsg,E.value?(e.showName=ne(e.username,!1,!0),t[n].useravatar&&!isNaN(Number(t[n].useravatar))?await oe(Object.assign({"../../../assets/image/userAvatar/1.png":()=>a(()=>import("./1-948689bc.js"),[]),"../../../assets/image/userAvatar/10.png":()=>a(()=>import("./10-1dab1aaf.js"),[]),"../../../assets/image/userAvatar/11.png":()=>a(()=>import("./11-446c7d49.js"),[]),"../../../assets/image/userAvatar/12.png":()=>a(()=>import("./12-d24c5bcf.js"),[]),"../../../assets/image/userAvatar/13.png":()=>a(()=>import("./13-162aa2f4.js"),[]),"../../../assets/image/userAvatar/14.png":()=>a(()=>import("./14-8cd72ff2.js"),[]),"../../../assets/image/userAvatar/15.png":()=>a(()=>import("./15-a2f75cd7.js"),[]),"../../../assets/image/userAvatar/16.png":()=>a(()=>import("./16-6bfb72bc.js"),[]),"../../../assets/image/userAvatar/17.png":()=>a(()=>import("./17-dcfe126f.js"),[]),"../../../assets/image/userAvatar/18.png":()=>a(()=>import("./18-315a13f7.js"),[]),"../../../assets/image/userAvatar/19.png":()=>a(()=>import("./19-4b0835ad.js"),[]),"../../../assets/image/userAvatar/2.png":()=>a(()=>import("./2-63d23b94.js"),[]),"../../../assets/image/userAvatar/20.png":()=>a(()=>import("./20-eb60e9cd.js"),[]),"../../../assets/image/userAvatar/3.png":()=>a(()=>import("./3-cb326417.js"),[]),"../../../assets/image/userAvatar/4.png":()=>a(()=>import("./4-ebcc75ff.js"),[]),"../../../assets/image/userAvatar/5.png":()=>a(()=>import("./5-efc9dabe.js"),[]),"../../../assets/image/userAvatar/6.png":()=>a(()=>import("./6-bd577974.js"),[]),"../../../assets/image/userAvatar/7.png":()=>a(()=>import("./7-507baf96.js"),[]),"../../../assets/image/userAvatar/8.png":()=>a(()=>import("./8-30373841.js"),[]),"../../../assets/image/userAvatar/9.png":()=>a(()=>import("./9-12cbe1fe.js"),[]),"../../../assets/image/userAvatar/default.png":()=>a(()=>import("./default-d4a50815.js"),[])}),"../../../assets/image/userAvatar/".concat(t[n].useravatar,".png")).then(U=>{e.avatarImg=U.default,o.push(e)}):(e.avatarImg="",o.push(e))):(e.showName=e.username,e.avatarImg=t[n].avatar||"",o.push(e))}return o},P=()=>{l.value&&M.loading({duration:0}),ee({loginType:E.value?"shop":"user"}).then(async t=>{const o=t||[];D.value=await u(o),N(()=>{l.value=!1})}).catch(()=>{l.value=!1})},x=t=>{L({path:"/messageCenter",query:{partyId:t.partyid,username:t.showName}})},C=()=>{document.dispatchEvent(new CustomEvent("systemListRefresh")),L("/message/system")},w=(t,o)=>{const e=(t.varInfo?JSON.parse(t.varInfo):[]).find(d=>d.code===o);return e?e.value:""},k=(t,o)=>{const e=(t.varInfo?JSON.parse(t.varInfo):[]).find(d=>d.code===o);return e?e.value:"0"},T=f({content:"",count:0,time:""}),z=()=>{se({type:3,module:1}).then(o=>{const n=o.count||0;T.value.count=n>99?"99+":n}),te({pageSize:10,pageNum:1,totalElements:-1,type:3,status:0,module:1}).then(o=>{const n=o.elements||[];if(n.length){const e=n[0],d={},p=e.varInfo?JSON.parse(e.varInfo):[];p.forEach(i=>{d[i.code]=["complaintReason"].includes(i.code)?s(i.value):i.value});const m=re[e.bizType],I=p.find(i=>i.code===m.key);let c="";if(["inbox_recharge_success","inbox_withdraw_success"].includes(e.bizType)){const i=e.bizType==="inbox_recharge_success"?"rechargeSuccessTips":"withdrawalSuccessTips";c=s(i,{orderAmount:k(e,"orderAmount")})}else["inbox_store_audit_fail","inbox_store_audit_success"].includes(e.bizType)?c=e.bizType==="inbox_store_audit_fail"?s("storeAuthenticationFailedTips",{shop_name:w(e,"shop_name"),reason:w(e,"reason")}):s("storeAuthenticationPassedTips",{shop_name:w(e,"shop_name")}):["inbox_store_compliant_success","inbox_withdrawal_audit_fail","inbox_recharge_audit_fail"].includes(e.bizType)?c=s(m.txt,d):m.key?(c=s(m.txt)+(I?I.value:"0"),m.txt1&&(c+=s(m.txt1))):c=s(m.txt);T.value.content=c,T.value.time=e.sendTime}})};Q(l,t=>{!t&&!g.value&&(g.value=setInterval(()=>{P()},5e3))}),j(()=>{g.value&&clearInterval(g.value)});const O=f(!1),E=f(!0);return N(async()=>{const{token:t,nohead:o,lang:n}=V.query,e=X();n&&(h.value=n,localStorage.setItem("lang",n)),t&&(O.value=!!o,M.loading({duration:0}),await e.getUserInfo(!0,t)),E.value=!0,P(),z()}),{t:s,isShop:E,shopDefault:b,userDefault:S,pageLoading:l,listData:D,sysMsgInfo:T,headHide:O,goToDetails:x,formatZoneDate:R,openPage:L,openSystemList:C}}}),ue={class:"page-main-content"},ce={key:1,style:{height:"46px"}},me={class:"list-content"},_e={class:"avatar sys"},de={class:"flex info-content"},le={key:0,class:"num"},pe={class:"flex txt-content"},ve={class:"txt"},ge={class:"time"},Ae=["onClick"],fe={class:"avatar"},he=["src"],Te={class:"flex info-content"},Ee={key:0,class:"num"},Ie={class:"flex txt-content"},ye={class:"txt"},De={class:"time"};function Pe(s,h,V,b,S,D){const l=q,g=ae;return v(),A("div",ue,[s.headHide?y("",!0):(v(),B(l,{key:0,fixed:!0},{title:W(()=>[$(_(s.$t("消息")),1)]),_:1})),s.headHide?y("",!0):(v(),A("div",ce)),r("div",me,[r("div",{class:"item-list",onClick:h[0]||(h[0]=(...u)=>s.openSystemList&&s.openSystemList(...u))},[r("div",_e,[J(g,{name:"bell",class:"icon"})]),r("div",de,[r("h3",null,_(s.t("系统消息")),1),s.sysMsgInfo.count?(v(),A("p",le,_(s.sysMsgInfo.count),1)):y("",!0)]),r("div",pe,[r("p",ve,_(s.sysMsgInfo.content||"-"),1),r("p",ge,_(s.formatZoneDate(s.sysMsgInfo.time,"YYYY-MM-DD HH:mm")),1)])]),(v(!0),A(G,null,K(s.listData,u=>(v(),A("div",{key:u.id,class:"item-list",onClick:P=>s.goToDetails(u)},[r("div",fe,[r("img",{src:u.avatarImg||(s.isShop?s.userDefault.href:s.shopDefault.href),alt:""},null,8,he)]),r("div",Te,[r("h3",null,_(u.showName||"-"),1),u.count?(v(),A("p",Ee,_(u.count),1)):y("",!0)]),r("div",Ie,[r("p",ye,_(u.content||"-"),1),r("p",De,_(u.showTime),1)])],8,Ae))),128))])])}const Ve=Y(ie,[["render",Pe],["__scopeId","data-v-71d2c2d9"]]);export{Ve as default};
