import{aq as y,ax as f,as as $,e as p,r as S,ar as D,p as A,aI as I,f as L,b as l,X as N,aJ as B,s as M,bw as R,av as U}from"./index-55507c28.js";const[X,r,Y]=y("pull-refresh"),H=50,j=["pulling","loosing","success"],q={disabled:Boolean,modelValue:Boolean,headHeight:f(H),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:$,successDuration:f(500),animationDuration:f(300)};var C=p({name:X,props:q,emits:["change","refresh","update:modelValue"],setup(s,{emit:d,slots:o}){let u;const g=S(),T=S(),P=D.useScrollParent(g),e=A({status:"normal",distance:0,duration:0}),i=I(),b=()=>{if(s.headHeight!==H)return{height:"".concat(s.headHeight,"px")}},h=()=>e.status!=="loading"&&e.status!=="success"&&!s.disabled,k=t=>{const a=+(s.pullDistance||s.headHeight);return t>a&&(t<a*2?t=a+(t-a)/2:t=a*1.5+(t-a*2)/4),Math.round(t)},n=(t,a)=>{const c=+(s.pullDistance||s.headHeight);e.distance=t,a?e.status="loading":t===0?e.status="normal":t<c?e.status="pulling":e.status="loosing",d("change",{status:e.status,distance:t})},m=()=>{const{status:t}=e;return t==="normal"?"":s["".concat(t,"Text")]||Y(t)},E=()=>{const{status:t,distance:a}=e;if(o[t])return o[t]({distance:a});const c=[];return j.includes(t)&&c.push(l("div",{class:r("text")},[m()])),t==="loading"&&c.push(l(N,{class:r("loading")},{default:m})),c},V=()=>{e.status="success",setTimeout(()=>{n(0)},+s.successDuration)},v=t=>{u=R(P.value)===0,u&&(e.duration=0,i.start(t))},_=t=>{h()&&v(t)},w=t=>{if(h()){u||v(t);const{deltaY:a}=i;i.move(t),u&&a.value>=0&&i.isVertical()&&(B(t),n(k(a.value)))}},x=()=>{u&&i.deltaY.value&&h()&&(e.duration=+s.animationDuration,e.status==="loosing"?(n(+s.headHeight,!0),d("update:modelValue",!0),M(()=>d("refresh"))):n(0))};return L(()=>s.modelValue,t=>{e.duration=+s.animationDuration,t?n(+s.headHeight,!0):o.success||s.successText?V():n(0,!1)}),D.useEventListener("touchmove",w,{target:T}),()=>{var t;const a={transitionDuration:"".concat(e.duration,"ms"),transform:e.distance?"translate3d(0,".concat(e.distance,"px, 0)"):""};return l("div",{ref:g,class:r()},[l("div",{ref:T,class:r("track"),style:a,onTouchstartPassive:_,onTouchend:x,onTouchcancel:x},[l("div",{class:r("head"),style:b()},[E()]),(t=o.default)==null?void 0:t.call(o)])])}}});const G=U(C);export{G as P};
