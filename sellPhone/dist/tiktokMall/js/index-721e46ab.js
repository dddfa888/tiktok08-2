import{_ as U,i as j,v as B,b3 as S,j as y,T as p,b4 as K,$ as D,o as h,c as d,b as r,w as u,a as n,t as c,y as f,n as F,ap as J,d as m,F as g,E as w,x as I,I as q}from"./index-55507c28.js";import{A as M}from"./index-3ce1345e.js";import{P as z,N as G}from"./index-e25caf73.js";import{E as H}from"./index-94a2e4c2.js";import{P as Q}from"./index-16851c38.js";import{L as W}from"./index-748d9839.js";import{B as X}from"./index-64f4bac7.js";import"./index-6e53b41f.js";import"./index-3bdff75a.js";import{S as Y}from"./index-29b5376b.js";import{a as Z,T as $}from"./index-47f0b7a9.js";/* empty css              */import{o as ee,a as te}from"./orderItem-4e44279b.js";import"./use-id-acc627d9.js";import"./index-dc8f9730.js";import"./use-refs-de0c4b83.js";import"./index-a906d245.js";import"./config-3fe7fd75.js";import"./index-021b9a81.js";const se=j(),oe={name:"Order",beforeRouteEnter(t,e,i){console.log("beforeRouteEnter"),i(l=>{const s=JSON.parse(window.sessionStorage.getItem("position"));document.querySelector(".main-list").scrollTop=s})},beforeRouteLeave(t,e,i){const l=document.querySelector(".main-list").scrollTop;window.sessionStorage.setItem("position",JSON.stringify(l)),i()},components:{orderItem:ee},data(){return{loading:!1,refreshing:!1,finished:!1,showCenter:!1,showCenter2:!1,t:B.useI18n().t,activeName:"",payStatus:"-1",showSeach:!1,list:[],option1:[],option2:[],title1:"",title2:"",orderId:"",purchStatus:"",status:"-2",pageNum:1,isArLang:se,checkedItems:[],show:!1,value:"",showKeyboard:!1,orderStore:S(),userStore:y(),isAllchoice:!1}},activated(){},created(){const t="tiktokMall";window.sessionStorage.setItem("position",JSON.stringify(0)),this.title1="支付状态",this.title2="物流状态",this.option1=[{text:"全部",value:-1,isCurrent:!0},{text:"未支付",value:0,isCurrent:!1},{text:"已支付",value:1,isCurrent:!1}],this.option2=[{text:"全部",value:-2,isCurrent:!0},{text:"订单已取消",value:-1,isCurrent:!1},{text:"等待买家付款",value:0,isCurrent:!1},{text:"买家已付款",value:1,isCurrent:!1},{text:"供应商已接单",value:2,isCurrent:!1},{text:"物流运输中",value:3,isCurrent:!1},{text:"买家已签收",value:4,isCurrent:!1},{text:"订单已完成",value:5,isCurrent:!1},{text:"已退款",value:6,isCurrent:!1}],["argos"].includes(t)&&this.option2.forEach(e=>{e.value===4&&(e.text="订单已完成"),e.value===5&&(e.text="买家已签收")}),document.addEventListener("reloadOrderList",()=>{this.onRefresh()},!1)},computed:{hasNoPushNum:()=>!!S().num,hasSetSafePass(){return this.userStore.userInfo&&this.userStore.userInfo.safeword}},watch:{value(t){t.length===6&&(p.loading(""),this.purchasebatch(),this.show=!1,this.value="")}},mounted(){this.userStore=y(),this.onRefresh()},methods:{isChecked(t){return this.checkedItems.includes(t)},orderItemIdList(t,e){e&&!this.isChecked(t)&&this.checkedItems.push(t),!e&&this.isChecked(t)&&(this.checkedItems=this.checkedItems.filter(i=>i!==t))},allChoice(){this.isAllchoice=!this.isAllchoice,this.$refs.changeCheckboxRef.forEach(t=>{t.isTrueChecked(this.isAllchoice),this.isAllchoice||(this.checkedItems=[])})},purchasebatch(){const e={orderId:this.checkedItems.join(","),safeword:this.value};K(e).then(i=>{this.init(),this.getOrderList()})},openInputDialog(){if(this.checkedItems.length===0){p(this.t("请选择订单"));return}this.hasSetSafePass?(this.show=!0,this.showKeyboard=!0):(p(this.t("请设置资金密码")),setTimeout(()=>{router.push({path:"/fundsPasswordSettings"})},1500))},onLoad(){},onRefresh(){this.init(),this.getOrderList()},handleChoose(t){let e=this.payStatus/1,i=this.option1.findIndex(s=>s.value===e);this.option1.splice(i,1,{...this.option1[i],isCurrent:!1});let l=this.option1.findIndex(s=>s.value===t.value);this.option1.splice(l,1,{...this.option1[l],isCurrent:!0}),this.payStatus=t.value,this.title1=t.text,this.showCenter=!1,this.init(),this.getOrderList()},handleChoose2(t){let e=this.status/1,i=this.option2.findIndex(s=>s.value===e);this.option2.splice(i,1,{...this.option2[i],isCurrent:!1});let l=this.option2.findIndex(s=>s.value===t.value);this.option2.splice(l,1,{...this.option2[l],isCurrent:!0}),this.status=t.value,this.title2=t.text,this.showCenter2=!1,this.init(),this.getOrderList()},handleShow(t){t===1?this.showCenter=!0:this.showCenter2=!0},init(){this.pageNum=1,this.list=[],this.loading=!1,this.refreshing=!1,this.finished=!1,this.checkedItems=[],this.isAllchoice=!1},getOrderList(){const t={orderId:this.orderId,payStatus:this.payStatus,purchStatus:this.activeName,status:this.status,begin:"",end:"",pageNum:this.pageNum};Object.keys(t).forEach(e=>{!t[e]&&t[e]!==0&&delete t[e]}),t.payStatus/1===-1&&delete t.payStatus,t.status/1===-2&&delete t.status,p.loading({message:this.t("加载中"),forbidClick:!0,duration:0}),te(t).then(e=>{this.refreshing&&(this.refreshing=!1),this.pageNum++,this.loading=!1,e.pageList.length==0&&(this.finished=!0);const i=this.list.concat(e.pageList);this.list=Number(t.purchStatus)===0?i.filter(l=>Number(l.status)!==-1&&Number(l.status)!==6):i}).catch(e=>{console.log(e)})},tab(t,e){this.activeName=t,console.log(this.activeName,"activeName"),this.onRefresh()},onSearch(){this.showSeach=!0,this.$router.push("/order_search")},change(t){this.value=t,this.showSeach=!1},onConfirm2(t){this.title2=this.option2[t].text,this.getOrderList()}}},ie={class:"main"},ne={class:"seach",style:{"border-radius":"25px"}},re={class:"dropdown"},le={class:"p-2.5 bg-white flex justify-between items-center w-full h-full"},ae={class:"text-xs"},he={class:"p-2.5 bg-white flex justify-between items-center w-full h-full"},ue={class:"text-xs"},de={class:"btn-style"},ce=["onClick"],fe=["onClick"],pe={class:"main-list"},me={class:"goods"},ve={style:{height:"22rem"}};function ge(t,e,i,l,s,a){const v=$,k=Z,N=Y,C=X,_=q,x=J,L=D("orderItem"),O=W,R=Q,V=H,A=z,P=G,E=M;return h(),d("div",{id:"order",class:F({"is-ar":s.isArLang})},[r(k,{active:s.activeName,"onUpdate:active":e[0]||(e[0]=o=>s.activeName=o),onClick:a.tab},{default:u(()=>[r(v,{title:s.t("total"),name:""},null,8,["title"]),r(v,{title:s.t("待采购"),name:"0",dot:a.hasNoPushNum},null,8,["title","dot"]),r(v,{title:s.t("已采购"),name:"1"},null,8,["title"])]),_:1},8,["active","onClick"]),n("div",ie,[n("div",ne,[r(N,{style:{"border-radius":"25px"},readonly:"",onClick:a.onSearch,modelValue:s.orderId,"onUpdate:modelValue":e[1]||(e[1]=o=>s.orderId=o),placeholder:s.t("搜索")},null,8,["onClick","modelValue","placeholder"])]),n("div",re,[n("div",{class:"dropdownitem one h-10.5",onClick:e[2]||(e[2]=o=>a.handleShow(1))},[n("div",le,[n("span",ae,c(s.t(s.title1)),1),e[14]||(e[14]=n("div",{class:"triangle"},null,-1))])]),n("div",{class:"dropdownitem one h-10.5",onClick:e[3]||(e[3]=o=>a.handleShow(2))},[n("div",he,[n("span",ue,c(s.t(s.title2)),1),e[15]||(e[15]=n("div",{class:"triangle"},null,-1))])])]),n("div",de,[r(C,{onClick:e[4]||(e[4]=o=>a.openInputDialog()),type:"primary"},{default:u(()=>[m(c(t.$t("批量采购")),1)]),_:1}),r(C,{onClick:e[5]||(e[5]=o=>a.allChoice()),type:"default"},{default:u(()=>[m(c(t.$t("全选")),1)]),_:1})]),r(x,{show:s.showCenter,"onUpdate:show":e[6]||(e[6]=o=>s.showCenter=o),round:""},{default:u(()=>[(h(!0),d(g,null,w(s.option1,(o,b)=>(h(),d("div",{onClick:T=>a.handleChoose(o),class:"font-3.5 w-72 h-12 flex justify-center items-center border-bottom relative"},[m(c(s.t(o.text))+" ",1),o.isCurrent?(h(),f(_,{key:0,name:"success",class:"yes"})):I("",!0)],8,ce))),256))]),_:1},8,["show"]),r(x,{show:s.showCenter2,"onUpdate:show":e[7]||(e[7]=o=>s.showCenter2=o),round:""},{default:u(()=>[(h(!0),d(g,null,w(s.option2,(o,b)=>(h(),d("div",{onClick:T=>a.handleChoose2(o),class:"text-xs w-72 h-12 flex justify-center items-center border-bottom relative",key:b+"option2"},[m(c(s.t(o.text))+" ",1),o.isCurrent?(h(),f(_,{key:0,name:"success",class:"yes"})):I("",!0)],8,fe))),128))]),_:1},8,["show"]),n("div",pe,[s.list.length>0?(h(),f(R,{key:0,modelValue:s.refreshing,"onUpdate:modelValue":e[9]||(e[9]=o=>s.refreshing=o),onRefresh:a.onRefresh,"loading-text":t.$t("加载中"),"loosing-text":t.$t("释放以刷新"),"pulling-text":t.$t("下拉以刷新")},{default:u(()=>[r(O,{"immediate-check":!1,loading:s.loading,"onUpdate:loading":e[8]||(e[8]=o=>s.loading=o),"loading-text":t.$t("加载中"),finished:s.finished,"finished-text":t.$t("noMore"),onLoad:a.getOrderList},{default:u(()=>[n("div",me,[(h(!0),d(g,null,w(s.list,o=>(h(),f(L,{ref_for:!0,ref:"changeCheckboxRef",orderItemIdList:a.orderItemIdList,info:o},null,8,["orderItemIdList","info"]))),256))])]),_:1},8,["loading","loading-text","finished","finished-text","onLoad"])]),_:1},8,["modelValue","onRefresh","loading-text","loosing-text","pulling-text"])):(h(),f(V,{key:1,description:t.$t("noData")},null,8,["description"])),e[16]||(e[16]=n("div",{class:"safe-area-inset-bottom"},null,-1))])]),r(E,{show:s.show,"onUpdate:show":e[13]||(e[13]=o=>s.show=o),title:s.t("请输入交易密码")},{default:u(()=>[n("div",ve,[r(A,{length:6,value:s.value,focused:s.showKeyboard,onFocus:e[10]||(e[10]=o=>s.showKeyboard=!0)},null,8,["value","focused"]),r(P,{modelValue:s.value,"onUpdate:modelValue":e[11]||(e[11]=o=>s.value=o),show:s.showKeyboard,onBlur:e[12]||(e[12]=o=>s.showKeyboard=!1)},null,8,["modelValue","show"])])]),_:1},8,["show","title"])],2)}const je=U(oe,[["render",ge],["__scopeId","data-v-17d4e17d"]]);export{je as default};
