System.register(["./index-legacy-27bdf402.js","./index-legacy-55462584.js","./index-legacy-95677eea.js","./index-legacy-00472a3a.js","./index-legacy-591c4a77.js","./product.api-legacy-857ca90b.js","./index-legacy-6a04a158.js","./function-call-legacy-56c77e5e.js"],function(e,t){"use strict";var i,n,a,o,s,r,l,d,c,u,p,b,m,v,f,g,x,y,h,k,w,_,j,T,P,C,N,I;return{setters:[e=>{i=e._,n=e.j,a=e.r,o=e.v,s=e.i,r=e.a0,l=e.l,d=e.m,c=e.p,u=e.o,p=e.c,b=e.b,m=e.w,v=e.a,f=e.t,g=e.u,x=e.d,y=e.n,h=e.M,k=e.T,w=e.ap},e=>{_=e.B},e=>{j=e.C},null,e=>{T=e.F},e=>{P=e.s,C=e.e},e=>{N=e.F},e=>{I=e.D}],execute:function(){var t=document.createElement("style");t.textContent=".editProduct[data-v-9b0b1348]{background:#fff;color:#333}.editProduct.is-ar[data-v-9b0b1348] .van-field__error-message,.editProduct.is-ar[data-v-9b0b1348] .van-field__control{text-align:right}.editProduct .title[data-v-9b0b1348]{text-align:center;line-height:55px;font-size:16px;font-weight:700}.editProduct .tip[data-v-9b0b1348]{font-size:14px}.editProduct .tips[data-v-9b0b1348]{font-size:12px;line-height:18px;color:#000}.editProduct .tips span[data-v-9b0b1348]{color:#1552f0}.editProduct .input-field[data-v-9b0b1348]{border:1px solid #ddd}.editProduct .input-field .profit[data-v-9b0b1348]{color:#0ecb81}.editProduct .input-item[data-v-9b0b1348]{-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.time-clear[data-v-9b0b1348]{width:44px;height:44px;background-color:#fff;position:absolute;z-index:9;right:0;top:0;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.btn-content[data-v-9b0b1348]{border-color:var(--site-main-color);background-color:var(--site-main-color)}\n",document.head.appendChild(t);const $={class:"edit-product-pop"},B={class:"title"},F={class:"tip pt-2 pb-2 pl-4 pr-4"},E={class:"tips pt-2 pb-2 pl-4 pr-4"},M={style:{margin:"16px"}},S={__name:"editProfit",props:{isEdit:Boolean,productArry:Array},emits:["back","update"],setup(e,{emit:t}){const i=n();a("true");const{t:S}=o.useI18n(),z=s(),D=a(!1);a(!1),a(!1),a(!1),a(new Date),a(""),a(""),a("");const A=t;r();const V=l(),O=a({startTime:"",endTime:"",discount:"",percent:""}),U=d(()=>{let e={};return i.userInfo.token?e={...i.userInfo}:V.push("/login"),e}),q=e=>{if([].includes("tiktokMall")&&(!U.value.phoneverif||!U.value.emailverif)){const e=U.value.phoneverif?"bindEmailTips":"请绑定手机号";return void I.confirm({title:S("dialogTips"),message:S(e),cancelButtonText:S("cancel"),confirmButtonText:S("gotoSet"),confirmButtonColor:"#1552F0",cancelButtonColor:"#999"}).then(()=>{h("/personalInfo")}).catch(()=>{console.log("cancel")})}const{startTime:t,endTime:i,discount:n}=O.value;if(t||i){const e=new Date(t.replace(/-/g,"/")+" 00:00:00").getTime(),a=new Date(i.replace(/-/g,"/")+" 00:00:00").getTime();if(!n)return void k(S("请设置折扣比例"));if(e>a)return void k(S("开始时间应小于结束时间"))}if(Number(n)&&(!t||!i))return void k(S("请正确填写活动开启时间和结束时间"));let a={goodsIds:L.productArry.join(","),...O.value};if(O.value.percent>G.max||O.value.percent<G.min)k(S("百分比设置范围为")+`：${G.min}% ~ ${G.max}%`);else{const e=/^\+?[1-9][0-9]*$/;e.test(String(Number(O.value.percent)))?Number(O.value.discount)&&!e.test(String(Number(O.value.discount)))?k(S("折扣比例必须为正整数")):(D.value=!0,a.startTime=a.startTime+" 00:00:00",a.endTime=a.endTime+" 00:00:00",a.profit=(O.value.percent/100).toFixed(2),a.discount=(O.value.discount/100).toFixed(2),a.percent=(O.value.percent/100).toFixed(2),k.loading({forbidClick:!0}),C(a).then(()=>{k(S("上架成功")),J()}).catch(e=>{const t="string"==typeof e.data?JSON.parse(e.data):e.data;if(t&&t._$1)k({message:S(e.msg,{_$1:t._$1}),duration:2e3});else if(e.msg.indexOf("：")>-1){const t=e.msg.split("：");k({message:S(t[0],{num:e.data.noLevelGoodsNum}),duration:2e3})}else k({message:S(e.msg),duration:2e3});D.value=!1})):k(S("百分比必须为正整数"))}},G=c({min:5,max:20});P().then(e=>{G.min=Number(e.sysParaMin),G.max=Number(e.sysParaMax)});const J=()=>{H(),A("update")},L=e,H=()=>{A("close");for(const e in O.value)O.value[e]="";setTimeout(()=>{D.value=!1},500)};return(e,t)=>{const i=T,n=j,a=_,o=N,s=w;return u(),p("div",{class:y(["editProduct",{"is-ar":g(z)}])},[b(s,{show:L.isEdit,"onUpdate:show":t[1]||(t[1]=e=>L.isEdit=e),round:"",closeable:"",onClickCloseIcon:H,style:{height:"35%",width:"95%"}},{default:m(()=>[v("div",$,[v("div",B,f(g(S)("添加商品")),1),b(o,null,{default:m(()=>[v("div",F,f(g(S)("product.25")),1),b(n,{class:"input-field",inset:""},{default:m(()=>[b(i,{modelValue:O.value.percent,"onUpdate:modelValue":t[0]||(t[0]=e=>O.value.percent=e),type:"number",placeholder:g(S)("百分比"),rules:[{required:!0,message:g(S)("请填写百分比"),max:G.max,min:G.min}]},{button:m(()=>[...t[2]||(t[2]=[v("span",null,"%",-1)])]),_:1},8,["modelValue","placeholder","rules"])]),_:1}),v("div",E,[x(f(e.$t("将选中的商品发布到你的店铺，并填写商品利润比例，推荐比例"))+": ",1),v("span",null,f(G.min)+"%-"+f(G.max)+"%",1)]),v("div",M,[b(a,{disabled:D.value,block:"",class:"btn-content",type:"primary",onClick:q,"native-type":"submit"},{default:m(()=>[x(f(g(S)("product.26")),1)]),_:1},8,["disabled"])])]),_:1})])]),_:1},8,["show"])],2)}}};e("e",i(S,[["__scopeId","data-v-9b0b1348"]]))}}});
