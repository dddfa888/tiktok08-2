import{_ as U,v as E,l as P,j,m as g,r as c,f as C,o as D,c as F,b as n,w as _,a as u,t as h,u as v,T as m,Y as q,ct as A,a9 as H,d as x}from"./index-55507c28.js";import{A as K}from"./index-3ce1345e.js";import{P as L,N as O}from"./index-e25caf73.js";import{B as W}from"./index-64f4bac7.js";import"./index-6e53b41f.js";import{F as z}from"./index-3bdff75a.js";import{E as R}from"./index-5f89f735.js";import{D as Y}from"./function-call-cafb329d.js";import"./use-id-acc627d9.js";const G={class:"cancellation-content"},J={class:"item"},M={class:"item"},Q={class:"btn"},X={style:{height:"22rem"}},Z={__name:"index",setup(ee){const{t:a}=E.useI18n(),y=P(),p=j(),r=g(()=>{let t={username:"***",safeword:0};return p.userInfo.token?t={...t,...p.userInfo}:y.push("/login"),t}),w=g(()=>{const t=r.value.username;if(r.value.username.indexOf("@")>-1)return t;if(r.value.phone){const e=r.value.phone.split(" ");return"(+".concat(e[0],") ").concat(e[1])}else return t}),i=c(!1),f=c(""),s=c(""),l=c(!1),B=async()=>{if(!f.value)return m(a("请输入您要注销账号的原因")),!1;l.value=!0;const t=await q();l.value=!1,t.money>0?m(a("该账号存在可用余额，不可注销！")):!!r.value.safeword?(i.value=!0,d.value=!0):V()},V=async()=>{l.value=!0,i.value=!1,d.value=!1,Y.confirm({title:a("您确认要注销吗？"),message:a("警告！请谨慎操作注销账户，如果您不再使用该账号，可点击【同意注销】，注销后可能几天内无法注册。"),confirmButtonColor:"#ee0a24",cancelButtonText:a("cancel"),confirmButtonText:a("同意注销")}).then(()=>{b()}).catch(()=>{l.value=!1})},b=()=>{const t={account:r.value.username,reason:f.value,cashPassword:s.value||null};A(t).then(()=>{l.value=!1,m.success(a("注销成功")),setTimeout(()=>{p.logout()},1500)}).catch(()=>{s.value="",l.value=!1})},d=c(!1);return C(()=>s.value,t=>{t.length===6&&(m.loading(""),b(),i.value=!1,s.value="")}),(t,e)=>{const I=H,S=z,T=W,k=L,$=O,N=K;return D(),F("div",null,[n(I,{fixed:""},{title:_(()=>[x(h(v(a)("账号注销")),1)]),_:1}),e[6]||(e[6]=u("div",{style:{height:"46px"}},null,-1)),u("div",G,[u("div",J,[n(R,{label:t.$t("您的账号"),modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=o=>w.value=o),disabled:!0,clearBtn:!1,typeText:"text"},null,8,["label","modelValue"])]),u("div",M,[u("p",null,h(v(a)("为什么要离开？")),1),n(S,{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=o=>f.value=o),rows:"4",autosize:"",type:"textarea",placeholder:v(a)("pleaseEnter")},null,8,["modelValue","placeholder"])]),u("div",Q,[n(T,{type:"danger",loading:l.value,block:"",onClick:B},{default:_(()=>[x(h(t.$t("注销账号")),1)]),_:1},8,["loading"])])]),n(N,{show:i.value,"onUpdate:show":e[5]||(e[5]=o=>i.value=o),title:v(a)("请输入交易密码")},{default:_(()=>[u("div",X,[n(k,{length:6,value:s.value,focused:d.value,onFocus:e[2]||(e[2]=o=>d.value=!0)},null,8,["value","focused"]),n($,{modelValue:s.value,"onUpdate:modelValue":e[3]||(e[3]=o=>s.value=o),show:d.value,onBlur:e[4]||(e[4]=o=>d.value=!1)},null,8,["modelValue","show"])])]),_:1},8,["show","title"])])}}},ie=U(Z,[["__scopeId","data-v-0194ffcb"]]);export{ie as default};
