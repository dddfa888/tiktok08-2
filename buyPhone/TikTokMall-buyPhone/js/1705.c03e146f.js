"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[1705],{14603:function(e,t,i){var s=i(36840),n=i(79504),o=i(655),a=i(22812),r=URLSearchParams,l=r.prototype,h=n(l.append),c=n(l["delete"]),u=n(l.forEach),f=n([].push),d=new r("a=1&a=2&b=3");d["delete"]("a",1),d["delete"]("b",void 0),d+""!=="a=2"&&s(l,"delete",function(e){var t=arguments.length,i=t<2?void 0:arguments[1];if(t&&void 0===i)return c(this,e);var s=[];u(this,function(e,t){f(s,{key:t,value:e})}),a(t,1);var n,r=o(e),l=o(i),d=0,v=0,m=!1,p=s.length;while(d<p)n=s[d++],m||n.key===r?(m=!0,c(this,n.key)):v++;while(v<p)n=s[v++],n.key===r&&n.value===l||h(this,n.key,n.value)},{enumerable:!0,unsafe:!0})},47566:function(e,t,i){var s=i(36840),n=i(79504),o=i(655),a=i(22812),r=URLSearchParams,l=r.prototype,h=n(l.getAll),c=n(l.has),u=new r("a=1");!u.has("a",2)&&u.has("a",void 0)||s(l,"has",function(e){var t=arguments.length,i=t<2?void 0:arguments[1];if(t&&void 0===i)return c(this,e);var s=h(this,e);a(t,1);var n=o(i),r=0;while(r<s.length)if(s[r++]===n)return!0;return!1},{enumerable:!0,unsafe:!0})},51785:function(e,t,i){i.d(t,{A:function(){return b}});i(44114),i(18111),i(22489),i(7588),i(61701),i(14603),i(47566),i(98721);var s=i(51137),n=i(55685),o=i(83462),a=i(33448);i(13579);function r(e){return Array.isArray(e)?e:[e]}function l(e,t){return new Promise(function(i){if("file"!==t){var s=new FileReader;s.onload=function(e){i(e.target.result)},"dataUrl"===t?s.readAsDataURL(e):"text"===t&&s.readAsText(e)}else i(null)})}function h(e,t){return r(e).some(function(e){return!!e&&((0,a.Tn)(t)?t(e):e.size>t)})}var c=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg)/i;function u(e){return c.test(e)}function f(e){return!!e.isImage||(e.file&&e.file.type?0===e.file.type.indexOf("image"):e.url?u(e.url):!!e.content&&0===e.content.indexOf("data:image"))}var d=i(77965),v=i(96874),m=i(76060),p=i(90689),g=i(85432),w=(0,n.Y)("uploader"),y=w[0],S=w[1],b=y({inheritAttrs:!1,mixins:[d.Y],model:{prop:"fileList"},props:{disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,uploadText:String,afterRead:Function,beforeRead:Function,beforeDelete:Function,previewSize:[Number,String],previewOptions:Object,name:{type:[Number,String],default:""},accept:{type:String,default:"image/*"},fileList:{type:Array,default:function(){return[]}},maxSize:{type:[Number,String,Function],default:Number.MAX_VALUE},maxCount:{type:[Number,String],default:Number.MAX_VALUE},deletable:{type:Boolean,default:!0},showUpload:{type:Boolean,default:!0},previewImage:{type:Boolean,default:!0},previewFullImage:{type:Boolean,default:!0},imageFit:{type:String,default:"cover"},resultType:{type:String,default:"dataUrl"},uploadIcon:{type:String,default:"photograph"}},computed:{previewSizeWithUnit:function(){return(0,o._)(this.previewSize)},value:function(){return this.fileList}},created:function(){this.urls=[]},beforeDestroy:function(){this.urls.forEach(function(e){return URL.revokeObjectURL(e)})},methods:{getDetail:function(e){return void 0===e&&(e=this.fileList.length),{name:this.name,index:e}},onChange:function(e){var t=this,i=e.target.files;if(!this.disabled&&i.length){if(i=1===i.length?i[0]:[].slice.call(i),this.beforeRead){var s=this.beforeRead(i,this.getDetail());if(!s)return void this.resetInput();if((0,a.yL)(s))return void s.then(function(e){e?t.readFile(e):t.readFile(i)}).catch(this.resetInput)}this.readFile(i)}},readFile:function(e){var t=this,i=h(e,this.maxSize);if(Array.isArray(e)){var s=this.maxCount-this.fileList.length;e.length>s&&(e=e.slice(0,s)),Promise.all(e.map(function(e){return l(e,t.resultType)})).then(function(s){var n=e.map(function(e,t){var i={file:e,status:"",message:""};return s[t]&&(i.content=s[t]),i});t.onAfterRead(n,i)})}else l(e,this.resultType).then(function(s){var n={file:e,status:"",message:""};s&&(n.content=s),t.onAfterRead(n,i)})},onAfterRead:function(e,t){var i=this;this.resetInput();var s=e;if(t){var n=e;Array.isArray(e)?(n=[],s=[],e.forEach(function(e){e.file&&(h(e.file,i.maxSize)?n.push(e):s.push(e))})):s=null,this.$emit("oversize",n,this.getDetail())}var o=Array.isArray(s)?Boolean(s.length):Boolean(s);o&&(this.$emit("input",[].concat(this.fileList,r(s))),this.afterRead&&this.afterRead(s,this.getDetail()))},onDelete:function(e,t){var i,s=this,n=null!=(i=e.beforeDelete)?i:this.beforeDelete;if(n){var o=n(e,this.getDetail(t));if(!o)return;if((0,a.yL)(o))return void o.then(function(){s.deleteFile(e,t)}).catch(a.lQ)}this.deleteFile(e,t)},deleteFile:function(e,t){var i=this.fileList.slice(0);i.splice(t,1),this.$emit("input",i),this.$emit("delete",e,this.getDetail(t))},resetInput:function(){this.$refs.input&&(this.$refs.input.value="")},onClickUpload:function(e){this.$emit("click-upload",e)},onPreviewImage:function(e){var t=this;if(this.previewFullImage){var i=this.fileList.filter(function(e){return f(e)}),n=i.map(function(e){return e.file&&!e.url&&"failed"!==e.status&&(e.url=URL.createObjectURL(e.file),t.urls.push(e.url)),e.url});this.imagePreview=(0,g.A)((0,s.A)({images:n,startPosition:i.indexOf(e),onClose:function(){t.$emit("close-preview")}},this.previewOptions))}},closeImagePreview:function(){this.imagePreview&&this.imagePreview.close()},chooseFile:function(){this.disabled||this.$refs.input&&this.$refs.input.click()},genPreviewMask:function(e){var t=this.$createElement,i=e.status,s=e.message;if("uploading"===i||"failed"===i){var n="failed"===i?t(v.A,{attrs:{name:"close"},class:S("mask-icon")}):t(p.A,{class:S("loading")}),o=(0,a.C8)(s)&&""!==s;return t("div",{class:S("mask")},[n,o&&t("div",{class:S("mask-message")},[s])])}},genPreviewItem:function(e,t){var i,n,o,a=this,r=this.$createElement,l=null!=(i=e.deletable)?i:this.deletable,h="uploading"!==e.status&&l,c=h&&r("div",{class:S("preview-delete"),on:{click:function(i){i.stopPropagation(),a.onDelete(e,t)}}},[r(v.A,{attrs:{name:"cross"},class:S("preview-delete-icon")})]),u=this.slots("preview-cover",(0,s.A)({index:t},e)),d=u&&r("div",{class:S("preview-cover")},[u]),p=null!=(n=e.previewSize)?n:this.previewSize,g=null!=(o=e.imageFit)?o:this.imageFit,w=f(e)?r(m.A,{attrs:{fit:g,src:e.content||e.url,width:p,height:p,lazyLoad:this.lazyLoad},class:S("preview-image"),on:{click:function(){a.onPreviewImage(e)}}},[d]):r("div",{class:S("file"),style:{width:this.previewSizeWithUnit,height:this.previewSizeWithUnit}},[r(v.A,{class:S("file-icon"),attrs:{name:"description"}}),r("div",{class:[S("file-name"),"van-ellipsis"]},[e.file?e.file.name:e.url]),d]);return r("div",{class:S("preview"),on:{click:function(){a.$emit("click-preview",e,a.getDetail(t))}}},[w,this.genPreviewMask(e),c])},genPreviewList:function(){if(this.previewImage)return this.fileList.map(this.genPreviewItem)},genUpload:function(){var e=this.$createElement;if(!(this.fileList.length>=this.maxCount)){var t,i=this.slots(),n=this.readonly?null:e("input",{attrs:(0,s.A)({},this.$attrs,{type:"file",accept:this.accept,disabled:this.disabled}),ref:"input",class:S("input"),on:{change:this.onChange}});if(i)return e("div",{class:S("input-wrapper"),key:"input-wrapper",on:{click:this.onClickUpload}},[i,n]);if(this.previewSize){var o=this.previewSizeWithUnit;t={width:o,height:o}}return e("div",{directives:[{name:"show",value:this.showUpload}],class:S("upload",{readonly:this.readonly}),style:t,on:{click:this.onClickUpload}},[e(v.A,{attrs:{name:this.uploadIcon},class:S("upload-icon")}),this.uploadText&&e("span",{class:S("upload-text")},[this.uploadText]),n])}}},render:function(){var e=arguments[0];return e("div",{class:S()},[e("div",{class:S("wrapper",{disabled:this.disabled})},[this.genPreviewList(),this.genUpload()])])}})},77965:function(e,t,i){i.d(t,{Y:function(){return s}});var s={inject:{vanField:{default:null}},watch:{value:function(){var e=this.vanField;e&&(e.resetValidation(),e.validateWithTrigger("onChange"))}},created:function(){var e=this.vanField;e&&!e.children&&(e.children=this)}}},83560:function(){},85432:function(e,t,i){i.d(t,{A:function(){return z}});var s=i(51137),n=i(66848),o=(i(18111),i(61701),i(55685)),a=(0,o.Y)("image-preview"),r=a[0],l=a[1],h=i(20105),c=i(28722),u=i(2879),f=i(96874),d=i(77235),v=i(21465),m=i(48499),p=i(76060),g=i(90689),w=i(36749);function y(e){return Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2))}var S,b={mixins:[c.B],props:{src:String,show:Boolean,active:Number,minZoom:[Number,String],maxZoom:[Number,String],rootWidth:Number,rootHeight:Number},data:function(){return{scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,imageRatio:0,displayWidth:0,displayHeight:0}},computed:{vertical:function(){var e=this.rootWidth,t=this.rootHeight,i=t/e;return this.imageRatio>i},imageStyle:function(){var e=this.scale,t={transitionDuration:this.zooming||this.moving?"0s":".3s"};if(1!==e){var i=this.moveX/e,s=this.moveY/e;t.transform="scale("+e+", "+e+") translate("+i+"px, "+s+"px)"}return t},maxMoveX:function(){if(this.imageRatio){var e=this.vertical?this.rootHeight/this.imageRatio:this.rootWidth;return Math.max(0,(this.scale*e-this.rootWidth)/2)}return 0},maxMoveY:function(){if(this.imageRatio){var e=this.vertical?this.rootHeight:this.rootWidth*this.imageRatio;return Math.max(0,(this.scale*e-this.rootHeight)/2)}return 0}},watch:{active:"resetScale",show:function(e){e||this.resetScale()}},mounted:function(){this.bindTouchEvent(this.$el)},methods:{resetScale:function(){this.setScale(1),this.moveX=0,this.moveY=0},setScale:function(e){e=(0,v.y1)(e,+this.minZoom,+this.maxZoom),e!==this.scale&&(this.scale=e,this.$emit("scale",{scale:this.scale,index:this.active}))},toggleScale:function(){var e=this.scale>1?1:2;this.setScale(e),this.moveX=0,this.moveY=0},onTouchStart:function(e){var t=e.touches,i=this.offsetX,s=void 0===i?0:i;this.touchStart(e),this.touchStartTime=new Date,this.fingerNum=t.length,this.startMoveX=this.moveX,this.startMoveY=this.moveY,this.moving=1===this.fingerNum&&1!==this.scale,this.zooming=2===this.fingerNum&&!s,this.zooming&&(this.startScale=this.scale,this.startDistance=y(e.touches))},onTouchMove:function(e){var t=e.touches;if(this.touchMove(e),(this.moving||this.zooming)&&(0,m.wo)(e,!0),this.moving){var i=this.deltaX+this.startMoveX,s=this.deltaY+this.startMoveY;this.moveX=(0,v.y1)(i,-this.maxMoveX,this.maxMoveX),this.moveY=(0,v.y1)(s,-this.maxMoveY,this.maxMoveY)}if(this.zooming&&2===t.length){var n=y(t),o=this.startScale*n/this.startDistance;this.setScale(o)}},onTouchEnd:function(e){var t=!1;(this.moving||this.zooming)&&(t=!0,this.moving&&this.startMoveX===this.moveX&&this.startMoveY===this.moveY&&(t=!1),e.touches.length||(this.zooming&&(this.moveX=(0,v.y1)(this.moveX,-this.maxMoveX,this.maxMoveX),this.moveY=(0,v.y1)(this.moveY,-this.maxMoveY,this.maxMoveY),this.zooming=!1),this.moving=!1,this.startMoveX=0,this.startMoveY=0,this.startScale=1,this.scale<1&&this.resetScale())),(0,m.wo)(e,t),this.checkTap(),this.resetTouchStatus()},checkTap:function(){var e=this;if(!(this.fingerNum>1)){var t=this.offsetX,i=void 0===t?0:t,s=this.offsetY,n=void 0===s?0:s,o=new Date-this.touchStartTime,a=250,r=5;i<r&&n<r&&o<a&&(this.doubleTapTimer?(clearTimeout(this.doubleTapTimer),this.doubleTapTimer=null,this.toggleScale()):this.doubleTapTimer=setTimeout(function(){e.$emit("close"),e.doubleTapTimer=null},a))}},onLoad:function(e){var t=e.target,i=t.naturalWidth,s=t.naturalHeight;this.imageRatio=s/i}},render:function(){var e=arguments[0],t={loading:function(){return e(g.A,{attrs:{type:"spinner"}})}};return e(w.A,{class:l("swipe-item")},[e(p.A,{attrs:{src:this.src,fit:"contain"},class:l("image",{vertical:this.vertical}),style:this.imageStyle,scopedSlots:t,on:{load:this.onLoad}})])}},x=r({mixins:[c.B,(0,h.i)({skipToggleEvent:!0}),(0,u.x)(function(e){e(window,"resize",this.resize,!0),e(window,"orientationchange",this.resize,!0)})],props:{className:null,closeable:Boolean,asyncClose:Boolean,overlayStyle:Object,showIndicators:Boolean,images:{type:Array,default:function(){return[]}},loop:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},minZoom:{type:[Number,String],default:1/3},maxZoom:{type:[Number,String],default:3},transition:{type:String,default:"van-fade"},showIndex:{type:Boolean,default:!0},swipeDuration:{type:[Number,String],default:300},startPosition:{type:[Number,String],default:0},overlayClass:{type:String,default:l("overlay")},closeIcon:{type:String,default:"clear"},closeOnPopstate:{type:Boolean,default:!0},closeIconPosition:{type:String,default:"top-right"}},data:function(){return{active:0,rootWidth:0,rootHeight:0,doubleClickTimer:null}},mounted:function(){this.resize()},watch:{startPosition:"setActive",value:function(e){var t=this;e?(this.setActive(+this.startPosition),this.$nextTick(function(){t.resize(),t.$refs.swipe.swipeTo(+t.startPosition,{immediate:!0})})):this.$emit("close",{index:this.active,url:this.images[this.active]})}},methods:{resize:function(){if(this.$el&&this.$el.getBoundingClientRect){var e=this.$el.getBoundingClientRect();this.rootWidth=e.width,this.rootHeight=e.height}},emitClose:function(){this.asyncClose||this.$emit("input",!1)},emitScale:function(e){this.$emit("scale",e)},setActive:function(e){e!==this.active&&(this.active=e,this.$emit("change",e))},genIndex:function(){var e=this.$createElement;if(this.showIndex)return e("div",{class:l("index")},[this.slots("index",{index:this.active})||this.active+1+" / "+this.images.length])},genCover:function(){var e=this.$createElement,t=this.slots("cover");if(t)return e("div",{class:l("cover")},[t])},genImages:function(){var e=this,t=this.$createElement;return t(d.A,{ref:"swipe",attrs:{lazyRender:!0,loop:this.loop,duration:this.swipeDuration,initialSwipe:this.startPosition,showIndicators:this.showIndicators,indicatorColor:"white"},class:l("swipe"),on:{change:this.setActive}},[this.images.map(function(i){return t(b,{attrs:{src:i,show:e.value,active:e.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:e.rootWidth,rootHeight:e.rootHeight},on:{scale:e.emitScale,close:e.emitClose}})})])},genClose:function(){var e=this.$createElement;if(this.closeable)return e(f.A,{attrs:{role:"button",name:this.closeIcon},class:l("close-icon",this.closeIconPosition),on:{click:this.emitClose}})},onClosed:function(){this.$emit("closed")},swipeTo:function(e,t){this.$refs.swipe&&this.$refs.swipe.swipeTo(e,t)}},render:function(){var e=arguments[0];return e("transition",{attrs:{name:this.transition},on:{afterLeave:this.onClosed}},[this.shouldRender?e("div",{directives:[{name:"show",value:this.value}],class:[l(),this.className]},[this.genClose(),this.genImages(),this.genIndex(),this.genCover()]):null])}}),A=i(33448),$={loop:!0,value:!0,images:[],maxZoom:3,minZoom:1/3,onClose:null,onChange:null,className:"",showIndex:!0,closeable:!1,closeIcon:"clear",asyncClose:!1,transition:"van-fade",getContainer:"body",overlayStyle:null,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeIconPosition:"top-right"},C=function(){S=new(n["default"].extend(x))({el:document.createElement("div")}),document.body.appendChild(S.$el),S.$on("change",function(e){S.onChange&&S.onChange(e)}),S.$on("scale",function(e){S.onScale&&S.onScale(e)})},T=function(e,t){if(void 0===t&&(t=0),!A.S$){S||C();var i=Array.isArray(e)?{images:e,startPosition:t}:e;return(0,s.A)(S,$,i),S.$once("input",function(e){S.value=e}),S.$once("closed",function(){S.images=[]}),i.onClose&&(S.$off("close"),S.$once("close",i.onClose)),S}};T.Component=x,T.install=function(){n["default"].use(x)};var z=T},98721:function(e,t,i){var s=i(43724),n=i(79504),o=i(62106),a=URLSearchParams.prototype,r=n(a.forEach);s&&!("size"in a)&&o(a,"size",{get:function(){var e=0;return r(this,function(){e++}),e},configurable:!0,enumerable:!0})},99809:function(e,t,i){i(76952),i(69176),i(98992),i(22795),i(19523),i(65270),i(45396),i(84698),i(96002),i(83560)}}]);